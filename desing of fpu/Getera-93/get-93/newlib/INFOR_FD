
c*******  ФАЙЛ СТАНДАРТНЫХ ОПРЕДЕЛЕНИЙ СИСТЕМЫ CONSYST2  ********************
c*******  CONSYST2 System Standard Definition Structure  ********************

        parameter ( ngstd=28, nggstd=15, nthstd=25, ngrm=299 )
        parameter ( nizmax=100, mult=50 ,ngshift=23 )
        parameter ( lrecl=1024, nsigm0=16, lc0=9, momhydr=6 )
        parameter ( lbuf=34 999, nmf=4, nmt=6 )

c           ngrm              - максимальное число мулътигрупп (299)
c           ngstd             - стандартное число нейтронных групп (28)
c           nggstd            - стандартное число фотонных групп (15)
c           nthstd            - стандартное число тепловых групп (25)
c           ngshift           - число групп без термализации (23)
c           mult              - максималъное число мулътигрупповых изотопов
c           nizmax            - максималъное число изотопов (36)
c           nsigm0            - число стандартных сечений разбавления (16)
c           lrecl             - длина записи данных выходной библиотеки
c           lc0               - число типов сечений в таблице 1.0 БНАБ
c           momhydr           - число моментов рассеяния на водороде при
c                               описании с помощью ALFA и BETA (6)
c           lbuf              - максимальный размер рабочей области:
c                               common//ifree,BUF(lbuf), где
c                               ifree - свободный адрес в массиве BUF
c           ng1mult           - число мулътигрупп с неупругим рассеянием
c           ng2mult           - число мультигрупп с анизотропным рассеянием

        character*32 nam28(nizmax),name_repl*8

        integer iaddr0
        integer ng0253,ngin0,ngin1,ngxi,ngal,lhydr,lhydrth,inzgam
        integer ngsver0,ngsver1

c        nam28(nizmax)        - имена нуклидов
c        iaddr0               - текущий свободный адрес на ВУ
c        ng0253               - номер группы, содержащей энергию Е=0.0253эВ
c        ngin0                - =13 - число БНАБ групп неупругого рассеяния
c        ngin1                - =9  - число БНАБ групп 1-ого момента неупругого
c                                     рассеяния
c        ngxi                 - =13 - число БНАБ групп для задания спектра
c                                     деления
c        ngal                 - =15 - число БНАБ групп для описания индикатрис
c                                     упругого рассеяния (начиная с группы
c                                     ngal рассеяние считается изотропным)
c        lhydr                - порядковый номер водорода в списке изотопов
c        lhydrth              - порядковый номер водорода с термализ. матрицей
c        inzgam               - число нуклидов, для которых есть данные по
c                               образованию гамма квантов 
c        ngsver0              - число результирующих групп согласно isver0
c        ngsver1              - из них число групп с неупругим рассеянием

        integer namthm(mult)
        integer isver0(ngrm), isver1(ngstd), isver2(ngrm)
        integer nmix(2), ng28m(ngstd), ng28mc(0:ngstd), ngs1v(nizmax)

c        namthm(mult)         - номера нуклидов, имеющих термализационную
c                               матрицу
c        isver0(ngrm)         - информация об объединении мультигрупп в
c                               более широкие группы (isver0(igm) есть
c                               номер результирующей новой группы, которой
c                               принадлежит данная мультигруппа, причем
c                               isver0(igm)=0 означает пропуск данной группы)
c        isver1(ngstd)        - информация о том на сколько дополнительных
c                               групп разбиты БНАБ группы (isver1(ig)=0
c                               означает, что группа ig опущена)
c        isver2(ngrm)         - isver2(ig1) есть номер БНАБ группы, данные
c                               для которой использовались при расчете
c                               сечений результирующей группы ig1
c                               (размер массива ngsver0)
c        nmix(2)              - nmix(1) - число групповых изотопов (=niz)
c                             - nmix(2) - число мультигрупповых изотопов
c        ng28m(ngstd)         - числа мулътигрупп для каждой БНАБ группы
c        ng28mc(0:ngstd)      - накопленные числа мультигрупп
c        ngs1v(nizmax)        - номера групп обрезки хода сечения 1/v

       integer infng (mult), infgro (nizmax), infmlt (mult)
       integer infgam(nizmax), infelas(nizmax), infinel(nizmax)
       integer infsfg (ngstd,nizmax+1), infsfm (ngstd,mult+1)
       integer inf28 (nmf,nmt,nizmax), inf300 (ngstd,nmt,mult)

c        infng(mult)          - число мультигрупповых данных для мультигруп-
c                               повых нуклидов (предполагается, что для каждого
c                               изотопа может быть задано различное число БНАБ
c                               групп, имеющих мультигрупповую подразбивку)
c        infgro(nizmax)       - номера изотопов в списке мультигрупповых
c                               изотопов nam300
c                               (=0 - изотоп не имеет мулътигрупповых данных)
c        infmlt(mult)         - номера мулътигрупповых изотопов в списке
c                               всех изотопов nam28
c        infgam(nizmax)       - информация о наличии гамма констант
c                               (всего для inzgam нуклидов)
c        infelas(nizmax)      - информация о матрице упругого рассеяния:
c                                0 - матрица отсутствует,
c                               +N - 28 групповая матрица для N переходов
c                                    одинаковая для всех составов зон,
c                               -N - матрица для N переходов для нового
c                                    группового разбиения
c        infinel(nizmax)      - информация о матрице неупругого рассеяния:
c                                0 - матрица отсутствует,
c                                1 - 28 групповая матрица одинаковая для
c                                    всех составов зон,
c                                2 - матрица для нового группового разбиения
c      infsfg(ngstd,nizmax+1) - infsfg(ig,i)  есть порядковый номер
c                               групповых факторов блокировки в массиве
c                               блокировок в данной группе ig для изотопа i
c                               (в соответствии с nizar(i))
c                             - infsfg(ig,niz+1)  есть информация
c                               о наличии ввобще факторов блокировок для
c                               данной группы ig
c      infsfm(ngstd,mult+1)   - аналогично для мулътигрупповых данных
c      inf28(nmt,nmf,nizmax)  - inf28(1,1,i)=0 - нет мулътигрупповых данных
c                                                для нуклида i
c                             -             =n - число БНАБ групп, имеющих
c                                                мулътигрупповые данные
c                             - inf28(1,2,i) - информация о наличии матриц
c                                              неупругого рассеяния
c                                              (=0 - данные отсутствуют)
c                             - inf28(2,2,i) - информация о наличии матриц
c                                              первого момента неупругого
c                                              рассеяния
c                             - inf28(1,3,i) - информация о наличии матриц
c                                              упругого рассеяния
c                             - inf28(k,4,i) - информация о наличии факторов
c                                              блокировки для реакций
c                                              k=1 2 3 4 <==> t c f e
c                             - inf28(k,5,i) - информация о наличии доплеро-
c                                              вских приращений факторов
c                                              блокировки групповых сечений
c                             - inf28(1,6,i) - информация о наличии подгруп-
c                                              повых параметров
c      inf300(ngstd,nmt,mult) - inf300(ig,1,i) =0 - нет мультигрупповых
c                               данных в группе ig для нуклида i (в списке
c                               мультигрупповых изотопов)
c                             - inf300(ig,1,i) =m - число мультигрупповых
c                               данных в данной ig БНАБ группе для нуклида i
c                             - inf300(ig,2,i) - информация о наличии
c                               мультигрупповых матриц неупругого рассеяния
c                               для БНАБ группы ig (=0 - данных нет)
c                             - inf300(ig,3,i) - информация о наличии
c                               мультигрупповых матриц упругого рассеяния
c                               для БНАБ группы ig
c                             - inf300(k,4,i) - информация о наличии
c                               мультигрупповых факторов блокировки
c                               для реакций   k=1 2 3 4 <==> t c f e
c                             - inf300(k,5,i) - информация о наличии
c                               доплеровских приращений факторов блокировок
c                               мультигрупповывх сечений
c                             - inf300(1,6,i) - информация о наличии
c                               подгрупповых параметров

       integer ny28(2)
       integer nizar(nizmax), numgr(0:nizmax)
       integer nizarm(mult), numgrm(0:mult)
       integer ngr28(2*ngstd,nizmax), ngr300(2*ngrm,mult)

c        ny28(2)              - ny28(1) - номер ВУ с промежуточными данными
c                             - ny28(2) - рекорд начала этой информации
c                               (чтение-запись с помощью процедуры RDWRTD)
c        nizar(nizmax)        - числа групп с факторами блокировок
c                               для групповых изотопов (=0 - нет блокировок)
c        numgr(0:nizmax)      - накопленные числа групп с учетом предыдущих
c                               с факторами блокировок для групповых изотопов
c        nizarm(mult)         - аналогично nizar , но для мультигрупповых
c                               изотопов
c        numgrm(0:mult)       - аналогично numgr , но для мулътигрупповых
c                               изотопов
c        ngr28(2*ngstd,nizmax)- ngr28(j,i) - номер БНАБ группы, имеюшей
c                               факторы блокировки, причем число БНАБ групп
c                               есть nizar(i), а ngr28(nizar(i)+j,i) есть
c                               параметр смещения по сечению разбавления
c        ngr300(2*ngrm,mult)  - аналогично для мультигрупповых данных

        real esver(ngrm+1), em(ngrm+1), eth(nthstd+1), egg(nggstd+1)
        real dus(ngstd), duth(nthstd)
        real sigm0(nsigm0), s1vstd(nthstd,2)
        real awrmat(nizmax)

c        esver(ngrm+1)        - границы результирующего нового группового
c                               разбиения
c        em(ngrm+1)           - границы стандартного мультигруппового
c                               разбиения
c        eth(nthstd+1)        - границы тепловой мультигрупповой разбивки
c        egg(nggstd+1)        - границы гамма-групп
c        dus(ngstd)           - ширины мультигрупп в летаргиях
c        duth(nthstd)         - ширины тепловых мультигрупп в летаргиях
c        sigm0(nsigm0)        - стандартные сечения разбавления
c        s1vstd(nthstd,1)     - веса для 1/v сечений для 12 мультигрупп
c        s1vstd(nthstd,2)     - веса для 1/v сечений для тепловой группы
c        awrmat(nizmax)       - атомные веса материалов композиций

       parameter ( max_dim=10, max_cel=20 )
       real par_cel,dim1,vol1,con1
       integer n_cell,nzo1,nom1,num1,num2,n_nfz,i_cel,n_dim,n_fuel

       common /cell$0/ n_cell, n_nfz(max_cel), 
     *                         i_cel(max_cel),
     *                         n_dim(max_cel),
     *                         n_fuel(5,max_cel),
     *                         num1(max_dim,max_cel),
     *                         num2(max_dim,max_cel),
     *                         nom1(nizmax,max_cel),
     *                         nzo1(nizmax,max_cel)
       common /cell$1/         par_cel(5,max_cel),
     *                         dim1(max_dim,max_cel),
     *                         vol1(0:max_dim,max_cel),
     *                         con1(nizmax,max_cel)

       common
     *  /adre$0/ nam28, name_repl
     *  /adre$1/ iaddr0,ng0253,ngin0,ngin1,ngxi,ngal,lhydr,lhydrth,
     *            ng1mult,ng2mult,ngsver0,ngsver1,inzthm,namthm,
     *            isver0,isver1,isver2,nmix,ng28m,ng28mc,ngs1v,
     *            esver,em,eth,egg,dus,duth,sigm0,s1vstd,awrmat
     *  /adre$2/ inzgam,infgam,infelas,infinel,ny28,ngr28,
     *            inf28,ngr300,inf300,infng,infgro,infmlt,
     *            infsfg,infsfm,nizar,numgr,nizarm,numgrm,
     *            ifisprod,ifluxes,irep_iso,irep_rea,irep_nfz

c******************************************************************************
