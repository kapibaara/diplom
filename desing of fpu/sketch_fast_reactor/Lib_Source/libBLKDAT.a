!<arch>
BLKDAT.f/       929015362   0     0     100666  1763      `
C*DK BLKDAT                                                             
      BLOCK DATA
C
      IMPLICIT REAL*8(A-H,O-Z)
C
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C*CA CONTRLLR                                                           
C*CC CONTRLLR                                                           
      INCLUDE 'CONTRLLR'                                                
C*CA DIMNSION                                                           
C*CC DIMNSION                                                           
      INCLUDE 'DIMNSION'                                                
C*CA NMFAIL                                                             
C*CC NMFAIL                                                             
      INCLUDE 'NMFAIL'                                                  
C*CA FIXEDLT                                                            
C*CC FIXEDLT                                                            
C
C*CA IOUNITS                                                            
C*CC IOUNITS                                                            
      INCLUDE 'IOUNITS'                                                 
C                                                                       
      DATA IEOS  /  0 /
      DATA NTHM  /  0 /
      DATA IFTP  /  0 /
      DATA IGAS  /  0 /
      DATA ILIQ  /  0 /
      DATA IMOUT / 60 /
C                                                                       
      END                                                               

CPLL.f/         929015364   0     0     100666  1628      `
C*DK CPLL                                                               
      FUNCTION CPLL( H, P )                                             
      IMPLICIT REAL*8(A-H,O-Z)                                          
C                                                                       
C                                                                       
C                                                                       
C   SPECIFIC HEAT OF LIQUID WATER AS A FUNCTION OF                      
C   ENTHALPY AND PRESSURE                                               
C            PRESSURE    P   IN  (N/SQ.M)                               
C            ENTHALPY    H   IN  (J/KG)                                 
C            SPEC. HEAT  CPL IN  (J/(KG K))                             
C                        REQUIRES NO SUBPROGRAMS  (S)                   
C                                                                       
      DATA B0,B1/2.394907D-04,-5.196250D-13/                            
      DATA C0,C1/1.193203D-11,2.412704D-18/                             
      DATA D0,D1/-3.944067D-17,-1.680771D-24/                           
C                                                                       
      Z    = H*(H*(D0+D1*P)+(C0+C1*P))+B0+B1*P                          
      CPLL = 1.0D0/Z                                                    
C                                                                       
      RETURN                                                            
      END                                                               
CPVV1.f/        929015364   0     0     100666  2590      `
C*DK CPVV1                                                              
      FUNCTION CPVV1( T, P, PA )                                        
      IMPLICIT REAL*8(A-H,O-Z)                                          
C*CA CONTRLLR                                                           
C*CC CONTRLLR                                                           
      INCLUDE 'CONTRLLR'                                                
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
      EQUIVALENCE (CPAX,CEOSLP(22))                                     
C        SPECIFIC HEAT OF WATER VAPOR AS A FUNTION OF TEMPERATURE       
C        AND PRESSURE.                                                  
C                                                                       
C          TEMPERATURE      T     IN      (K)                           
C          PRESSURE         P     IN      (N/M**2)                      
C          SPECIFIC HEAT    CPV   IN      (J/KG/K)                      
C                                                                       
C                                                                       
      DATA C1,C2,C3,C4,C5,C6/1688.35968D0,0.6029856D0,                  
     *     482.0979623D0,2.95317905D+7,1.8D0,460.D0/                    
C*CA FUNCTION                                                           
C*CC FUNCTION                                                           
      INCLUDE 'FUNCTION'                                                
      IF( IEOS.NE.0 ) GO TO 1                                           
      TB    = T*C5-C6                                                   
      P3    = P*P*P                                                     
      CPVV1 = C1+C2*T+C3*P/STAR(TB,2.4D0)+C4*P3/TB**9                   
      IF( PA.GE.0.1D0 ) GO TO 2                                         
      RETURN                                                            
    1 CPVV1 = CPAX                                                      
      RETURN                                                            
    2 CPVV1 = ((P-PA)*CPVV1+PA*CPAX)/P                                  
      RETURN                                                            
      END                                                               
FPROP.f/        929015366   0     0     100666  3945      `
C*DK FPROP                                                              
      SUBROUTINE FPROP                                                  
     1  ( P    ,EL   ,EV   ,ROL  ,ROV  ,TL   ,TV   ,TSAT ,HFG  ,CPL  ,  
     2    CPV  ,VISL ,VISV ,CL   ,CV   ,SIG  ,NC   ,PA   ,ROA  ,TSSN ,  
     3    EA   ,DER   )                                                 
      IMPLICIT REAL*8(A-H,O-Z)                                          
C                                                                       
C     CALCULATES VALUES FOR FLUID ENTHALPY, TRANSPORT PROPERTIES,       
C     AND SURFACE TENSION.                                              
C                                                                       
C*CA DIMNSION                                                           
C*CC DIMNSION                                                           
      INCLUDE 'DIMNSION'                                                
      DIMENSION P(NC)    ,EL(NC)   ,EV(NC)   ,ROL(NC)  ,ROV(NC)  ,      
     1          TL(NC)   ,TV(NC)   ,TSAT(NC) ,HFG(NC)  ,CPL(NC)  ,      
     2          CPV(NC)  ,VISL(NC) ,VISV(NC) ,CL(NC)   ,CV(NC)   ,      
     3          SIG(NC)  ,PA(NC)   ,ROA(NC)  ,TSSN(NC) ,EA(NC)   ,      
     4          DER(1)                                                  
C                                                                       
      IF( NC.LE.0 ) RETURN                                              
CAD +                                                                   
C
CITJ+ (11/11/98)
C
CCC   CALL STIMER( 11, 0, 0, 'FPROP' )                                  
C
CITJ- (11/11/98)
C
CAD -                                                                   
      DO 100 I = 1, NC                                                  
         IPOINT = NTHM*(I-1)                                            
C                                                                       
         HL = EL(I)+P(I)/ROL(I)                                         
         HV = EV(I)+P(I)/ROV(I)                                         
C                                                                       
         HFG(I) = DER(IPOINT+10)-DER(IPOINT+11)                         
C                                                                       
C<<ADD>>                                                                
         IF( TL(I).GT.TSAT(I) ) HL = DER(IPOINT+11)                     
         CPL(I) = CPLL(HL,P(I))                                         
         CPV(I) = CPVV1(TV(I),P(I),PA(I))                               
C                                                                       
         VISL(I) = VISCL(HL,P(I))                                       
         VISV(I) = VISCV(HV,P(I),ROV(I),TV(I),PA(I))                    
C                                                                       
         CL(I) = THCL(HL)                                               
         CV(I) = THCV(HV,P(I),ROV(I),TV(I),PA(I))                       
C                                                                       
         SIG(I) = SIGMA(P(I),TSAT(I))                                   
C                                                                       
  100 CONTINUE                                                          
CAD +                                                                   
C
CITJ+ (11/11/98)
C
CCC   CALL TTIMER( 11, 0, 0 )                                           
C
CITJ- (11/11/98)
C
CAD -                                                                   
c      write(*,*) 'CPL =', (CPL(i),i=1,NC)
c      write(*,*) 'HL =', HL
c      write(*,*) 'P(I) =', (p(i), i=1, NC)
c      pause
      
      
      RETURN                                                            
      END                                                               

HEV.f/          929015368   0     0     100666  1184      `
C*DK HEV                                                                
      FUNCTION HEV( TEMP )                                              
      IMPLICIT REAL*8(A-H,O-Z)                                          
C     THIS FUNCTION CALCULATES THE HEAT OF EVAPORATION OF LIQUID        
C     CORRESPONDING TO A GIVEN TEMPERATURE FOR LOW PRESSURES            
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
      A   = 3180619.59D0                                                
      B   = 2470.2120D0                                                 
      T   = DMAX1(TEMP,CEOSLP(32))                                      
      HEV = A-B*T                                                       
      RETURN                                                            
      END                                                               
JAERI_STEAM.f/  929025778   0     0     100666  148128    `
      subroutine JAERI_STEAM( NIN, TZ, PZ, RO_OUT , CP_OUT,
     &           Viscos_OUT, Conduct_Out)
	                                                                          
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      CHARACTER*30    COM(21)                                                   
      CHARACTER*10   UNIT(21)                                                   
      DIMENSION IQUICK(9), fdata(21), ZTAB(19)                                          
                                                                                
      DATA IQUICK(1) / 1 /                                                      
      DATA IQUICK(2) / 2 /                                                      
      DATA IQUICK(3) / 3 /                                                      
      DATA IQUICK(4) / 4 /                                                      
      DATA IQUICK(5) / 16/                                                      
      DATA IQUICK(6) / 17/                                                      
      DATA IQUICK(7) / 18/                                                      
      DATA IQUICK(8) / 20/                                                      
      DATA IQUICK(9) / 21/                                                      
                                                                                
      DATA COM( 1) /'Pressure                      '/                           
      DATA COM( 2) /'Temperature                   '/                           
      DATA COM( 3) /'Density                       '/                           
      DATA COM( 4) /'Enthalpy                      '/                           
      DATA COM( 5) /'Entolopy                      '/                           
      DATA COM( 6) /'Internal Energy               '/                           
      DATA COM( 7) /'Isobaric Specific Heat  CP    '/                           
      DATA COM( 8) /'         Specific Heat  CV    '/                           
      DATA COM( 9) /'Squared Sound Velocity C**2   '/                           
      DATA COM(10) /'[D(Enthalpy)/D(Density)| P    '/                           
      DATA COM(11) /'1/V[D(Volume)/D(Temp)| P      '/                           
      DATA COM(12) /'CP / CV                       '/                           
      DATA COM(13) /'-1/V [D(Volume)/D(Press.)| T  '/                           
      DATA COM(14) /'Specific GIBBS Function       '/                           
      DATA COM(15) /'Specific HELMHOLTZ Function   '/                           
      DATA COM(16) /'Dynamic Viscocity             '/                           
      DATA COM(17) /'Kinematic Viscocity           '/                           
      DATA COM(18) /'Thermal Conductivity          '/                           
      DATA COM(19) /'Thermal Diffusivity           '/                           
      DATA COM(20) /'Prendtle Number               '/                           
      DATA COM(21) /'Surface Tension               '/                           
                                                                                
      DATA UNIT( 1) /' MPa      '/                                              
      DATA UNIT( 2) /' K        '/                                              
      DATA UNIT( 3) /' kG/m3    '/                                              
      DATA UNIT( 4) /' J/kG     '/                                              
      DATA UNIT( 5) /' J/kG/K   '/                                              
      DATA UNIT( 6) /' J/kG     '/                                              
      DATA UNIT( 7) /' J/kG/K   '/                                              
      DATA UNIT( 8) /' J/kG/K   '/                                              
      DATA UNIT( 9) /' k2/s2    '/                                              
      DATA UNIT(10) /' J m3/kg2 '/                                              
      DATA UNIT(11) /' 1/K      '/                                              
      DATA UNIT(12) /' -        '/                                              
      DATA UNIT(13) /' m2/N     '/                                              
      DATA UNIT(14) /' J/kG     '/                                              
      DATA UNIT(15) /' J/kG     '/                                              
      DATA UNIT(16) /' kG/m2/s  '/                                              
      DATA UNIT(17) /' m2/s     '/                                              
      DATA UNIT(18) /' W/m/K    '/                                              
      DATA UNIT(19) /' m2/s     '/                                              
      DATA UNIT(20) /' -        '/                                              
      DATA UNIT(21) /' N/m      '/                                              
                                                                                
c  100 write(6,'(1h1)')                
c      write(6,*) ' Mode Select   K = C + 273.15,  Pa = 1.0197D-5 kgf/m2'                 
c      write(6,*) '   0 : P(MPa) & T(K) : subcooled liquid or superheated 
c     &                steam '                 
c      write(6,*) '   1 : T(K)          : saturated steam'          
c      write(6,*) '   2 : P(MPa)        :           steam'          
c      write(6,*) '   3 : T(K)          : saturated liquid'         
c      write(6,*) '   4 : P(MPa)        :           liquid'         
c      WRITE(6,*) '  '                                                      
c      READ(5,*) NIN                                                             
                                                                                
      PZ = PZ*1.0D6                                                             
      CALL STEAMS(PZ,TZ,NIN,NOUT,ZTAB)                                          


C                                       WRITE(6,*) ' CHECK AFTER CALL PZ,TZ,NIN',PZ,TZ,NIN                       
      P = PZ / 1.0D6                                                            
      T = TZ             
	                                                       
      ZTAB(1) = 1.0 / ZTAB(1)                                                   

                                                                            
      DO 150 I = 1,21                                                           
      IF(I.EQ.1) FDATA(1) = P                                                   
      IF(I.EQ.2) FDATA(2) = T                                                   
      IF(I.GE.3) THEN                                                           
         J = I - 2                                                              
         FDATA(I) = ZTAB(J)                                                     
      ENDIF                                                                     
  150 CONTINUE                                                                  

                                                                                
c      WRITE(6,*) ' Detailed Data ?  YES => 1,  Simple-Set > others'          
c      READ(5,*) I                                                               
c      IF(I.eq.1) GO TO 400                                                      
                                                                                
c      DO 200 I = 1,9                                                            
c      II = IQUICK(I)                                                            
c 200  WRITE(6,10) COM(II),FDATA(II),UNIT(II)
c      go to 450
 
c 400  continue                                                                                
c      DO 300 I = 1,21                                                           
c  300 WRITE(6,10) COM(I),FDATA(I),UNIT(I)                                       
                                                                                
c  450 WRITE(6,*) '  '            
c      WRITE(6,*) ' Continue ?   YES => 1 ,  NO => others'            
c      READ(5,*) I                                                               
c      IF(I.EQ.1) GO TO 100                                                      
                                                                                
   10 FORMAT(1h ,A30,1PE12.5,A10)                
   
      RO_OUT = FDATA(3)                               
	CP_OUT = FDATA(7)
	Viscos_Out = FDATA(16)
	Conduct_Out = FDATA(18)

      return
      END                                                                       
C
C=================================================================================================
C
      SUBROUTINE STEAMS(P,T,NIN,NOUT,ZTAB)                                      
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DIMENSION ZTAB(19),ZKTAB(18),NTAB(4)                                      
C                                                                               
      PK = P * 1.0197D-5                                                        
      TK = T - 273.15                                                           
      NTAB(2) = 0                                                               
      NTAB(4) = 1                                                               
C                                                                               
      IF(NIN.EQ.1) THEN                                                         
            PK = PSAT(TK)                                                       
            P = PK * 9.8067D4                                                   
            NTAB(2) = 1                                                         
      ENDIF                                                                     
C                                                                               
      IF(NIN.EQ.2) THEN                                                         
            TK = TSAT(PK)                                                       
            T = TK + 273.15                                                     
            NTAB(2) = 1                                                         
      ENDIF                                                                     
C                                                                               
      IF(NIN.EQ.3) THEN                                                         
            PK = PSAT(TK)                                                       
            P = PK*9.8067D4                                                     
            NTAB(2) = 2                                                         
      ENDIF                                                                     
C                                                                               
      IF(NIN.EQ.4) THEN                                                         
            TK = TSAT(PK)                                                       
            T = TK + 273.15                                                     
            NTAB(2) = 2                                                         
      ENDIF                                                                     
C                                                                               
      CALL STEAMF(PK,TK,ZKTAB(1),ZKTAB(2),ZKTAB(3),ZKTAB(4),                    
     1            ZKTAB(5),ZKTAB(6),ZKTAB(7),ZKTAB(8),                          
     1            ZKTAB(9),ZKTAB(10),ZKTAB(11),ZKTAB(12),                       
     1            ZKTAB(13),ZKTAB(14),ZKTAB(15),ZKTAB(16),                      
     1            ZKTAB(17),ZKTAB(18),NTAB(1),NTAB(2),NTAB(3),NTAB(4) )         
C                                                                               
C                                                                               
      DO 100 I = 1,18                                                           
      ZTAB(I) = ZKTAB(I)                                                        
  100 CONTINUE                                                                  
C                                                                               
C                                                                               
C   SPECIFIC VOLUME     M3/KG => M3/KG                                          
C                                                                               
      ZTAB(1) = ZKTAB(1) * 1.00000                                              
C                                                                               
C   SPECIFIC ENTHALPY   KCAL/KG => J/KG                                         
C                                                                               
      ZTAB(2) = ZKTAB(2) * 4.1860D3                                             
C                                                                               
C   SPECIFIC ENTROPY    KCAL/KG C => J/KG K                                     
C                                                                               
      ZTAB(3) = ZKTAB(3) * 4.1860D3                                             
C                                                                               
C   SPECIFIC ENERGY     KCAL/KG => J/KG                                         
C                                                                               
      ZTAB(4) = ZKTAB(4) * 4.1860D3                                             
C                                                                               
C   SPECIFIC HEAT   CP    KCAL/KG C => J/KG K                                   
C                                                                               
      ZTAB(5) = ZKTAB(5) * 4.1860D3                                             
C                                                                               
C   SPECIFIC HEAT   CV    KCAL/KG C => J/KG K                                   
C                                                                               
      ZTAB(6) = ZKTAB(6) * 4.1860D3                                             
C                                                                               
C   SQUARED LIGHT VELOSITY  M2/SEC2 => M2/SEC2                                  
C                                                                               
      ZTAB(7) = ZKTAB(7) * 1.00000                                              
C                                                                               
C   DH/DRO     KCAL M3/KG2 => J M3/KG2                                          
C                                                                               
      ZTAB(8) = ZKTAB(8) * 4.1860D3                                             
C                                                                               
C                       1/K => 1/K                                              
C                                                                               
      ZTAB(9) = ZKTAB(9) * 1.00000                                              
C                                                                               
C   GAMMA                     =>                                                
C                                                                               
      ZTAB(10) = ZKTAB(10) * 1.00000                                            
C                                                                               
C   COMPRESION FACTOR    M2/N => M2/N                                           
C                                                                               
      ZTAB(11) = ZKTAB(11) * 1.00000                                            
C                                                                               
C   GIBBS FREE ENERGY     KCAL/KG => J/KG                                       
C                                                                               
      ZTAB(12) = ZKTAB(12) * 4.1860D3                                           
C                                                                               
C   HELMHOLTZ FREE ENERGY  M3/KG => M3/KG                                       
C                                                                               
      ZTAB(13) = ZKTAB(13) * 4.1860D3                                           
C                                                                               
C   VISCOSITY     MICRO POISE => KG/M2 S                                        
C                                                                               
      ZTAB(14) = ZKTAB(14) * 1.0D-7                                             
C                                                                               
C   KINEMATIC VISCOSITY    M2/S => M2/S                                         
C                                                                               
      ZTAB(15) = ZKTAB(15) * 1.00000                                            
C                                                                               
C   THERMAL CONDUCTIVITY  KCAL/M H C => W/M C                                   
C                                                                               
      ZTAB(16) = ZKTAB(16) * 1.16280                                            
C                                                                               
C   TERMAL DUFISITIVITY    M2/H => M2/S                                         
C                                                                               
      ZTAB(17) = ZKTAB(17) / 3600.00                                            
C                                                                               
C   PRANDTLE NUMBER                   =>                                        
C                                                                               
      ZTAB(18) = ZKTAB(18) * 1.00000                                            
C                                                                               
C   SURFACE TENSION                   =>                                        
C                                                                               
      CALL SYGCAL( T,ZTAB(19) )                                                 
C                                                                               
C                                                                               
      NOUT=0                                                                    
C                                                                               
      IF(ZKTAB(14).EQ.0.0.AND.ZKTAB(16).EQ.0.0)  THEN                           
             NOUT=3                                                             
             CALL VISCAL (T,1.0/ZTAB(1),VIS)                                    
               DVIS = VIS*ZTAB(1)                                               
             CALL CONCAL (T,1.0/ZTAB(1),CON)                                    
               TDIF = CON*ZTAB(1)/ZTAB(5)                                       
             PR = DVIS / TDIF                                                   
C                                                                               
             ZTAB(14) = VIS                                                     
             ZTAB(15) = DVIS                                                    
             ZTAB(16) = CON                                                     
             ZTAB(17) = TDIF                                                    
             ZTAB(18) = PR                                                      
             GO TO 1000                                                         
      ENDIF                                                                     
C                                                                               
C                                                                               
      IF(ZKTAB(16).EQ.0.0) THEN                                                 
             NOUT = 2                                                           
             CALL CONCAL(T,1.0/ZTAB(1),CON)                                     
             TDIF = CON*ZTAB(1)/ZTAB(5)                                         
             PR = ZTAB(15)/TDIF                                                 
C                                                                               
             ZTAB(16)=CON                                                       
             ZTAB(17)=TDIF                                                      
             ZTAB(18)=PR                                                        
             GO TO 1000                                                         
       ENDIF                                                                    
C                                                                               
C                                                                               
      IF(ZKTAB(14).EQ.0.0) THEN                                                 
             NOUT = 1                                                           
             CALL VISCAL(T,1.0/ZTAB(1),VIS)                                     
             DVIS = VIS*ZTAB(1)                                                 
             PR = DVIS/ZTAB(17)                                                 
C                                                                               
             ZTAB(14)=VIS                                                       
             ZTAB(15)=DVIS                                                      
             ZTAB(18)=PR                                                        
             GO TO 1000                                                         
       ENDIF                                                                    
C                                                                               
C                                                                               
 1000 CONTINUE                                                                  
C                                                                               
C                                                                               
      RETURN                                                                    
      END                                                                       
C                                                                               
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE CONCAL ( T,DEN,CON )                                           
C                                                                               
C     CONDUCTIVITY CALCULATION                                                  
C                                                                               
C                              REF.1980 JSME STEAM TABLE                        
C                                                                               
C        SI UNIT     DEN : DENSITY     KG/M3                                    
C                      T ; TEMPERATURE     K                                    
C                    CON ; THERMAL CONDUCTIVITY  W/M K                          
C                                                                               
      IMPLICIT REAL*8  (A-H,O-Z)                                                
C                                                                               
      DATA  TSTA / 647.30 /                                                     
      DATA  ROSTA / 317.7 /                                                     
      DATA  BB1 / -1.71587D-1 /                                                 
      DATA  BB2 / 2.39219 /                                                     
      DATA  C1 / 6.42857D-1 /                                                   
      DATA  C2 / -4.11717 /                                                     
      DATA  C3 / -6.17937 /                                                     
      DATA  C4 / 3.08976D-3 /                                                   
      DATA  C5 / 8.22994D-2 /                                                   
      DATA  C6 / 1.00932D1 /                                                    
      DATA  A0 / 1.02811D-2 /                                                   
      DATA  A1 / 2.99621D-2 /                                                   
      DATA  A2 / 1.56146D-2 /                                                   
      DATA  A3 / -4.22464D-3 /                                                  
      DATA  B0 / -3.97070D-1 /                                                  
      DATA  B1 / 4.00302D-1 /                                                   
      DATA  B2 / 1.06 /                                                         
      DATA  D1 / 7.01309D-2 /                                                   
      DATA  D2 / 1.18520D-2 /                                                   
      DATA  D3 / 1.69937D-3 /                                                   
      DATA  D4 / -1.02 /                                                        
C                                                                               
C                                                                               
      DTSTA = ABS( T / TSTA - 1.0 ) + C4                                        
      TRAT = T / TSTA                                                           
      IF( TRAT.GE.1.0 ) THEN                                                    
           S = DTSTA**(-1.0)                                                    
           ELSE                                                                 
           S = C6*DTSTA*(-0.6)                                                  
      ENDIF                                                                     
C                                                                               
      Q = 2.0 + C5*DTSTA**(-0.6)                                                
      R = Q + 1.0                                                               
C                                                                               
      RAM0 = TRAT**0.5 *( A0 + A1*TRAT + A2*TRAT**2 + A3*TRAT**3 )              
      RAMBAR = B0 + B1*DEN/ROSTA + B2*DEXP( BB1*(DEN/ROSTA+BB2)**2 )            
      DELRAM = ( D1*(1/TRAT)**10+D2 ) * (DEN/ROSTA)**1.8 *                      
     1         DEXP( C1*( 1.0-(DEN/ROSTA)**2.8 ) ) +                            
     2         D3*S*(DEN/ROSTA)**Q*DEXP( Q/R*(1.0-(DEN/ROSTA)**R) )             
     3       + D4*DEXP( C2*TRAT**1.5 + C3*(ROSTA/DEN)**5 )                      
C                                                                               
C                                                                               
      CON = RAM0 + RAMBAR + DELRAM                                              
C                                                                               
C                                                                               
      RETURN                                                                    
      END                                                                       
C                                                                               
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE VISCAL( T,DEN,VIS )                                            
C                                                                               
C        PROGRAM FOR VISCOSITY CALCULATION                                      
C                                                                               
C                                                                               
C           T IN K   DEN IN KG/M3  VIS IS PA.S                                  
C                                  REFFERENCE    1980 JSME STEAM TABLE          
C                                                                               
      IMPLICIT  REAL*8  (A-H,O-Z)                                               
C                                                                               
      DIMENSION A(4),B(6,5)                                                     
C                                                                               
      DATA   TSTA /647.27/                                                      
      DATA   DENSTA /317.763/                                                   
      DATA   A /  0.0181583,  0.0177624,  0.0105287, -0.0036744 /               
      DATA   B /                                                                
     * 0.501938,  0.162888, -0.130356,  0.907919, -0.551119,  0.146543,         
     * 0.235622,  0.789393,  0.673665,  1.207552,  0.0670665, -0.084337,        
     *-0.274637, -0.743539, -0.959456, -0.687343, -0.497089,  0.195286,         
     * 0.145831,  0.263129,  0.347247,  0.213486,  0.100754, -0.032932,         
     *-0.0270448,-0.0253093,-0.0267758,-0.0822904, 0.0602253,-0.0202595/        
C                                                                               
C                                                                               
      SUM = 0.0                                                                 
C                                                                               
      DO 100 I = 1,4                                                            
C                                                                               
      SUM = SUM + A(I) * ( TSTA / T )**(I-1)                                    
C                                                                               
  100 CONTINUE                                                                  
C                                                                               
      VIS0 = DSQRT( T/TSTA ) / SUM                                              
C                                                                               
      SUM = 0.0                                                                 
C                                                                               
      DO 200 I = 1,6                                                            
C                                                                               
      DO 200 J = 1,5                                                            
C                                                                               
      SUM = SUM + B(I,J) * ( TSTA / T - 1.0 )**(I-1) *                          
     *                     ( DEN / DENSTA - 1.0 )**(J-1)                        
C                                                                               
  200 CONTINUE                                                                  
C                                                                               
      VIS = VIS0 * DEXP( DEN / DENSTA * SUM )                                   
      VIS = 1.0D-6 * VIS                                                        
C                                                                               
      RETURN                                                                    
      END                                                                       
C                                                                               
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE  SYGCAL(T,SYG)                                                 
C                                                                               
C       SURFACE TENSION CALCULATION                                             
C                                                                               
C                     T IN K    ;  SYG IN N/M2                                  
C                                                                               
      REAL*8 SYG,T,TC                                                           
C                                                                               
      DATA  TC / 647.15 /                                                       
C                                                                               
      SYG = 0.2358 * (1.0-T/TC)**1.256*( 1.0-0.625*(1.0-T/TC) )                 
C                                                                               
      RETURN                                                                    
      END                                                                       
                                                                                
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
      SUBROUTINE STEAMF (P,T,SPVOL,ENTAL,ENTRO,EI,CP,CV,CC,HRHO,BETHA,          
     1                   GAMMA,AKAP,G,F,VIS,DVIS,TCON,A,PR,NREGON,              
     2                   NSTWAT,IPR,IZV)                                        
C                                                                               
C     NREGON=1 -- SUBREGION 1 (SUBROUTINE SUB1)                                 
C     NREGON=2 -- SUBREGION 2 (SUBROUTINE SUB2)                                 
C     NREGON=3 -- SUBREGION 3 (SUBROUTINE SUB3)                                 
C     NREGON=4 -- SUBREGION 4 (SUBROUTINE SUB4)                                 
C                                                                               
C     NSTWAT=0 -- COMPRESSUED WATER OR SUPERHEATED STEAM                        
C     NSTWAT=1 -- SATURATED STEAM                                               
C     NSTWAT=2 -- SATURATED WATER                                               
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      PB=0.980665*P                                                             
      BET=PB/221.2                                                              
      TK=T+273.15                                                               
      SIT=TK/647.3                                                              
      BTK=BETK(SIT)                                                             
      CALL SUBBET(SIT,BTL,BETLD,BETLDD)                                         
      BT2=4.520795660                                                           
      SIT1=0.9626911787                                                         
      SIT2=1.333462073                                                          
      SIT3=1.657886606                                                          
      SITT=273.15/647.3                                                         
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(NSTWAT.EQ.2)) GO TO 1              
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(NSTWAT.EQ.1)) GO TO 2              
      IF ((SIT.GT.SIT1.AND.SIT.LE.1.0).AND.(NSTWAT.EQ.1)) GO TO 3               
      IF ((SIT.GT.SIT1.AND.SIT.LE.1.0).AND.(NSTWAT.EQ.2)) GO TO 4               
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(BET.GT.BTK.AND.BET.LE.BT2)         
     1   ) GO TO 1                                                              
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(BET.GE.0.0.AND.BET.LT.BTK))        
     1   GO TO 2                                                                
      IF ((SIT.GT.SIT1.AND.SIT.LT.SIT2).AND.(BET.GE.0.0.AND.BET.LE.BTL))        
     1   GO TO 2                                                                
      IF ((SIT.GE.SIT2.AND.SIT.LE.SIT3).AND.(BET.GE.0.0.AND.BET.LE.BT2))        
     1   GO TO 2                                                                
      IF ((SIT.GT.SIT1.AND.SIT.LT.1.0).AND.(BET.GT.BTL.AND.BET.LT.BTK))         
     1   GO TO 3                                                                
      IF ((SIT.GE.1.0.AND.SIT.LT.SIT2).AND.(BET.GT.BTL.AND.BET.LE.BT2))         
     1   GO TO 3                                                                
      IF ((SIT.GT.SIT1.AND.SIT.LT.1.0).AND.(BET.GT.BTK.AND.BET.LE.BT2))         
     1   GO TO 4                                                                
      GO TO 5                                                                   
    1 NREGON=1                                                                  
      CALL SUB1 (SIT,BET,ZET,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    2 NREGON=2                                                                  
      CALL SUB2 (SIT,BET,ZET,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    3 NREGON=3                                                                  
      CALL SUB3 (SIT,BET,PSI,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    4 NREGON=4                                                                  
      CALL SUB4 (SIT,BET,PSI,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    5 STOP 'STEAMF (P,T,SPVOL,ENTAL,ENTRO,CP,CV,G,F,VIS,DVIS,TCON,A,PR,N        
     1REGON,NSTWAT)'                                                            
    6 SPVOL=CHI*0.00317                                                         
      ENTAL=EPS*70120.4*0.238846*0.001                                          
      ENTRO=SIG*108.3275143*0.238846*0.001                                      
      IF(IZV.EQ.0)RETURN                                                        
      TC1=647.3                                                                 
      PC1=22120000.                                                             
      VC1=.00317                                                                
      CP=FAI*108.3275143*0.238846*0.001                                         
      IF(IZV.EQ.-1)RETURN                                                       
      CV=FAV*108.3275143*0.238846*0.001                                         
      CC=RCC*PC1*VC1                                                            
      HRHO=RHRHO*VC1*VC1*PC1*.238846*.001                                       
      BETHA=RBETHA/TC1                                                          
      GAMMA=RGAM                                                                
      AKAP=RKAP/PC1                                                             
      EI=ENTAL-SPVOL*P*0.234228*100.                                            
      F=EI-TK*ENTRO                                                             
      G=ENTAL-TK*ENTRO                                                          
      CALL VISCON(P,T,SPVOL,VISMP,TCONMW,NREGON,NSTWAT)                         
      VIS=VISMP                                                                 
      DVIS=VIS*SPVOL*1.000000E-07                                               
      TCON=0.859845*0.001*TCONMW                                                
C     WRITE(6,10) NREGON                                                        
   10 FORMAT(I10)                                                               
C     RETURN                                                                    
  101 CONTINUE                                                                  
      A=TCON*SPVOL/CP                                                           
      IF(DABS(A).GE.1.0D-20) GO TO 20                                           
      IPR=0                                                                     
      PR=0.                                                                     
      RETURN                                                                    
   20 IPR=1                                                                     
      PR=DVIS*3600.0/A                                                          
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION PSAT(T)                                         
C                                                                               
C     PRESSURE OF SATURATED STEAM AS A FUNCTION OF TEMPERATURE                  
C                                                                               
C     PSAT = SATURATION PRESSURE (KG/CM2)                                       
C     T    = TEMPERATURE (OC) (0-374.15 OC)                                     
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      SIT=(T+273.15)/647.3                                                      
      BTK=BETK(SIT)                                                             
      PSAT=BTK*221.2/0.980665                                                   
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION TSAT(P)                                         
C                                                                               
C     TEMPERATURE OF SATURATED STEAM AS A FUNCTION OF PRESSURE                  
C                                                                               
C     TSAT = SATURATION TEMPERATURE (OC)                                        
C     P    = PRESSURE (KG/CM2) (0.006228-225.65 KG/CM2)                         
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      BET=P*0.980665/221.2                                                      
      TSAT=BETKP(BET)*647.3-273.15                                              
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION TSATA(P)                                        
C                                                                               
C     TEMPERATURE OF SATURATED STEAM AND WATER AS A FUNCTION OF PRESSURE        
C                                                                               
C     TSATA = SATURATED TEMPERATURE (OC)                                        
C                                                                               
C     P = PRESSURE (KG/CM2)                                                     
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      IF(P.GE.0.1) GO TO 1                                                      
      C0=-1.4027184                                                             
      C1=2.9622845                                                              
      C2=-1.1582744                                                             
      C3=3.1894969E-1                                                           
      C4=-5.5043472E-2                                                          
      C5=5.6724437E-3                                                           
      C6=-3.1813374E-4                                                          
      C7=7.4526790E-6                                                           
      XS=100.                                                                   
      YS=0.1                                                                    
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*C7)))))))/YS                  
      GO TO 5                                                                   
    1 IF(P.GE.1.5) GO TO 2                                                      
      C0=1.3909155                                                              
      C1=4.4918984                                                              
      C2=-1.7145823                                                             
      C3=3.9849678E-1                                                           
      C4=-5.0037269E-2                                                          
      C5=3.1144544E-3                                                           
      C6=-7.4511981E-5                                                          
      XS=10.                                                                    
      YS=0.1                                                                    
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*C6))))))/YS                         
      GO TO 5                                                                   
    2 IF(P.GE.10.) GO TO 3                                                      
      C0=5.4115033E-1                                                           
      C1=7.1971995E-1                                                           
      C2=-4.0200320E-1                                                          
      C3=1.7558544E-1                                                           
      C4=-5.3055241E-2                                                          
      C5=1.0852398E-2                                                           
      C6=-1.4695072E-3                                                          
      C7=1.2579400E-4                                                           
      C8=-6.1513953E-6                                                          
      C9=1.3072177E-7                                                           
      XS=1.                                                                     
      YS=0.01                                                                   
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*(C7+X*(C8+X*C9))))))))        
     1)/YS                                                                      
      GO TO 5                                                                   
    3 IF(P.GE.100.) GO TO 4                                                     
      C0=1.0164701                                                              
      C1=1.3449215                                                              
      C2=-9.0888377E-1                                                          
      C3=4.6834233E-1                                                           
      C4=-1.6377515E-1                                                          
      C5=3.8669958E-2                                                           
      C6=-6.1522423E-3                                                          
      C7=6.4864736E-4                                                           
      C8=-4.3375412E-5                                                          
      C9=1.6638736E-6                                                           
      C10=-2.7863220E-8                                                         
      XS=0.1                                                                    
      YS=0.01                                                                   
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*(C7+X*(C8+X*(C9+X*C10)        
     1)))))))))/YS                                                              
      GO TO 5                                                                   
    4 C0=2.0679536                                                              
      C1=8.4703533E-1                                                           
      C2=1.6565001                                                              
      C3=-3.1971445                                                             
      C4=2.6767174                                                              
      C5=-1.2202267                                                             
      C6=2.9377612E-1                                                           
      C7=-2.9311442E-2                                                          
      XS=0.01                                                                   
      YS=0.01                                                                   
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*C7)))))))/YS                  
    5 TSATA=Y                                                                   
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUBBET(SIT,BETL,BETLD,BETLDD)                                  
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      DOUBLE PRECISION L0,L1,L2                                                 
C                                                                               
      L0=1.574373327D+01                                                        
      L1=-3.417061978D+01                                                       
      L2=1.931380707D+01                                                        
      BETL=L0+SIT*(L1+SIT*L2)                                                   
      BETLD=L1+2.0*L2*SIT                                                       
      BETLDD=2.0*L2                                                             
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C     THE OPTION 'FORT='AUTODBL(DBLPAD4)' ' SHOULD BE USED                      
C     IN COMPILING THIS PROGRAM BY THE 'FORTRAN-HE COMPILER.                    
C     OPTION DOUBLE                                                             
      SUBROUTINE SUB1 (SIT,BET,ZETA,CHI1,SIG1,EPS1,FAI1,FAV1,RHRHO1,            
     1                 RCC1,RBETHA,RKAP1,RGAM1,IZV)                             
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
C     SUBREGION 1                                                               
C                                                                               
      A0=6.824687741D+03                                                        
      A1=-5.422063673D+02                                                       
      A2=-2.096666205D+04                                                       
      A3=3.941286787D+04                                                        
      A4=-6.733277739D+04                                                       
      A5=9.902381028D+04                                                        
      A6=-1.093911774D+05                                                       
      A7=8.590841667D+04                                                        
      A8=-4.511168742D+04                                                       
      A9=1.418138926D+04                                                        
      A10=-2.017271113D+03                                                      
      A11=7.982692717D+00                                                       
      A12=-2.616571843D-02                                                      
      A13=1.522411790D-03                                                       
      A14=2.284279054D-02                                                       
      A15=2.421647003D+02                                                       
      A16=1.269716088D-10                                                       
      A17=2.074838328D-07                                                       
      A18=2.174020350D-08                                                       
      A19=1.105710498D-09                                                       
      A20=1.293441934D+01                                                       
      A21=1.308119072D-05                                                       
      A22=6.047626338D-14                                                       
      AS1=8.438375405D-01                                                       
      AS2=5.362162162D-04                                                       
      AS3=1.720000000D+00                                                       
      AS4=7.342278489D-02                                                       
      AS5=4.975858870D-02                                                       
      AS6=6.537154300D-01                                                       
      AS7=1.150000000D-06                                                       
      AS8=1.510800000D-05                                                       
      AS9=1.418800000D-01                                                       
      AS10=7.002753165D+00                                                      
      AS11=2.995284926D-04                                                      
      AS12=2.040000000D-01                                                      
      Y=1.0-AS1*SIT**2-AS2*SIT**(-6)                                            
      Z=Y+DSQRT(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)                               
      ZETA=A0*SIT*(1.0-DLOG(SIT))+A1+SIT*(A2+SIT*(A3+SIT*(A4+SIT*(A5            
     1     +SIT*(A6+SIT*(A7+SIT*(A8+SIT*(A9+SIT*A10))))))))+A11*(17.0/          
     2     29.0*Z-17.0/12.0*Y)*Z**(12./17.)+(A12+A13*SIT+A14*SIT**2+A15*        
     3     (AS6-SIT)**10+A16*(AS7+SIT**19)**(-1))*BET-(AS8+SIT**11)**           
     4     (-1)*BET*(A17+BET*(A18+BET*A19))-A20*SIT**18*(AS9+SIT**2)*           
     5     ((AS10+BET)**(-3)+AS11*BET)+A21*(AS12-SIT)*BET**3+A22*SIT**          
     6     (-20)*BET**4                                                         
      CHI1=A11*AS5*Z**(-5./17.)+(A12+A13*SIT+A14*SIT**2+A15*(AS6-SIT)**         
     1     10+A16*(AS7+SIT**19)**(-1))-(AS8+SIT**11)**(-1)*(A17+2.0*A18*        
     2     BET+3.0*A19*BET**2)-A20*SIT**18*(AS9+SIT**2)*(-3.0*(AS10+BET)        
     3     **(-4)+AS11)+3.0*A21*(AS12-SIT)*BET**2+4.0*A22*SIT**(-20)*           
     4     BET**3                                                               
      YS=-2.0*AS1*SIT+6.0*AS2*SIT**(-7)                                         
      SIG1=A0*DLOG(SIT)-A2-SIT*(2.0*A3+SIT*(3.0*A4+SIT*(4.0*A5+SIT*(5.0         
     1     *A6+SIT*(6.0*A7+SIT*(7.0*A8+SIT*(8.0*A9+SIT*9.0*A10)))))))           
     2     +A11*((5.0/12.0*Z-(AS3-1.0)*Y)*YS+AS4)*Z**(-5./17.)+(-A13-2.*        
     3     A14*SIT+10.0*A15*(AS6-SIT)**9+19.0*A16*(AS7+SIT**19)**(-2)*          
     4     SIT**18)*BET-11.0*(AS8+SIT**11)**(-2)*SIT**10*(A17*BET+A18*          
     5     BET**2+A19*BET**3)+A20*SIT**17*(18.0*AS9+20.0*SIT**2)*((AS10         
     6     +BET)**(-3)+AS11*BET)+A21*BET**3+20.0*A22*SIT**(-21)*BET**4          
      EPS1=ZETA+SIT*SIG1                                                        
      IF(IZV.EQ.0)RETURN                                                        
      YSS=-2.0*AS1-42.0*AS2*SIT**(-8)                                           
      ZS=YS+(AS3*Y*YS-AS4)*(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)**(-0.5)           
      ZSS=YSS+AS3*(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)**(-0.5)*(YS**2+Y*          
     1    YSS)-(AS3*Y*YS-AS4)**2*(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)**           
     2    (-1.5)                                                                
      ZESS=-A0*SIT**(-1)+1.0*2.0*A3+SIT*(2.0*3.0*A4+SIT*(3.0*4.0*A5+SIT*        
     1     (4.0*5.0*A6+SIT*(5.0*6.0*A7+SIT*(6.0*7.0*A8+SIT*(7.0*8.0*A9+         
     2     SIT*8.*9.*A10))))))+A11*((12./29.*Z-Y)*(Z**(-5./17.)*ZSS-5./1        
     3     7.*Z**(-22./17.)*ZS**2)+(24./29.*ZS-2.*YS)*Z**(-5./17.)*ZS+(         
     4     17./29.*ZSS-17./12.*YSS)*Z**(12./17.))+BET*(2.0*A14+90.0*A15*        
     5     (AS6-SIT)**8+722.0*A16*SIT**36*(AS7+SIT**19)**(-3)-342.0*A16*        
     6     SIT**17*(AS7+SIT**19)**(-2))-(242.0*SIT**20*(AS8+SIT**11)**          
     7     (-3)-110.0*SIT**9*(AS8+SIT**11)**(-2))*(A17*BET+A18*BET**2+          
     8     A19*BET**3)-A20*SIT**16*(306.0*AS9+380.0*SIT**2)*((AS10+BET)         
     9     **(-3)+AS11*BET)+420.0*A22*SIT**(-22)*BET**4                         
      FAI1=-SIT*ZESS                                                            
      IF(IZV.EQ.-1)RETURN                                                       
      ZB=AS5/(Z-Y)                                                              
      ZSB=-0.5*AS5/(Z-Y)**3*(2.0*AS3*Y*YS-2.0*AS4)                              
      ZBB=-AS5**2/(Z-Y)**3                                                      
      ZESB=-                                                                    
     A     5.0/17.0*A11*ZB*Z**(-22.0/17.0)*(Z*YS+(AS3-1.0)*Y*YS-AS4)+           
     1     (A13+2.0*A14*SIT-10.0*A15*(AS6-SIT)**9-19.0*A16*(AS7+SIT**19)        
     2     **(-2)*SIT**18)+11.0*(AS8+SIT**11)**(-2)*SIT**10*(A17+2.0*A18        
     3     *BET+3.0*A19*BET**2)-2.0*A20*SIT**17*(9.0*AS9+10.0*SIT**2)*(         
     4     -3.0*(AS10+BET)**(-4)+AS11)-3.0*A21*BET**2-80.0*A22*SIT**            
     5     (-21)*BET**3                                                         
      ZEBB=-5.0/17.0*A11*AS5*Z**(-22.0/17.0)*ZB-(AS8+SIT**11)**(-1)*(2.0        
     1     *A18+6.0*A19*BET)-12.0*A20*SIT**18*(AS9+SIT**2)*(AS10+BET)**         
     2     (-5)+6.0*A21*(AS12-SIT)*BET+12.0*A22*SIT**(-20)*BET**2               
      FAV1=FAI1+SIT*ZESB**2/ZEBB                                                
      CHI1SQ=CHI1*CHI1                                                          
      ZEBBSQ=ZEBB*ZEBB                                                          
      RHRHO1=CHI1SQ*SIT*ZESS/ZESB                                               
      ZESBSQ=ZESB*ZESB                                                          
      RCC1=-CHI1SQ/(ZEBB-ZESBSQ/ZESS)                                           
      RBETHA=ZESB/CHI1                                                          
      RKAP1=-ZEBB/CHI1                                                          
      RGAM1=FAI1/FAV1                                                           
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUB2 (SIT,BET,ZETB,CHI2,SIG2,EPS2,FAI2,FAV2,RHRHO2,            
     1                  RCC2,RBETHA,RKAP2,RGAM2,IZV)                            
C                                                                               
C     SUBREGION 2                                                               
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DIMENSION B(8,3),BS(8,2)                                                  
C                                                                               
      B0= 1.683599274D+01                                                       
      B01=2.856067796D+01                                                       
      B02=-5.438923329D+01                                                      
      B03=4.330662834D-01                                                       
      B04=-6.547711697D-01                                                      
      B05=8.565182058D-02                                                       
      B90=1.936587558D+02                                                       
      B91=-1.388522425D+03                                                      
      B92=4.126607219D+03                                                       
      B93=-6.508211677D+03                                                      
      B94=5.745984054D+03                                                       
      B95=-2.693088365D+03                                                      
      B96=5.235718623D+02                                                       
      BB=7.633333333D-01                                                        
      B(1,1)=6.670375918D-02                                                    
      B(1,2)=1.388983801D+00                                                    
      B(1,3)=0.                                                                 
      B(2,1)=8.390104328D-02                                                    
      B(2,2)=2.614670893D-02                                                    
      B(2,3)=-3.373439453D-02                                                   
      B(3,1)=4.520918904D-01                                                    
      B(3,2)=1.069036614D-01                                                    
      B(3,3)=0.                                                                 
      B(4,1)=-5.975336707D-01                                                   
      B(4,2)=-8.847535804D-02                                                   
      B(4,3)=0.                                                                 
      B(5,1)=5.958051609D-01                                                    
      B(5,2)=-5.159303373D-01                                                   
      B(5,3)=2.075021122D-01                                                    
      B(6,1)=1.190610271D-01                                                    
      B(6,2)=-9.867174132D-02                                                   
      B(6,3)=0.                                                                 
      B(7,1)=1.683998803D-01                                                    
      B(7,2)=-5.809438001D-02                                                   
      B(7,3)=0.                                                                 
      B(8,1)=6.552390126D-03                                                    
      B(8,2)=5.710218649D-04                                                    
      B(8,3)=0.                                                                 
      BS(1,1)=0.                                                                
      BS(1,2)=0.                                                                
      BS(2,1)=0.                                                                
      BS(2,2)=0.                                                                
      BS(3,1)=0.                                                                
      BS(3,2)=0.                                                                
      BS(4,1)=0.                                                                
      BS(4,2)=0.                                                                
      BS(5,1)=0.                                                                
      BS(5,2)=0.                                                                
      BS(6,1)=4.006073948D-01                                                   
      BS(6,2)=0.                                                                
      BS(7,1)=8.636081627D-02                                                   
      BS(7,2)=0.                                                                
      BS(8,1)=-8.532322921D-01                                                  
      BS(8,2)=3.460208861D-01                                                   
      TC1=647.3                                                                 
      PC1=22120000.0                                                            
      VC1=0.00317                                                               
      R1=461.51                                                                 
      AI1=R1*TC1/(PC1*VC1)                                                      
      X=DEXP(BB*(1.0-SIT))                                                      
      CALL SUBBET(SIT,BETL,BETLD,BETLDD)                                        
      S01=0.0                                                                   
      S02=0.0                                                                   
      S03=0.0                                                                   
      S04=0.0                                                                   
      S05=0.0                                                                   
      S06=0.0                                                                   
      S07=0.0                                                                   
      S08=0.0                                                                   
      S09=0.0                                                                   
      S10=0.0                                                                   
      DO 4 I=1,8                                                                
      BX=0.0                                                                    
      ZBX=0.0                                                                   
      BZX=0.0                                                                   
      BXA=0.0                                                                   
      BXB=0.0                                                                   
      BXC=0.0                                                                   
      NNI=NN(I)                                                                 
      NLI=NL(I)                                                                 
      DO 2 J=1,NNI                                                              
      SBX=0.0                                                                   
      XBX=0.0                                                                   
      NZIJ=NZ(I,J)                                                              
      FNZIJ=FLOAT(NZIJ)                                                         
      DO 1 K=1,NLI                                                              
      NXIK=NX(I,K)                                                              
      FNXIK=FLOAT(NXIK)                                                         
      SBX=SBX+BS(I,K)*X**NXIK                                                   
      XBX=XBX+FNXIK*BS(I,K)*X**NXIK                                             
    1 CONTINUE                                                                  
      BX=BX+B(I,J)*X**NZIJ                                                      
      ZBX=ZBX+FNZIJ*B(I,J)*X**NZIJ                                              
      BZX=BZX+B(I,J)*(1.0+FNZIJ*BB*SIT)*X**NZIJ                                 
      BXA=BXA+B(I,J)*X**NZIJ*(FNZIJ-XBX/(BET**(2-I)+SBX))                       
      BXB=BXB+B(I,J)*X**NZIJ*(-FNZIJ*(BET**(2-I)+SBX)+2.0*XBX)                  
      BXC=BXC+B(I,J)*X**NZIJ*FLOAT(2-I)*(FLOAT(1-I)*BET**(-I)*(BET**            
     1    (2-I)+SBX)-2.0*FLOAT(2-I)*BET**(2*(1-I)))                             
    2 CONTINUE                                                                  
      IF (I.GE.6) GO TO 3                                                       
      S01=S01+BET**I*BX                                                         
      S03=S03+FLOAT(I)*BET**(I-1)*BX                                            
      S05=S05+BET**I*ZBX                                                        
      S07=S07+FLOAT(I)*BET**(I-1)*ZBX                                           
      S09=S09+FLOAT(I*(I-1))*BET**(I-2)*BX                                      
      GO TO 4                                                                   
    3 S02=S02+BX/(BET**(2-I)+SBX)                                               
      S04=S04+FLOAT(I-2)*BET**(1-I)*BX/(BET**(2-I)+SBX)**2                      
      S06=S06+BXA/(BET**(2-I)+SBX)                                              
      S08=S08+FLOAT(2-I)*BET**(1-I)*BXB/(BET**(2-I)+SBX)**2/(BET**(2-I)+        
     1    SBX)                                                                  
      S10=S10+BXC/(BET**(2-I)+SBX)**2/(BET**(2-I)+SBX)                          
    4 CONTINUE                                                                  
      ZETB=AI1*SIT*DLOG(BET)+B0*SIT*(1.0-DLOG(SIT))+B01+SIT*(B02+SIT*           
     1 (B03+SIT*(B04+SIT*B05)))-S01-S02+BET*(BET/BETL)**10*(B90+X*(B91+         
     2     X*(B92+X*(B93+X*(B94+X*(B95+X*B96))))))                              
      CHI2=AI1*SIT/BET-S03-S04+11.0*(BET/BETL)**10*(B90+X*(B91+X*(B92+X*        
     1     (B93+X*(B94+X*(B95+X*B96))))))                                       
      BBLD=10.0*BETLD/BETL                                                      
      SIG2=-AI1*DLOG(BET)+B0*DLOG(SIT)-B02-SIT*(2.0*B03+SIT*(3.0*B04+SIT        
     1     *4.0*B05))-BB*S05-BB*S06+BET*(BET/BETL)**10*(BBLD*B90+(BBLD+         
     2     BB)*B91*X+(BBLD+2.0*BB)*B92*X**2+(BBLD+3.0*BB)*B93*X**3+(BBLD        
     3     +4.0*BB)*B94*X**4+(BBLD+5.0*BB)*B95*X**5+(BBLD+6.0*BB)*B96*X         
     4     **6)                                                                 
      EPS2=ZETB+SIT*SIG2                                                        
           IF(IZV.EQ.0)RETURN                                                   
      BX61=B(6,1)*X**12*BET**4                                                  
      BX62=B(6,2)*X**11*BET**4                                                  
      BX71=B(7,1)*X**24*BET**5                                                  
      BX72=B(7,2)*X**18*BET**5                                                  
      BX81=B(8,1)*X**24*BET**6                                                  
      BX82=B(8,2)*X**14*BET**6                                                  
      BSX61=BS(6,1)*X**14*BET**4                                                
      BSX71=BS(7,1)*X**19*BET**5                                                
      BSX81=BS(8,1)*X**54*BET**6                                                
      BSX82=BS(8,2)*X**27*BET**6                                                
      F60=BX61+BX62                                                             
      F61=-BB*(12.0*BX61+11.0*BX62)                                             
      F62=BB**2*(144.0*BX61+121.0*BX62)                                         
      F70=BX71+BX72                                                             
      F71=-BB*(24.0*BX71+18.0*BX72)                                             
      F72=BB**2*(576.0*BX71+324.0*BX72)                                         
      F80=BX81+BX82                                                             
      F81=-BB*(24.0*BX81+14.0*BX82)                                             
      F82=BB**2*(576.0*BX81+196.0*BX82)                                         
      G60=1.0+BSX61                                                             
      G61=-14.0*BB*BSX61                                                        
      G62=196.0*BB**2*BSX61                                                     
      G70=1.0+BSX71                                                             
      G71=-19.0*BB*BSX71                                                        
      G72=361.0*BB**2*BSX71                                                     
      G80=1.0+BSX81+BSX82                                                       
      G81=-BB*(54.0*BSX81+27.0*BSX82)                                           
      G82=BB**2*(2916.0*BSX81+729.0*BSX82)                                      
      ZESS=-B0*SIT**(-1)+2.0*B03+6.0*B04*SIT+12.0*B05*SIT**2-(169.0*B(1,        
     1  1)*X**13+9.0*B(1,2)*X**3)*BB**2*BET-(324.0*B(2,1)*X**18+4.0*            
     2     B(2,2)*X**2+B(2,3)*X)*BB**2*BET**2-(324.0*B(3,1)*X**18+100.*         
     3     B(3,2)*X**10)*BB**2*BET**3-(625.0*B(4,1)*X**25+196.0*B(4,2)*         
     4     X**14)*BB**2*BET**4-(1024.0*B(5,1)*X**32+784.0*B(5,2)*X**28          
     5     +576.0*B(5,3)*X**24)*BB**2*BET**5-(F62/G60-(2.0*F61*G61+F60*         
     6     G62)/G60**2+2.0*F60*G61**2/G60**3)-(F72/G70-(2.0*F71*G71+F70         
     7     *G72)/G70**2+2.0*F70*G71**2/G70**3)-(F82/G80-(2.0*F81*G81+F80        
     8     *G82)/G80**2+2.0*F80*G81**2/G80**3)                                  
      ZESS=ZESS+(BET/BETL)**11*((110.0*BETLD**2/BETL-10.0*BETLDD)*(B90+         
     1     X*(B91+X*(B92+X*(B93+X*(B94+X*(B95+X*B96))))))+20.0*BB*BETLD*        
     2     X*(B91+X*(2.0*B92+X*(3.0*B93+X*(4.0*B94+X*(5.0*B95+X*6.0*B96)        
     3     ))))+BB**2*BETL*X*(B91+X*(4.0*B92+X*(9.0*B93+X*(16.0*B94+X*(         
     4     25.0*B95+X*36.0*B96))))))                                            
      FAI2=-SIT*ZESS                                                            
      IF(IZV.EQ.-1)RETURN                                                       
      ZESB=AI1/BET+BB*(S07+S08)-11.0*(BET/BETL)**10*(B90*BBLD+X*(B91*(          
     1     BBLD+BB)+X*(B92*(BBLD+2.0*BB)+X*(B93*(BBLD+3.0*BB)+X*(B94*(          
     2     BBLD+4.0*BB)+X*(B95*(BBLD+5.0*BB)+X*B96*(BBLD+6.0*BB)))))))          
      ZEBB=-AI1*SIT/BET**2-S09+S10+110.0/BETL*(BET/BETL)**9*(B90+X*(B91+        
     1     X*(B92+X*(B93+X*(B94+X*(B95+X*B96))))))                              
      FAV2=FAI2+SIT*ZESB**2/ZEBB                                                
      CHI2SQ=CHI2*CHI2                                                          
      ZESBSQ=ZESB*ZESB                                                          
      RHRHO2=CHI2SQ*SIT*ZESS/ZESB                                               
      RCC2=-CHI2SQ/(ZEBB-ZESBSQ/ZESS)                                           
      RBETHA=ZESB/CHI2                                                          
      RKAP2=-ZEBB/CHI2                                                          
      RGAM2=FAI2/FAV2                                                           
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUB3 (SIT,BET,PSIC,CHI,SIG3,EPS3,FAI3,FAV3,RHRHO3,RCC3,        
     1                 RBETHA,RKAP3,RGAM3,IZV)                                  
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
C     SUBREGION 3                                                               
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C012=-4.311577033D+00                                                     
      C11=7.086360850D-01                                                       
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
      CH0=CHI3(SIT,BET)                                                         
      N=0                                                                       
    1 CX=1.0/CH0                                                                
      F3=-(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))-BET                 
      F3D=-CX**3*(2.0*C02+CX*(6.0*C03+CX*(12.0*C04+CX*(20.0*C05+CX*(30.0        
     1    *C06+CX*(42.0*C07+CX*(56.0*C08+CX*(72.0*C09+CX*(90.0*C010+CX*         
     2    110.0*C011)))))))))+C012*CX**2-(CX**3*(2.0*C12+CX*(6.0*C13+CX*        
     3    (12.0*C14+CX*(20.0*C15+CX*30.0*C16))))-C17*CX**2)*SX-(CX**3*(         
     4    2.0*C22+CX*(6.0*C23+CX*(12.0*C24+CX*(20.0*C25+CX*(30.0*C26+CX*        
     5    42.0*C27)))))-C28*CX**2)*SX**2-(CX**3*(2.0*C32+CX*(6.0*C33+CX*        
     6    (12.0*C34+CX*(20.0*C35+CX*(30.0*C36+CX*(42.0*C37+CX*(56.0*C38+        
     7    CX*72.0*C39)))))))-C310*CX**2)*SX**3-30.0*C41*CX**7*SIT**(-23)        
     8    *SX-30.0*CH0**4*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64        
     9    ))))                                                                  
      CHI=CH0-F3/F3D                                                            
      IF (DABS(CH0/CHI-1.0).LE.1.0D-07) GO TO 2                                 
      N=N+1                                                                     
      IF(N.EQ.50) WRITE(6,10) N,CH0,CHI                                         
   10 FORMAT(10X,'SUB3',I5,2E20.7)                                              
      IF (N.GE.50) GO TO 2                                                      
      CH0=CHI                                                                   
      GO TO 1                                                                   
    2 CONTINUE                                                                  
      CX=1.0/CHI                                                                
      PSIC=C00+C01*CHI+CX*(C02+CX*(C03+CX*(C04+CX*(C05+CX*(C06+CX*(C07+         
     1     CX*(C08+CX*(C09+CX*(C010+CX*C011)))))))))+C012*DLOG(CHI)+(C11        
     2     *CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))+C17*DLOG(CHI)        
     3     )*SX+(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27)        
     4     ))))+C28*DLOG(CHI))*SX**2+(C31*CHI+CX*(C32+CX*(C33+CX*(C34+CX        
     5     *(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI))*         
     6     SX**3+(C40+C41*CHI**(-5))*SIT**(-23)*SX+C50*SIT*DLOG(SIT)+CHI        
     7     **6*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))+SX*           
     8     (C70+SX*(C71+SX*(C72+SX*(C73+SX*(C74+SX*(C75+SX*(C76+SX*(C77+        
     9     SX*C78))))))))                                                       
      SIG3=-(C11*CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))                 
     1     +C17*DLOG(CHI)+C50)-2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(        
     2     C25+CX*(C26+CX*C27)))))+C28*DLOG(CHI))*SX-3.0*(C31*CHI+CX*           
     3     (C32+CX*(C33+CX*(C34+CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)         
     4     ))))))+C310*DLOG(CHI))*SX**2+(C40+C41*CHI**(-5))*(22.0*SIT**         
     5     (-23)-23.0*SIT**(-24))-C50*DLOG(SIT)+CHI**6*SX1**3*(2.0*C60+         
     6     SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*6.0*C64))))-C70-          
     7     SX*(2.0*C71+SX*(3.0*C72+SX*(4.0*C73+SX*(5.0*C74+SX*(6.0*C75+         
     8     SX*(7.0*C76+SX*(8.0*C77+SX*9.0*C78)))))))                            
      EPS3=PSIC+SIT*SIG3+CHI*BET                                                
      IF(IZV.EQ.0)RETURN                                                        
      PSICD1=2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27        
     1       )))))+C28*DLOG(CHI))+6.0*(C31*CHI+CX*(C32+CX*(C33+CX*(C34+         
     2       CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI        
     3       ))*SX+(C40+C41*CHI**(-5))*(506.0*SIT-552.0)*SIT**(-25)+C50*        
     4       SX1+CHI**6*SX1**4*(6.0*C60+SX1*(12.0*C61+SX1*(20.0*C62+SX1*        
     5       (30.0*C63+SX1*42.0*C64))))+2.0*C71+SX*(6.0*C72+SX*(12.0*C73        
     6       +SX*(20.0*C74+SX*(30.0*C75+SX*(42.0*C76+SX*(56.0*C77+SX*72.        
     7       0*C78))))))                                                        
      PSICD2=C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*C14+CX*(4.0*C15+CX*5.0*         
     1       C16))))+C17*CX+2.0*(C21-CX**2*(C22+CX*(2.0*C23+CX*(3.0*C24         
     2       +CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))+C28*CX)*SX+3.0*(          
     3       C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(4.0*C35+CX*(5.0*        
     4       C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))+C310*CX)*SX**        
     5       2-5.0*C41*CHI**(-6)*(23.0-22.0*SIT)*SIT**(-24)-6.0*CHI**5*         
     6       SX1**3*(2.0*C60+SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*        
     7       6.0*C64))))                                                        
      PSICD3=-F3D                                                               
      CHISQ=CHI*CHI                                                             
      RHRHO3=CHISQ*SIT*(-PSICD1*PSICD3/PSICD2+PSICD2)                           
      RCC3=CHISQ*(PSICD3-PSICD2*PSICD2/PSICD1)                                  
      RKAP3=1./CHI/PSICD3                                                       
      RBETHA=-RKAP3*PSICD2                                                      
      FAV3=-SIT*PSICD1                                                          
      FAI3=FAV3+SIT*PSICD2**2/PSICD3                                            
      RGAM3=FAI3/FAV3                                                           
    3 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUB4 (SIT,BET,PSID,CHI,SIG4,EPS4,FAI4,FAV4,RHRHO4,             
     1                 RCC4,RBETHA,RKAP4,RGAM4,IZV)                             
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
C     SUBREGION 4                                                               
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C11=7.086360850D-01                                                       
      C012=-4.311577033D+00                                                     
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      D30=-1.717616747D+00                                                      
      D31=3.526389875D+00                                                       
      D32=-2.690899373D+00                                                      
      D33=9.070982605D-01                                                       
      D34=-1.138791156D-01                                                      
      D40=1.301023613D+00                                                       
      D41=-2.642777743D+00                                                      
      D42=1.996765362D+00                                                       
      D43=-6.661557013D-01                                                      
      D44=8.270860589D-02                                                       
      D50=3.426663535D-04                                                       
      D51=-1.236521258D-03                                                      
      D52=1.155018309D-03                                                       
      SIT1=9.626911787D-01                                                      
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
      SX2=1.0-SIT1                                                              
      Y=(1.0-SIT)/(1.0-SIT1)                                                    
      CH0=CHI4(SIT,BET)                                                         
      N=0                                                                       
    1 CX=1.0/CH0                                                                
      F3=-(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))                     
      F3D=-CX**3*(2.0*C02+CX*(6.0*C03+CX*(12.0*C04+CX*(20.0*C05+CX*(30.0        
     1    *C06+CX*(42.0*C07+CX*(56.0*C08+CX*(72.0*C09+CX*(90.0*C010+CX*         
     2    110.0*C011)))))))))+C012*CX**2-(CX**3*(2.0*C12+CX*(6.0*C13+CX*        
     3    (12.0*C14+CX*(20.0*C15+CX*30.0*C16))))-C17*CX**2)*SX-(CX**3*(         
     4    2.0*C22+CX*(6.0*C23+CX*(12.0*C24+CX*(20.0*C25+CX*(30.0*C26+CX*        
     5    42.0*C27)))))-C28*CX**2)*SX**2-(CX**3*(2.0*C32+CX*(6.0*C33+CX*        
     6    (12.0*C34+CX*(20.0*C35+CX*(30.0*C36+CX*(42.0*C37+CX*(56.0*C38+        
     7    CX*72.0*C39)))))))-C310*CX**2)*SX**3-30.0*C41*CX**7*SIT**(-23)        
     8    *SX-30.0*CH0**4*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64        
     9    ))))                                                                  
      F4=F3-BET+Y**3*CX**2*(D31+CX*(2.0*D32+CX*(3.0*D33+CX*4.0*D34)))           
     1   +Y**4*CX**2*(D41+CX*(2.0*D42+CX*(3.0*D43+CX*4.0*D44)))-Y**32*(         
     2   D51+2.0*D52*CH0)                                                       
      F4D=F3D-Y**3*CX**3*(2.0*D31+CX*(6.0*D32+CX*(12.0*D33+CX*20.0*D34))        
     1    )-Y**4*CX**3*(2.0*D41+CX*(6.0*D42+CX*(12.0*D43+CX*20.0*D44)))         
     2    -Y**32*2.0*D52                                                        
      CHI=CH0-F4/F4D                                                            
      IF (DABS(CH0/CHI-1.0).LE.1.0D-07) GO TO 2                                 
      N=N+1                                                                     
      IF(N.EQ.50) WRITE(6,10) N,CH0,CHI                                         
   10 FORMAT(10X,'SUB4',I5,2E20.7)                                              
      IF (N.GE.50) GO TO 2                                                      
      CH0=CHI                                                                   
      GO TO 1                                                                   
    2 CONTINUE                                                                  
      CX=1.0/CHI                                                                
      PSIC=C00+C01*CHI+CX*(C02+CX*(C03+CX*(C04+CX*(C05+CX*(C06+CX*(C07+         
     1     CX*(C08+CX*(C09+CX*(C010+CX*C011)))))))))+C012*DLOG(CHI)+(C11        
     2     *CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))+C17*DLOG(CHI)        
     3     )*SX+(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27)        
     4     ))))+C28*DLOG(CHI))*SX**2+(C31*CHI+CX*(C32+CX*(C33+CX*(C34+CX        
     5     *(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI))*         
     6     SX**3+(C40+C41*CHI**(-5))*SIT**(-23)*SX+C50*SIT*DLOG(SIT)+CHI        
     7     **6*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))+SX*           
     8     (C70+SX*(C71+SX*(C72+SX*(C73+SX*(C74+SX*(C75+SX*(C76+SX*(C77+        
     9     SX*C78))))))))                                                       
      SIG3=-(C11*CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))                 
     1     +C17*DLOG(CHI)+C50)-2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(        
     2     C25+CX*(C26+CX*C27)))))+C28*DLOG(CHI))*SX-3.0*(C31*CHI+CX*           
     3     (C32+CX*(C33+CX*(C34+CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)         
     4     ))))))+C310*DLOG(CHI))*SX**2+(C40+C41*CHI**(-5))*(22.0*SIT**         
     5     (-23)-23.0*SIT**(-24))-C50*DLOG(SIT)+CHI**6*SX1**3*(2.0*C60+         
     6     SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*6.0*C64))))-C70-          
     7     SX*(2.0*C71+SX*(3.0*C72+SX*(4.0*C73+SX*(5.0*C74+SX*(6.0*C75+         
     8     SX*(7.0*C76+SX*(8.0*C77+SX*9.0*C78)))))))                            
      BET3=F3                                                                   
      EPS3=PSIC+SIT*SIG3+CHI*BET3                                               
      PSICD1=2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27        
     1       )))))+C28*DLOG(CHI))+6.0*(C31*CHI+CX*(C32+CX*(C33+CX*(C34+         
     2       CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI        
     3       ))*SX+(C40+C41*CHI**(-5))*(506.0*SIT-552.0)*SIT**(-25)+C50*        
     4       SX1+CHI**6*SX1**4*(6.0*C60+SX1*(12.0*C61+SX1*(20.0*C62+SX1*        
     5       (30.0*C63+SX1*42.0*C64))))+2.0*C71+SX*(6.0*C72+SX*(12.0*C73        
     6       +SX*(20.0*C74+SX*(30.0*C75+SX*(42.0*C76+SX*(56.0*C77+SX*72.        
     7       0*C78))))))                                                        
      PSICD2=C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*C14+CX*(4.0*C15+CX*5.0*         
     1       C16))))+C17*CX+2.0*(C21-CX**2*(C22+CX*(2.0*C23+CX*(3.0*C24         
     2       +CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))+C28*CX)*SX+3.0*(          
     3       C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(4.0*C35+CX*(5.0*        
     4       C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))+C310*CX)*SX**        
     5       2-5.0*C41*CHI**(-6)*(23.0-22.0*SIT)*SIT**(-24)-6.0*CHI**5*         
     6       SX1**3*(2.0*C60+SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*        
     7       6.0*C64))))                                                        
      PSICD3=-F3D                                                               
      FAV3=-SIT*PSICD1                                                          
      FAI3=FAV3+SIT*PSICD2**2/PSICD3                                            
      PSID=Y**3*(D30+CX*(D31+CX*(D32+CX*(D33+CX*D34))))+Y**4*(D40+CX*(          
     1     D41+CX*(D42+CX*(D43+CX*D44))))+Y**32*(D50+CHI*(D51+CHI*D52))         
      SIG4=SIG3+(3.0*Y**2*(D30+CX*(D31+CX*(D32+CX*(D33+CX*D34))))+4.0*          
     1     Y**3*(D40+CX*(D41+CX*(D42+CX*(D43+CX*D44))))+32.0*Y**31*(D50+        
     2     CHI*(D51+CHI*D52)))/SX2                                              
      EPS4=EPS3+PSID+(SIG4-SIG3)*SIT+(BET-BET3)*CHI                             
      IF(IZV.EQ.0)RETURN                                                        
      FAV4=SIT*(-PSICD1-1.0/SX2**2*(6.0*Y*(D30+CX*(D31+CX*(D32+CX*(D33+         
     1     CX*D34))))+12.0*Y**2*(D40+CX*(D41+CX*(D42+CX*(D43+CX*D44))))+        
     2     992.0*Y**30*(D50+CHI*(D51+CHI*D52))))                                
      FAI4=FAV4+SIT*(PSICD2+1.0/SX2*(3.0*Y**2*CX**2*(D31+CX*(2.0*D32+CX*        
     1     (3.0*D33+CX*4.0*D34)))+4.0*Y**3*CX**2*(D41+CX*(2.0*D42+CX*(          
     2     3.0*D43+CX*4.0*D44)))                                                
     A     -32.*Y**31*(D51+2.0*D52*CHI)                                         
     B                          ))**2/(PSICD3+Y**3*CX**3*(2.0*D31+CX*(6.        
     3     *D32+CX*(12.0*D33+CX*20.0*D34)))+Y**4*CX**3*(2.0*D41+CX*(6.0         
     4     *D42+CX*(12.0*D43+CX*20.0*D44)))+Y**32*2.0*D52)                      
      CHISQ=CHI*CHI                                                             
      RHRHO4=CHISQ*SIT*(-PSICD1*PSICD3/PSICD2+PSICD2)                           
      RCC4=CHISQ*(PSICD3-PSICD2*PSICD2/PSICD1)                                  
      RKAP4=1./CHI/PSICD3                                                       
      RBETHA=-RKAP4*PSICD2                                                      
      RGAM4=FAI4/FAV4                                                           
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE VISCON(P,T,SPVOL,VIS,TCON,NREGON,NSTWAT)                       
C                                                                               
C     VISCOSITY AND THERMAL CONDUCTIVITY OF STEAM AND WATER                     
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION K1,K2,K3,K4,K5,K6,K7,K8,K9                               
C                                                                               
      K1=-7.691234564D+00                                                       
      K2=-2.608023696D+01                                                       
      K3=-1.681706546D+02                                                       
      K4=6.423285504D+01                                                        
      K5=-1.189646225D+02                                                       
      K6=4.167117320D+00                                                        
      K7=2.097506760D+01                                                        
      K8=1.0D+09                                                                
      K9=6.0D+00                                                                
      S=1.0-(T+273.15)/647.3                                                    
      BEKB=DEXP(S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))/((T+273.15)/647.3*(1.0+        
     1     K6*S+K7*S*S))-S/(K8*S*S+K9))*221.2                                   
      TT=273.16                                                                 
      TC=647.30                                                                 
      P2=1000.0                                                                 
      TK=T+273.15                                                               
      PB=0.980665*P                                                             
      DENS=0.001/SPVOL                                                          
      IF (((NREGON.EQ.1.AND.PB.EQ.BEKB).OR.(NREGON.EQ.4.AND.PB.EQ.BEKB))        
     1   .AND.(T.GE.0.0.AND.T.LE.300.0)) GO TO 1                                
      IF (((NREGON.EQ.1.AND.NSTWAT.EQ.2).OR.(NREGON.EQ.4.AND.NSTWAT.EQ.2        
     1   )).AND.(T.GE.0.0.AND.T.LE.300.0)) GO TO 1                              
      IF ((T.GE.0.0.AND.T.LE.300.0).AND.(PB.GE.BEKB.AND.PB.LE.800.0).AND        
     1   .(NREGON.EQ.1.OR.NREGON.EQ.4)) GO TO 2                                 
      IF ((T.GE.100.0.AND.T.LE.700.0).AND.(P .EQ.1.0)) GO TO 3                  
      IF (((NREGON.EQ.2.AND.PB.EQ.BEKB).OR.(NREGON.EQ.3.AND.PB.EQ.BEKB))        
     1   .AND.(T.GE.100.0.AND.T.LE.300.0)) GO TO 4                              
      IF (((NREGON.EQ.2.AND.NSTWAT.EQ.1).OR.(NREGON.EQ.3.AND.NSTWAT.EQ.1        
     1   )).AND.(T.GE.100.0.AND.T.LE.300.0)) GO TO 4                            
      IF ((T.GE.100.0.AND.T.LE.300.0).AND.(PB.GE.1.0.AND.PB.LE.BEKB))           
     1   GO TO 4                                                                
      IF ((T.GE.375.0.AND.T.LE.700.0).AND.(PB.GE.1.0.AND.PB.LE.800.0))          
     1   GO TO 5                                                                
      VIS=0.0                                                                   
      GO TO 6                                                                   
    1 VIS=241.4*10.0**(247.8*(1.0/(TK-140.0)))                                  
      GO TO 6                                                                   
    2 VIS=241.4*10.0**(247.8*(1.0/(TK-140.0)))*(1.0+(PB-BEKB)*1.046             
     1    *1.0E-6*(TK-305.0))                                                   
      GO TO 6                                                                   
    3 VIS=0.407*T+80.4                                                          
      GO TO 6                                                                   
    4 VIS=0.407*T+80.4-DENS*(1858.0-5.90*T)                                     
      GO TO 6                                                                   
    5 VIS=0.407*T+80.4+DENS*(353.0+DENS*(676.5+DENS*102.1))                     
    6 IF (((NREGON.EQ.1.AND.PB.EQ.BEKB).OR.(NREGON.EQ.4.AND.PB.EQ.BEKB))        
     1   .AND.(T.GE.0.0.AND.T.LE.350.0)) GO TO 7                                
      IF (((NREGON.EQ.1.AND.NSTWAT.EQ.2).OR.(NREGON.EQ.4.AND.NSTWAT.EQ.2        
     1   )).AND.(T.GE.0.0.AND.T.LE.350.0)) GO TO 7                              
      IF ((NREGON.EQ.1.OR.NREGON.EQ.4).AND.((T.GE.0.0.AND.T.LE.350.0)           
     1   .AND.(PB.GE.BEKB.AND.PB.LE.500.0))) GO TO 7                            
      IF ((T.GE.100.0.AND.T.LE.700.0).AND.(P .EQ.1.0)) GO TO 8                  
      IF (PB.LE.175.) TS=BETKP(PB/221.2)                                        
      IF ((T.GE.TS.AND.T.LE.700.0).AND.(PB.GT.1.0.AND.PB.LE.175.0))             
     1   GO TO 9                                                                
      IF ((T.GE.400.0.AND.T.LE.700.0).AND.(PB.GT.175.0.AND.PB.LE.225.0))        
     1   GO TO 9                                                                
      IF ((T.GE.425.0.AND.T.LE.700.0).AND.(PB.GT.225.0.AND.PB.LE.275.0))        
     1   GO TO 9                                                                
      IF ((T.GE.450.0.AND.T.LE.700.0).AND.(PB.GT.275.0.AND.PB.LE.350.0))        
     1   GO TO 9                                                                
      IF ((T.GE.500.0.AND.T.LE.700.0).AND.(PB.GT.350.0.AND.PB.LE.450.0))        
     1   GO TO 9                                                                
      IF ((T.GE.550.0.AND.T.LE.700.0).AND.(PB.GT.450.0.AND.PB.LE.500.0))        
     1   GO TO 9                                                                
      TCON=0.                                                                   
      GO TO 10                                                                  
    7 TX=TK/273.15                                                              
      TCON=-922.47+TX*(2839.5+TX*(-1800.7+TX*(525.77-TX*73.440)))+(PB-          
     1     BEKB)*(-0.94730+TX*(2.5186+TX*(-2.0012+TX*0.51536)))+(PB-BEKB        
     2     )**2*(1.6563E-3+TX*(-3.8929E-3+TX*(2.9323E-3-TX*7.1693E-4)))         
      GO TO 10                                                                  
    8 TCON=17.6+T*(5.87E-2+T*(1.04E-4-T*4.51E-8))                               
      GO TO 10                                                                  
    9 DENS=0.001/SPVOL                                                          
      TCON=17.6+T*(5.87E-2+T*(1.04E-4-T*4.51E-8))+DENS*(103.51+T*(0.4198        
     1     -T*2.771E-5)+DENS*2.1482E14/T**4.2)                                  
   10 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BETK(SIT)                                       
C                                                                               
C     REDUCED PRESSURE OF SATURATED STEAM AND WATER AS A FUNCTION OF RED        
C                                                                               
C     TEMPERATURE                                                               
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION K1,K2,K3,K4,K5,K6,K7,K8,K9                               
C                                                                               
      K1=-7.691234564D+00                                                       
      K2=-2.608023696D+01                                                       
      K3=-1.681706546D+02                                                       
      K4=6.423285504D+01                                                        
      K5=-1.189646225D+02                                                       
      K6=4.167117320D+00                                                        
      K7=2.097506760D+01                                                        
      K8=1.0D+09                                                                
      K9=6.0D+00                                                                
      S=1.0-SIT                                                                 
      X=S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))/(SIT*(1.0+K6*S+K7*S*S))-S/(K8*S        
     1  *S+K9)                                                                  
      BETK=DEXP(X)                                                              
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BETKP(BET)                                      
C                                                                               
C     REDUCED TEMPERATURE OF SATURATED STEAM AND WATER AS A FUNCTION OF         
C                                                                               
C     PRESSURE                                                                  
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION K1,K2,K3,K4,K5,K6,K7,K8,K9                               
C                                                                               
      K1=-7.691234564D+00                                                       
      K2=-2.608023696D+01                                                       
      K3=-1.681706546D+02                                                       
      K4=6.423285504D+01                                                        
      K5=-1.189646225D+02                                                       
      K6=4.167117320D+00                                                        
      K7=2.097506760D+01                                                        
      K8=1.0D+09                                                                
      K9=6.0D+00                                                                
      N=0                                                                       
      X0=(TSATA(BET*221.2/0.980665)+273.15)/647.3                               
    1 S=1.0-X0                                                                  
      F=DEXP(S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))/(X0*(1.0+K6*S+K7*S*S))            
     1  -S/(K8*S*S+K9))-BET                                                     
      FD=(((-K1-S*(2.0*K2+S*(3.0*K3+S*(4.0*K4+S*5.0*K5))))*X0*(1.0+K6*S         
     1   +K7*S*S)-S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))*(1.0+K6*(1.0-2.0*X0)         
     2   +K7*S*(1.0-3.0*X0)))/(X0*(1.0+K6*S+K7*S*S))**2-(K8*S*S-K9)/            
     3   (K8*S*S+K9)**2)*(F+BET)                                                
      BETKP=X0-F/FD                                                             
      IF (DABS(X0/BETKP-1.0).LE.1.0D-07) GO TO 2                                
      N=N+1                                                                     
      IF (N.GE.50) GO TO 2                                                      
      X0=BETKP                                                                  
      GO TO 1                                                                   
    2 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BET3(SIT,CH0)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C012=-4.311577033D+00                                                     
      C11=7.086360850D-01                                                       
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
    1 CX=1.0/CH0                                                                
      BET3=                                                                     
     O   -(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))                     
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BET4(SIT,CH0)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C11=7.086360850D-01                                                       
      C012=-4.311577033D+00                                                     
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      D30=-1.717616747D+00                                                      
      D31=3.526389875D+00                                                       
      D32=-2.690899373D+00                                                      
      D33=9.070982605D-01                                                       
      D34=-1.138791156D-01                                                      
      D40=1.301023613D+00                                                       
      D41=-2.642777743D+00                                                      
      D42=1.996765362D+00                                                       
      D43=-6.661557013D-01                                                      
      D44=8.270860589D-02                                                       
      D50=3.426663535D-04                                                       
      D51=-1.236521258D-03                                                      
      D52=1.155018309D-03                                                       
      SIT1=9.626911787D-01                                                      
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
      SX2=1.0-SIT1                                                              
      Y=(1.0-SIT)/(1.0-SIT1)                                                    
    1 CX=1.0/CH0                                                                
      F3=-(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))                     
      BET4=  F3+Y**3*CX**2*(D31+CX*(2.0*D32+CX*(3.0*D33+CX*4.0*D34)))           
     1   +Y**4*CX**2*(D41+CX*(2.0*D42+CX*(3.0*D43+CX*4.0*D44)))-Y**32*(         
     2   D51+2.0*D52*CH0)                                                       
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION CHI2(SIT,BET)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DIMENSION B(8,3),BS(8,2)                                                  
C                                                                               
      B90=1.936587558D+02                                                       
      B91=-1.388522425D+03                                                      
      B92=4.126607219D+03                                                       
      B93=-6.508211677D+03                                                      
      B94=5.745984054D+03                                                       
      B95=-2.693088365D+03                                                      
      B96=5.235718623D+02                                                       
      BB=7.633333333D-01                                                        
      B(1,1)=6.670375918D-02                                                    
      B(1,2)=1.388983801D+00                                                    
      B(1,3)=0.                                                                 
      B(2,1)=8.390104328D-02                                                    
      B(2,2)=2.614670893D-02                                                    
      B(2,3)=-3.373439453D-02                                                   
      B(3,1)=4.520918904D-01                                                    
      B(3,2)=1.069036614D-01                                                    
      B(3,3)=0.                                                                 
      B(4,1)=-5.975336707D-01                                                   
      B(4,2)=-8.847535804D-02                                                   
      B(4,3)=0.                                                                 
      B(5,1)=5.958051609D-01                                                    
      B(5,2)=-5.159303373D-01                                                   
      B(5,3)=2.075021122D-01                                                    
      B(6,1)=1.190610271D-01                                                    
      B(6,2)=-9.867174132D-02                                                   
      B(6,3)=0.                                                                 
      B(7,1)=1.683998803D-01                                                    
      B(7,2)=-5.809438001D-02                                                   
      B(7,3)=0.                                                                 
      B(8,1)=6.552390126D-03                                                    
      B(8,2)=5.710218649D-04                                                    
      B(8,3)=0.                                                                 
      BS(1,1)=0.                                                                
      BS(1,2)=0.                                                                
      BS(2,1)=0.                                                                
      BS(2,2)=0.                                                                
      BS(3,1)=0.                                                                
      BS(3,2)=0.                                                                
      BS(4,1)=0.                                                                
      BS(4,2)=0.                                                                
      BS(5,1)=0.                                                                
      BS(5,2)=0.                                                                
      BS(6,1)=4.006073948D-01                                                   
      BS(6,2)=0.                                                                
      BS(7,1)=8.636081627D-02                                                   
      BS(7,2)=0.                                                                
      BS(8,1)=-8.532322921D-01                                                  
      BS(8,2)=3.460208861D-01                                                   
      TC1=647.3                                                                 
      PC1=22120000.0                                                            
      VC1=0.00317                                                               
      R1=461.51                                                                 
      AI1=R1*TC1/(PC1*VC1)                                                      
      X=DEXP(BB*(1.0-SIT))                                                      
      CALL SUBBET(SIT,BETL,BETLD,BETLDD)                                        
      S03=0.0                                                                   
      S04=0.0                                                                   
      DO 4 I=1,8                                                                
      BX=0.0                                                                    
      NNI=NN(I)                                                                 
      NLI=NL(I)                                                                 
      DO 2 J=1,NNI                                                              
      SBX=0.0                                                                   
      NZIJ=NZ(I,J)                                                              
      DO 1 K=1,NLI                                                              
      NXIK=NX(I,K)                                                              
      SBX=SBX+BS(I,K)*X**NXIK                                                   
    1 CONTINUE                                                                  
      BX=BX+B(I,J)*X**NZIJ                                                      
    2 CONTINUE                                                                  
      IF (I.GE.6) GO TO 3                                                       
      S03=S03+FLOAT(I)*BET**(I-1)*BX                                            
      GO TO 4                                                                   
    3 CONTINUE                                                                  
      S04=S04+FLOAT(I-2)*BET**(1-I)*BX/(BET**(2-I)+SBX)**2                      
    4 CONTINUE                                                                  
      CHI2=AI1*SIT/BET-S03-S04+11.0*(BET/BETL)**10*(B90+X*(B91+X*(B92+X*        
     1     (B93+X*(B94+X*(B95+X*B96))))))                                       
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION CHI3(SIT,BET)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION L0,L1,L2                                                 
C                                                                               
      L0=15.74373327                                                            
      L1=-34.17061978                                                           
      L2=19.31380707                                                            
      SIT1=0.9626911787                                                         
      BET1=0.7475191707                                                         
      BET2=4.52079566                                                           
      BTK=BETK(SIT)                                                             
      L0=L0-BET                                                                 
      IF ((BET.GT.BET1.AND.BET.LE.1.0).OR.(SIT.GT.SIT1.AND.SIT.LE.1.0))         
     1  GO TO 1                                                                 
      IF (BET.GT.1.0.AND.SIT.GT.SIT1) GO TO 2                                   
    1 CH0=CHI2(SIT,BET)                                                         
      GO TO 6                                                                   
    2 CH0=0.001368/0.00317                                                      
      SITL=(-L1+DSQRT(L1**2-4.0*L0*L2))/(2.0*L2)                                
    3 CH2=CHI2(SITL,BET)                                                        
      IF (CH2.GT.0.) GO TO 4                                                    
      SITL=SITL+0.1                                                             
      GO TO 3                                                                   
    4 BET0=BET3(SIT,CH0)-BET                                                    
    5 CH1=CH0+0.0001/0.00317                                                    
      BET1=BET3(SIT,CH1)-BET                                                    
      IF (BET0*BET1.LE.0.) GO TO 6                                              
      IF (CH1.GE.CH2) GO TO 6                                                   
C                                                                               
      CH0=CH1                                                                   
      BET0=BET1                                                                 
      GO TO 5                                                                   
    6 CHI3=CH0                                                                  
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION CHI4(SIT,BET)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      SIT1=0.96269117                                                           
      CH0=0.001318/0.00317                                                      
      CH2=0.002448/0.00317                                                      
      BET0=BET4(SIT,CH0)-BET                                                    
    1 CH1=CH0+0.0001/0.00317                                                    
      BET1=BET4(SIT,CH1)-BET                                                    
      IF (BET0*BET1.LT.0.) GO TO 2                                              
      IF (CH1.GT.CH2) GO TO 2                                                   
C                                                                               
      CH0=CH1                                                                   
      BET0=BET1                                                                 
      GO TO 1                                                                   
    2 CHI4=CH0                                                                  
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NL(I)                                                            
C                                                                               
      NL=0                                                                      
      IF (I.EQ.6.OR.I.EQ.7) NL=1                                                
      IF (I.EQ.8) NL=2                                                          
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NN(I)                                                            
C                                                                               
      NN=2                                                                      
      IF (I.EQ.2.OR.I.EQ.5) NN=3                                                
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NX(I,K)                                                          
C                                                                               
      NX=0                                                                      
      IF (K-1) 1,1,2                                                            
    1 IF (I.EQ.6) NX=14                                                         
      IF (I.EQ.7) NX=19                                                         
      IF (I.EQ.8) NX=54                                                         
      GO TO 3                                                                   
    2 IF (I.EQ.8) NX=27                                                         
    3 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NZ(I,J)                                                          
C                                                                               
      NZ=0                                                                      
      IF (J-2) 1,2,3                                                            
    1 IF (I.EQ.1) NZ=13                                                         
      IF (I.EQ.2.OR.I.EQ.3) NZ=18                                               
      IF (I.EQ.4) NZ=25                                                         
      IF (I.EQ.5) NZ=32                                                         
      IF (I.EQ.6) NZ=12                                                         
      IF (I.EQ.7.OR.I.EQ.8) NZ=24                                               
      GO TO 4                                                                   
    2 IF (I.EQ.1) NZ=3                                                          
      IF (I.EQ.2) NZ=2                                                          
      IF (I.EQ.3) NZ=10                                                         
      IF (I.EQ.4.OR.I.EQ.8) NZ=14                                               
      IF (I.EQ.5) NZ=28                                                         
      IF (I.EQ.6) NZ=11                                                         
      IF (I.EQ.7) NZ=18                                                         
      GO TO 4                                                                   
    3 IF (I.EQ.2) NZ=1                                                          
      IF (I.EQ.5) NZ=24                                                         
    4 RETURN                                                                    
      END                                                                       
MAIN.f/         929015370   0     0     100666  1145      `
C
      PROGRAM MAIN
C
      IMPLICIT REAL*8(A-H,O-Z)
C
C .. INPUT VARIABLES
C
C    P      PRESSURE                             IN PA  
C    TL     TEMPERATURE OF THE LIQUID            IN K
C
C .. OUTPUT VARIABLES
C
C    ROL    DENSITY OF THE LIQUID                IN KG/(M**3)
C    CPL    SPECIFIC HEAT OF THE LIQUID          IN J/(KG K)
C    VISL   DYNAMIC VISCOSITY OF THE LIQUID      IN N S/(M**2)
C    CL     THERMAL CONDUCUTIVITY OF THE LIQUID  IN W/(M K)
C

      INCLUDE 'IOUNITS'
C
      OPEN(UNIT=IMOUT,FILE='../output/steam.dat')
C
      P  = 1.550D7
      TL = 559.150
C
      CALL PF1STEAM( P, TL, ROL, CPL, VISL, CL )
C
      WRITE(6,1000)     P,TL,ROL,CPL,VISL,CL
      WRITE(IMOUT,1000) P,TL,ROL,CPL,VISL,CL
C
      CLOSE( UNIT=IMOUT)
C
 1000 FORMAT(1H ,1X,'P   = ',1P,E12.5,2X,'PA      ',/,
     1           2X,'TL  = ',1P,E12.5,2X,'K       ',/,
     2           2X,'ROL = ',1P,E12.5,2X,'KG/M3   ',/,
     3           2X,'CPL = ',1P,E12.5,2X,'J/(KG K)',/,
     4           2X,'VISL= ',1P,E12.5,2X,'N S/M2  ',/,
     5           2X,'CL  = ',1P,E12.5,2X,'W/(M K) ')
C
      STOP
      END

PF1STEAM.f/     929015372   0     0     100666  1899      `
C
      SUBROUTINE PF1STEAM( P, TL, ROL, CPL, VISL, CL )
C
      PARAMETER ( IDRMAX=100 )
C
      IMPLICIT REAL*8(A-H,O-Z)
C
      INCLUDE 'IOUNITS'
C
      DIMENSION DR(IDRMAX), DRS(IDRMAX)
C
      DO 10 I = 1, IDRMAX
        DR (I) = 0.0D0
        DRS(I) = 0.0D0
   10 CONTINUE
C
      ISAT = 0
      TV   = TL
C
      ILAST = 0
C
      PMIN   = 1.0D4
      PMAX   = 2.212D7
      TLMIN  = 273.15D0
      TLMAX  = 647.8D0
      TVMIN  = 273.15D0
      TVMAX  = 1000.0D0
C
      JSTART = 1
      NCELLS = 1
      IOP    = 0
      NC     = 1
C
      PA     = 0.0D0
C
      IMAX   = 1

      DO 100 I = 1, IMAX
C
        EL  = 0.0D0
        EV  = 0.0D0
C
        CALL SETEOS
C
        CALL THERMO( P      , EL     , EV     , TL     , TV     ,
     1               TSAT   , ROL    , ROV    , PA     , ROA    ,
     2               TSSN   , EA     , DR     , IOP    , JSTART ,
     3               NCELLS  )
C
        IF( ISAT.EQ.0 ) GO TO 50
C
        TL   = TSAT
        TV   = TSAT
C
        ELS  = 0.0D0
        EVS  = 0.0D0
C
        CALL THERMO( P      , ELS    , EVS    , TL     , TV     ,
     1               TSAT   , ROLS   , ROVS   , PA     , ROAS   ,
     2               TSSN   , EAS    , DRS    , IOP    , JSTART ,
     3               NCELLS  )
C
        EL  = ELS
        EV  = EVS
        EA  = EAS
C
        ROL = ROLS
        ROV = ROVS
        ROA = ROAS
C
        DO 30 KK = 1, IDRMAX
          DR(KK) = DRS(KK)
   30   CONTINUE
C
   50   CONTINUE
C
        CALL FPROP  (P      , EL     , EV     , ROL    , ROV    ,
     1               TL     , TV     , TSAT   , HFG    , CPL    ,
     2               CPV    , VISL   , VISV   , CL     , CV     ,
     2               SIG    , NC     , PA     , ROA    , TSSN   ,
     3               EA     , DR     )
C
  100 CONTINUE
C
      RETURN
      END

RHOLIQ.f/       929015372   0     0     100666  6808      `
C*DK RHOLIQ                                                             
      SUBROUTINE RHOLIQ( P, TL, RHOL, DRLDP, DRLDT )                    
      IMPLICIT REAL*8(A-H,O-Z)                                          
C                                                                       
C     SUBROUTINE RHOLIQ CALCULATES THE LIQUID DENSITY AND ITS           
C     DERIVATIVES                                                       
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
      DIMENSION AV0(12) ,BV0(12) ,CV0(12) ,DV0(12) ,AFN(12) ,BFN(12) ,  
     1          CFN(12) ,DFN(12)                                        
      DATA AV0(1)/ 1.7057666777468D-03/,BV0(1)/-6.0320895569365D-06/,   
     *     CV0(1)/ 1.5944423965594D-08/,DV0(1)/-1.2149418561177D-11/    
      DATA AV0(2)/ 5.2145931517155D-04/,BV0(2)/ 3.5189228252915D-06/,   
     *     CV0(2)/-9.7304881862624D-09/,DV0(2)/ 1.0856688130631D-11/    
      DATA AV0(3)/-1.4931865836934D-02/,BV0(3)/ 9.7931556400429D-05/,   
     *     CV0(3)/-2.0172817692512D-07/,DV0(3)/ 1.4080475270259D-10/    
      DATA AV0(4)/-4.9334201381918D-01/,BV0(4)/ 2.5928571576499D-03/,   
     *     CV0(4)/-4.5387107397840D-06/,DV0(4)/ 2.6537936475365D-09/    
      DATA AV0(5)/-3.4558955902321D+00/,BV0(5)/ 1.7351793841884D-02/,   
     *     CV0(5)/-2.9047483637289D-05/,DV0(5)/ 1.6220227777320D-08/    
      DATA AV0(6)/-1.1952528427292D+01/,BV0(6)/ 5.8904962031842D-02/,   
     *     CV0(6)/-9.6786687447220D-05/,DV0(6)/ 5.3029284583415D-08/    
      DATA AV0(7)/-3.7446629978341D+01/,BV0(7)/ 1.8173474403006D-01/,   
     *     CV0(7)/-2.9404991620713D-04/,DV0(7)/ 1.5863005350824D-07/    
      DATA AV0(8)/-3.9713284923576D+02/,BV0(8)/ 1.8801824705202D+00/,   
     *     CV0(8)/-2.9673900150051D-03/,DV0(8)/ 1.5612171739106D-06/    
      DATA AV0(9)/-2.3142714272157D+03/,BV0(9)/ 1.0710216457395D+01/,   
     *     CV0(9)/-1.6521763202064D-02/,DV0(9)/ 8.4955209566212D-06/    
      DATA AV0(10)/ 2.0481569977849D+03/,BV0(10)/-9.3452783115489D+00/, 
     *     CV0(10)/ 1.4212077056589D-02/,DV0(10)/-7.2037202704367D-06/  
      DATA AV0(11)/-7.3864713248117D+01/,BV0(11)/ 3.3144939132191D-01/, 
     *     CV0(11)/-4.9608715522591D-04/,DV0(11)/ 2.4771793009809D-07/  
      DATA AV0(12)/-2.1891320674084D+01/,BV0(12)/ 9.6758467414310D-02/, 
     *     CV0(12)/-1.4289074953436D-04/,DV0(12)/ 7.0567217785700D-08/  
      DATA AFN(1)/-4.2486354144244D+09/,BFN(1)/ 3.7516769853867D+07/,   
     *     CFN(1)/-1.0064945851796D+05/,DFN(1)/ 8.7507285129715D+01/    
      DATA AFN(2)/-2.7936308563236D+08/,BFN(2)/ 5.5663179995300D+06/,   
     *     CFN(2)/-1.4921749894688D+04/,DFN(2)/ 1.0834095198280D+01/    
      DATA AFN(3)/-1.1761210016041D+08/,BFN(3)/ 4.3832221802974D+06/,   
     *     CFN(3)/-1.2088373365747D+04/,DFN(3)/ 8.6034520917150D+00/    
      DATA AFN(4)/-4.5415129389018D+09/,BFN(4)/ 2.7368608704680D+07/,   
     *     CFN(4)/-5.1894794477625D+04/,DFN(4)/ 3.1581281016141D+01/    
      DATA AFN(5)/-4.0104325667716D+10/,BFN(5)/ 2.0292575433752D+08/,   
     *     CFN(5)/-3.4075971373732D+05/,DFN(5)/ 1.9000660267975D+02/    
      DATA AFN(6)/-6.0173879922257D+10/,BFN(6)/ 2.9984925450490D+08/,   
     *     CFN(6)/-4.9675963282729D+05/,DFN(6)/ 2.7368658401451D+02/    
      DATA AFN(7)/ 2.0678826351719D+10/,BFN(7)/-8.9503807129603D+07/,   
     *     CFN(7)/ 1.2822787819385D+05/,DFN(7)/-6.0722291833340D+01/    
      DATA AFN(8)/ 8.3793557728900D+10/,BFN(8)/-3.8997180562867D+08/,   
     *     CFN(8)/ 6.0502628698976D+05/,DFN(8)/-3.1291965911464D+02/    
      DATA AFN(9)/ 9.2402374347985D+10/,BFN(9)/-4.2674923965292D+08/,   
     *     CFN(9)/ 6.5695613829284D+05/,DFN(9)/-3.3711122197289D+02/    
      DATA AFN(10)/-2.7547713637194D+10/,BFN(10)/ 1.2580004134443D+08/, 
     *     CFN(10)/-1.9147491048695D+05/,DFN(10)/ 9.7136148925404D+01/  
      DATA AFN(11)/ 6.8608195287374D+08/,BFN(11)/-3.0636028439513D+06/, 
     *     CFN(11)/ 4.5613625244005D+03/,DFN(11)/-2.2642074876391D+00/  
      DATA AFN(12)/ 4.3458430609231D+07/,BFN(12)/-1.8379937116289D+05/, 
     *     CFN(12)/ 2.5971646178490D+02/,DFN(12)/-1.2244044950391D-01/  
      DATA AN/7.146D0/                                                  
C                                                                       
C     DENSITY AND ITS DERIVATIVES                                       
C                                                                       
      II     = IDINT(DMIN1((TL-273.15D0)/100.0D0+1.0D0,5.0D0))+         
     1         IDINT(DMIN1(DMAX1((TL-593.15D0)/10.0D0,0.0D0),7.0D0))    
      VOLL0  = AV0(II)+TL*(BV0(II)+TL*(CV0(II)+TL*DV0(II)))             
      DVOLL0 = BV0(II)+TL*(2.0D0*CV0(II)+TL*3.0D0*DV0(II))              
      FUNCT  = AFN(II)+TL*(BFN(II)+TL*(CFN(II)+TL*DFN(II)))             
      DFUNCT = BFN(II)+TL*(2.0D0*CFN(II)+TL*3.0D0*DFN(II))              
      T1     = 1.0D0+P/FUNCT                                            
      RHOL   = 1.0D0/(VOLL0*(1.0D0-DLOG(T1)/AN))                        
      DRLDP  = RHOL**2*VOLL0/((P+FUNCT)*AN)                             
      DRLDT  = -RHOL*DVOLL0/VOLL0+(1.0D0-T1)*DRLDP*DFUNCT               
C                                                                       
C     ARTIFICIAL COMPRESSIBILITY AT LOW PRESSURES                       
C                                                                       
      IF( P.GE.4.0D+5 ) GO TO 700                                       
      ALF   = -6.25D-09*P+0.005D0                                       
      DRLDT = (1.0D0-ALF)*DRLDT                                         
      DRLDP = (1.0D0-ALF)*DRLDP+RHOL*6.25D-09                           
      RHOL  = (1.0D0-ALF)*RHOL                                          
      RETURN                                                            
  700 CONTINUE                                                          
      ALF   = 1000.0D0/P                                                
      DRLDT = (1.0D0-ALF)*DRLDT                                         
      DRLDP = (1.0D0-ALF)*DRLDP+1000.0D0*RHOL/P**2                      
      RHOL  = (1.0D0-ALF)*RHOL                                          
      RETURN                                                            
      END                                                               
crc@PROCESS XOPT(NOAMOVE)                                               
SATDER.f/       929015374   0     0     100666  2220      `
C*DK SATDER                                                             
      FUNCTION SATDER( PRES, TEMP )                                     
      IMPLICIT REAL*8(A-H,O-Z)                                          
C     THIS FUNCTION CALCULATES THE DERIVATIVE OF SATURATION TEMPERATURE 
C     OF VAPOR WITH RESPECT TO PRESSURE                                 
C                                                                       
C     EQUATION OF STATE CONSTANTS ARRAY                                 
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
      IF( TEMP.GE.CEOSLP(21) ) GO TO 10                                 
      P      = DMAX1(PRES,CEOSLP(36))                                   
      T      = DMAX1(TEMP,CEOSLP(32))                                   
      SATDER = CEOSLP(12)*T*T/(P*HEV(T))                                
      RETURN                                                            
   10 CONTINUE                                                          
      IF( TEMP.GE.CEOSLP(40) ) GO TO 20                                 
      SATDER = CEOS2*(TEMP-CEOS3)/PRES                                  
      RETURN                                                            
   20 CONTINUE                                                          
      IF( TEMP.GE.CEOSLP(38) ) GO TO 30                                 
      SATDER = -TEMP**2/(PRES*(-8529.6481905883D0+2333338.6556656D0/    
     1         TEMP))                                                   
      RETURN                                                            
   30 CONTINUE                                                          
      SATDER = 2.0304886238506D-04*TEMP**2/PRES                         
      RETURN                                                            
      END                                                               
SATPRS.f/       929015374   0     0     100666  2590      `
C*DK SATPRS                                                             
      FUNCTION SATPRS( TEMP )                                           
      IMPLICIT REAL*8(A-H,O-Z)                                          
C     THIS FUNCTION CALCULATES SATURATION PRESSURE OF VAPOR             
C     CORRESPONDING TO A GIVEN TEMPERATURE                              
C                                                                       
C     EQUATION OF STATE CONSTANTS ARRAY                                 
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
C*CA FUNCTION                                                           
C*CC FUNCTION                                                           
      INCLUDE 'FUNCTION'                                                
C                                                                       
      IF( TEMP.GE.CEOSLP(21) ) GO TO 10                                 
      T      = DMAX1(TEMP,CEOSLP(32))                                   
      SATPRS = 24821.0D0*STAR(T/338.0D0,-5.3512D0)*EXP(20.387D0*(T-     
     1         338.0D0)/T)                                              
      SATPRS = DMAX1(SATPRS,CEOSLP(36))                                 
      RETURN                                                            
   10 CONTINUE                                                          
      IF( TEMP.GE.CEOSLP(40) ) GO TO 20                                 
      SATPRS = (1.0D0/AEOS14)*STAR((TEMP-CEOS3)/CEOS1,1.0D0/CEOS2)      
      RETURN                                                            
   20 CONTINUE                                                          
      IF( TEMP.GE.CEOSLP(38) ) GO TO 30                                 
      SATPRS = 7.2166948490268D+11*EXP((-8529.6481905883D0+             
     1         1166669.3278328D0/TEMP)/TEMP)                            
      RETURN                                                            
   30 CONTINUE                                                          
      SATPRS = CEOSLP(37)*EXP(7.6084086799277D0-4924.9229385171D0/TEMP) 
      RETURN                                                            
      END                                                               
SATTMP.f/       929015374   0     0     100666  2812      `
C*DK SATTMP                                                             
      FUNCTION SATTMP( PRES )                                           
      IMPLICIT REAL*8(A-H,O-Z)                                          
C     THIS FUNCTION CALCULATES SATURATION TEMPERATURE OF VAPOR          
C     CORRESPONDING TO A GIVEN PRESSURE                                 
C                                                                       
C     EQUATION OF STATE CONSTANTS ARRAY                                 
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
C*CA FUNCTION                                                           
C*CC FUNCTION                                                           
      INCLUDE 'FUNCTION'                                                
C                                                                       
      IF( PRES.GE.CEOSLP(20) ) GO TO 10                                 
      P      = DMAX1(PRES,CEOSLP(36))                                   
      SATTMP = CEOSLP(1)/(CEOSLP(2)*DLOG(P/CEOSLP(11))+CEOSLP(3))       
      HFGREF = HEV(SATTMP)                                              
      PSREF  = SATPRS(SATTMP)                                           
      SATTMP = SATTMP/(1.0D0-CEOSLP(12)*SATTMP*DLOG(P/PSREF)/HFGREF)    
      SATTMP = DMAX1(SATTMP,CEOSLP(32))                                 
      RETURN                                                            
   10 CONTINUE                                                          
      IF( PRES.GE.CEOSLP(39) ) GO TO 20                                 
      SATTMP = CEOS1*STAR(AEOS14*PRES,CEOS2)+CEOS3                      
      RETURN                                                            
   20 CONTINUE                                                          
      IF( PRES.GE.CEOSLP(37) ) GO TO 30                                 
      PLOG   = DLOG(PRES)                                               
      SATTMP = (4264.8240952941D0+SQRT(-13666986.708428D0+              
     1         1166669.3278328D0*PLOG))/(27.304833093884D0-PLOG)        
      RETURN                                                            
   30 CONTINUE                                                          
      SATTMP = 4924.9229385171D0/(24.520401414546D0-DLOG(PRES))         
      RETURN                                                            
      END                                                               
SETEOS.f/       929015376   0     0     100666  9768      `
C*DK SETEOS                                                             
      SUBROUTINE SETEOS                                                 
      IMPLICIT REAL*8(A-H,O-Z)                                          
C     THIS SOUBOUTINE SETS THE EQUATION OF STATE CONSTANTS              
C                                                                       
C-----------------------------COMMON BLOCKS-----------------------------
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
C------------------------------NOMENCLATURE-----------------------------
C                                                                       
C     AIRMOL  = MOLECULAR WEIGHT OF AIR                                 
C     CEOSLP( 1) = 1ST COEFF OF SAT VAP TEMP FUNCTION                   
C     CEOSLP( 2) = 2ND COEFF OF SAT VAP TEMP FUNCTION                   
C     CEOSLP( 3) = 3RD COEFF OF SAT VAP TEMP FUNCTION                   
C     CEOSLP( 4) = VAPOR SPECIFIC HEAT AT CONSTANT VOLUME               
C     CEOSLP( 5) = REFERENCE TEMPERATURE                                
C     CEOSLP( 6) = VAPOR SPECIFIC INTERNAL ENERGY AT REF. TEMP.         
C     CEOSLP( 7) = LIQUID SPECIFIC HEAT AT CONSTANT VOLUME              
C     CEOSLP( 8) = LIQUID SPECIFIC INTERNAL ENERGY AT REF. TEMP.        
C     CEOSLP( 9) = MICROSCOPIC DENSITY OF LIQUID                        
C     CEOSLP(10) = HEAT OF EVAPORATION AT REFERENCE TEMPERATURE         
C     CEOSLP(11) = REFERENCE PRESSURE                                   
C     CEOSLP(12) = GAS CONSTANT FOR VAPOR                               
C     CEOSLP(13) = AIR THERMAL CONDUCTIVITY                             
C     CEOSLP(14) = LIQUID THERMAL CONDUCTIVITY                          
C     CEOSLP(15) = SQUARE OF RECIPROCAL SOUND SPEED FOR LIQUID          
C     CEOSLP(16) = VAPOR GAMMA, RATIO OF SPECIFIC HEATS                 
C     CEOSLP(17) = AIR SPECIFIC HEAT AT CONSTANT VOLUME                 
C     CEOSLP(18) = AIR GAMMA, RATIO OF SPECIFIC HEATS                   
C     CEOSLP(19) = RATIO OF GAS COMPONENT 2 TO COMPONENT 1              
C     CEOSLP(20) = UPPER LIMIT ON PRESSURE FOR LOW-PRESSURE PROPERTIES  
C     CEOSLP(21) = UPPER LIMIT ON TEMP. FOR LOW-PRESSURE PROPERTIES     
C     CEOSLP(22) = AIR SPECIFIC HEAT AT CONSTANT PRESSURE               
C     CEOSLP(23) = VAPOR SPECIFIC HEAT AT CONSTANT PRESSURE             
C     CEOSLP(24) = LIQUID SPECIFIC HEAT AT CONSTANT PRESSURE            
C     CEOSLP(25) = GAS CONSTANT FOR AIR                                 
C     CEOSLP(26) = LIQUID SPECIFIC ENTHALPY AT REFERENCE TEMPERATURE    
C     CEOSLP(27) = VAPOR SPECIFIC ENTHALPY AT REFERENCE TEMPERATURE     
C     CEOSLP(28) = (VAP. GAS CONST. - AIR GAS CONST.) / VAP. GAS CONST. 
C     CEOSLP(29) = DATUM TEMPERATURE FOR THE ENTHALPY OF LIQUID         
C     CEOSLP(30) = MINIMUM ALLOWABLE PRESSURE                           
C     CEOSLP(31) = MAXIMUM ALLOWABLE PRESSURE                           
C     CEOSLP(32) = MINIMUM ALLOWABLE LIQUID TEMPERATURE                 
C     CEOSLP(33) = MAXIMUM ALLOWABLE LIQUID TEMPERATURE                 
C     CEOSLP(34) = MINIMUM ALLOWABLE VAPOR TEMPERATURE                  
C     CEOSLP(35) = MAXIMUM ALLOWABLE VAPOR TEMPERATURE                  
C     CEOSLP(36) = MINIMUM SATURATION PRESSURE                          
C                  (CORRESPONDING TO MINIMUM LIQUID TEMPERATURE)        
C     CEOSLP(37) = CRITICAL PRESSURE                                    
C     CEOSLP(38) = CRITICAL TEMPERATURE                                 
C     CEOSLP(39) = LOWER LIMIT ON SATURATION PRESSURE FOR THE           
C                  HIGH-PRESSURE EXPRESSION                             
C     CEOSLP(40) = LOWER LIMIT ON SATURATION TEMPERATURE FOR THE        
C                  HIGH-PRESSURE EXPRESSION                             
C     GASCON     = UNIVERSAL GAS CONSTANT                               
C     IGAS       = 1 FOR AIR, 2 FOR HYDROGEN                            
C     VAPMOL     = MOLECULAR WEIGHT OF VAPOR                            
C                                                                       
C----------------------------EXECUTION LOGIC----------------------------
C                                                                       
      IGSET     = 0                                                     
      AEOS14    = 1.0D-05                                               
      CEOS1     = 117.8D0                                               
      CEOS2     = 0.223D0                                               
      CEOS3     = 255.2D0                                               
      CEOSLP(1) = -2263.0D0                                             
      CEOSLP(2) = 0.434D0                                               
      CEOSLP(3) = -6.064D0                                              
      GO TO 10                                                          
C                                                                       
C     ENTRY POINT SETIG FOR RESETTING THE INERT GAS OPTION              
C                                                                       
      ENTRY SETIG                                                       
      IGSET = 1                                                         
   10 CONTINUE                                                          
      GASCON     = 6.022169D+26*1.380622D-23                            
      AIRMOL     = 28.967D0                                             
      CEOSLP(22) = 1004.832D0                                           
      CEOSLP(13) = 0.0228D0                                             
      IF( IGAS.EQ.1 ) GO TO 100                                         
      AIRMOL     = 2.016D0                                              
      CEOSLP(22) = 14533.2D0                                            
      CEOSLP(13) = 0.3094D0                                             
  100 CONTINUE                                                          
      CEOSLP(25) = GASCON/AIRMOL                                        
      CEOSLP(17) = CEOSLP(22)-CEOSLP(25)                                
      CEOSLP(18) = CEOSLP(22)/CEOSLP(17)                                
CC    CEOSLP(28)=(CEOSLP(12)-CEOSLP(25))/CEOSLP(12)                     
      IF( IGSET.EQ.0 ) GO TO 200                                        
      RETURN                                                            
C                                                                       
C     CONTINUE THE REMAINING INITIALIZATION IF ENTRY POINT  IS NOT SETIG
C                                                                       
  200 CONTINUE                                                          
      CEOSLP(5)  = 273.15D0                                             
      CEOSLP(29) = 273.16D0                                             
      CEOSLP(30) = 1.0D0                                                
      CEOSLP(31) = 450.0D+5                                             
      CEOSLP(32) = CEOSLP(5)                                            
      CEOSLP(33) = 713.94025779311D0                                    
      CEOSLP(34) = CEOSLP(5)                                            
      CEOSLP(35) = 3000.0D0                                             
      CEOSLP(36) = 610.8D0                                              
      CEOSLP(37) = 221.2D+5                                             
      CEOSLP(38) = 647.3D0                                              
      CEOSLP(39) = 139.69971285053D+5                                   
      CEOSLP(40) = 609.62462615967D0                                    
      VAPMOL     = 18.016D0                                             
      CEOSLP(12) = GASCON/VAPMOL                                        
      CEOSLP(16) = 1.3D0                                                
      CEOSLP(4)  = CEOSLP(12)/(CEOSLP(16)-1.0D0)                        
      CEOSLP(23) = CEOSLP(16)*CEOSLP(4)                                 
CC    CEOSLP(28)=(CEOSLP(12)-CEOSLP(25))/CEOSLP(12)                     
      CEOSLP(24) = 4186.800D0                                           
      CEOSLP(14) = 0.65141D0                                            
      CEOSLP(7)  = CEOSLP(24)                                           
      CEOSLP(9)  = 990.0D0                                              
      CEOSLP(15) = 0.0D0                                                
CC    CEOSLP(19)=NOT USED ANY MORE                                      
      CEOSLP(20) = 9.056466D+4                                          
      CEOSLP(21) = 370.4251D0                                           
      CEOSLP(11) = 100000.0D0                                           
      CEOSLP(10) = HEV(CEOSLP(5))                                       
      CEOSLP(8)  = -611.2D0*0.0010002D0+CEOSLP(7)*(CEOSLP(5)-CEOSLP(29))
      CEOSLP(26) = CEOSLP(24)*(CEOSLP(5)-CEOSLP(29))                    
      CEOSLP(27) = CEOSLP(26)+CEOSLP(10)                                
      CEOSLP(6)  = CEOSLP(27)-CEOSLP(12)*CEOSLP(5)                      
      RETURN                                                            
      END                                                               
SIGMA.f/        929015376   0     0     100666  1480      `
C*DK SIGMA                                                              
      FUNCTION SIGMA( P, TSAT )                                         
      IMPLICIT REAL*8(A-H,O-Z)                                          
C                                                                       
C     SURFACE TENSION OF WATER.                                         
C     E. SCHMIDT.  PROPERTIES OF WATER AND STEAM IN SI UNITS -- 1979.   
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C                                                                       
C*CA FUNCTION                                                           
C*CC FUNCTION                                                           
      INCLUDE 'FUNCTION'                                                
C                                                                       
      TT    = DMAX1((647.15D0-TSAT)/647.15D0,0.1D0)                     
      SIGMA = 0.2358D0*STAR(TT,1.256D0)*(1.0D0-0.625D0*TT)              
      RETURN                                                            
      END                                                               
crc@PROCESS XOPT(NOAMOVE) OPT(2)                                        
STEAM_SUB.f/    929027226   0     0     100666  148128    `
      subroutine JAERI_STEAM( NIN, TZ, PZ, RO_OUT , CP_OUT,
     &           Viscos_OUT, Conduct_Out)
	                                                                          
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      CHARACTER*30    COM(21)                                                   
      CHARACTER*10   UNIT(21)                                                   
      DIMENSION IQUICK(9), fdata(21), ZTAB(19)                                          
                                                                                
      DATA IQUICK(1) / 1 /                                                      
      DATA IQUICK(2) / 2 /                                                      
      DATA IQUICK(3) / 3 /                                                      
      DATA IQUICK(4) / 4 /                                                      
      DATA IQUICK(5) / 16/                                                      
      DATA IQUICK(6) / 17/                                                      
      DATA IQUICK(7) / 18/                                                      
      DATA IQUICK(8) / 20/                                                      
      DATA IQUICK(9) / 21/                                                      
                                                                                
      DATA COM( 1) /'Pressure                      '/                           
      DATA COM( 2) /'Temperature                   '/                           
      DATA COM( 3) /'Density                       '/                           
      DATA COM( 4) /'Enthalpy                      '/                           
      DATA COM( 5) /'Entolopy                      '/                           
      DATA COM( 6) /'Internal Energy               '/                           
      DATA COM( 7) /'Isobaric Specific Heat  CP    '/                           
      DATA COM( 8) /'         Specific Heat  CV    '/                           
      DATA COM( 9) /'Squared Sound Velocity C**2   '/                           
      DATA COM(10) /'[D(Enthalpy)/D(Density)| P    '/                           
      DATA COM(11) /'1/V[D(Volume)/D(Temp)| P      '/                           
      DATA COM(12) /'CP / CV                       '/                           
      DATA COM(13) /'-1/V [D(Volume)/D(Press.)| T  '/                           
      DATA COM(14) /'Specific GIBBS Function       '/                           
      DATA COM(15) /'Specific HELMHOLTZ Function   '/                           
      DATA COM(16) /'Dynamic Viscocity             '/                           
      DATA COM(17) /'Kinematic Viscocity           '/                           
      DATA COM(18) /'Thermal Conductivity          '/                           
      DATA COM(19) /'Thermal Diffusivity           '/                           
      DATA COM(20) /'Prendtle Number               '/                           
      DATA COM(21) /'Surface Tension               '/                           
                                                                                
      DATA UNIT( 1) /' MPa      '/                                              
      DATA UNIT( 2) /' K        '/                                              
      DATA UNIT( 3) /' kG/m3    '/                                              
      DATA UNIT( 4) /' J/kG     '/                                              
      DATA UNIT( 5) /' J/kG/K   '/                                              
      DATA UNIT( 6) /' J/kG     '/                                              
      DATA UNIT( 7) /' J/kG/K   '/                                              
      DATA UNIT( 8) /' J/kG/K   '/                                              
      DATA UNIT( 9) /' k2/s2    '/                                              
      DATA UNIT(10) /' J m3/kg2 '/                                              
      DATA UNIT(11) /' 1/K      '/                                              
      DATA UNIT(12) /' -        '/                                              
      DATA UNIT(13) /' m2/N     '/                                              
      DATA UNIT(14) /' J/kG     '/                                              
      DATA UNIT(15) /' J/kG     '/                                              
      DATA UNIT(16) /' kG/m2/s  '/                                              
      DATA UNIT(17) /' m2/s     '/                                              
      DATA UNIT(18) /' W/m/K    '/                                              
      DATA UNIT(19) /' m2/s     '/                                              
      DATA UNIT(20) /' -        '/                                              
      DATA UNIT(21) /' N/m      '/                                              
                                                                                
c  100 write(6,'(1h1)')                
c      write(6,*) ' Mode Select   K = C + 273.15,  Pa = 1.0197D-5 kgf/m2'                 
c      write(6,*) '   0 : P(MPa) & T(K) : subcooled liquid or superheated 
c     &                steam '                 
c      write(6,*) '   1 : T(K)          : saturated steam'          
c      write(6,*) '   2 : P(MPa)        :           steam'          
c      write(6,*) '   3 : T(K)          : saturated liquid'         
c      write(6,*) '   4 : P(MPa)        :           liquid'         
c      WRITE(6,*) '  '                                                      
c      READ(5,*) NIN                                                             
                                                                                
      PZ = PZ*1.0D6                                                             
      CALL STEAMS(PZ,TZ,NIN,NOUT,ZTAB)                                          


C                                       WRITE(6,*) ' CHECK AFTER CALL PZ,TZ,NIN',PZ,TZ,NIN                       
      P = PZ / 1.0D6                                                            
      T = TZ             
	                                                       
      ZTAB(1) = 1.0 / ZTAB(1)                                                   

                                                                            
      DO 150 I = 1,21                                                           
      IF(I.EQ.1) FDATA(1) = P                                                   
      IF(I.EQ.2) FDATA(2) = T                                                   
      IF(I.GE.3) THEN                                                           
         J = I - 2                                                              
         FDATA(I) = ZTAB(J)                                                     
      ENDIF                                                                     
  150 CONTINUE                                                                  

                                                                                
c      WRITE(6,*) ' Detailed Data ?  YES => 1,  Simple-Set > others'          
c      READ(5,*) I                                                               
c      IF(I.eq.1) GO TO 400                                                      
                                                                                
c      DO 200 I = 1,9                                                            
c      II = IQUICK(I)                                                            
c 200  WRITE(6,10) COM(II),FDATA(II),UNIT(II)
c      go to 450
 
c 400  continue                                                                                
c      DO 300 I = 1,21                                                           
c  300 WRITE(6,10) COM(I),FDATA(I),UNIT(I)                                       
                                                                                
c  450 WRITE(6,*) '  '            
c      WRITE(6,*) ' Continue ?   YES => 1 ,  NO => others'            
c      READ(5,*) I                                                               
c      IF(I.EQ.1) GO TO 100                                                      
                                                                                
   10 FORMAT(1h ,A30,1PE12.5,A10)                
   
      RO_OUT = FDATA(3)                               
	CP_OUT = FDATA(7)
	Viscos_Out = FDATA(16)
	Conduct_Out = FDATA(18)

      return
      END                                                                       
C
C=================================================================================================
C
      SUBROUTINE STEAMS(P,T,NIN,NOUT,ZTAB)                                      
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DIMENSION ZTAB(19),ZKTAB(18),NTAB(4)                                      
C                                                                               
      PK = P * 1.0197D-5                                                        
      TK = T - 273.15                                                           
      NTAB(2) = 0                                                               
      NTAB(4) = 1                                                               
C                                                                               
      IF(NIN.EQ.1) THEN                                                         
            PK = PSAT(TK)                                                       
            P = PK * 9.8067D4                                                   
            NTAB(2) = 1                                                         
      ENDIF                                                                     
C                                                                               
      IF(NIN.EQ.2) THEN                                                         
            TK = TSAT(PK)                                                       
            T = TK + 273.15                                                     
            NTAB(2) = 1                                                         
      ENDIF                                                                     
C                                                                               
      IF(NIN.EQ.3) THEN                                                         
            PK = PSAT(TK)                                                       
            P = PK*9.8067D4                                                     
            NTAB(2) = 2                                                         
      ENDIF                                                                     
C                                                                               
      IF(NIN.EQ.4) THEN                                                         
            TK = TSAT(PK)                                                       
            T = TK + 273.15                                                     
            NTAB(2) = 2                                                         
      ENDIF                                                                     
C                                                                               
      CALL STEAMF(PK,TK,ZKTAB(1),ZKTAB(2),ZKTAB(3),ZKTAB(4),                    
     1            ZKTAB(5),ZKTAB(6),ZKTAB(7),ZKTAB(8),                          
     1            ZKTAB(9),ZKTAB(10),ZKTAB(11),ZKTAB(12),                       
     1            ZKTAB(13),ZKTAB(14),ZKTAB(15),ZKTAB(16),                      
     1            ZKTAB(17),ZKTAB(18),NTAB(1),NTAB(2),NTAB(3),NTAB(4) )         
C                                                                               
C                                                                               
      DO 100 I = 1,18                                                           
      ZTAB(I) = ZKTAB(I)                                                        
  100 CONTINUE                                                                  
C                                                                               
C                                                                               
C   SPECIFIC VOLUME     M3/KG => M3/KG                                          
C                                                                               
      ZTAB(1) = ZKTAB(1) * 1.00000                                              
C                                                                               
C   SPECIFIC ENTHALPY   KCAL/KG => J/KG                                         
C                                                                               
      ZTAB(2) = ZKTAB(2) * 4.1860D3                                             
C                                                                               
C   SPECIFIC ENTROPY    KCAL/KG C => J/KG K                                     
C                                                                               
      ZTAB(3) = ZKTAB(3) * 4.1860D3                                             
C                                                                               
C   SPECIFIC ENERGY     KCAL/KG => J/KG                                         
C                                                                               
      ZTAB(4) = ZKTAB(4) * 4.1860D3                                             
C                                                                               
C   SPECIFIC HEAT   CP    KCAL/KG C => J/KG K                                   
C                                                                               
      ZTAB(5) = ZKTAB(5) * 4.1860D3                                             
C                                                                               
C   SPECIFIC HEAT   CV    KCAL/KG C => J/KG K                                   
C                                                                               
      ZTAB(6) = ZKTAB(6) * 4.1860D3                                             
C                                                                               
C   SQUARED LIGHT VELOSITY  M2/SEC2 => M2/SEC2                                  
C                                                                               
      ZTAB(7) = ZKTAB(7) * 1.00000                                              
C                                                                               
C   DH/DRO     KCAL M3/KG2 => J M3/KG2                                          
C                                                                               
      ZTAB(8) = ZKTAB(8) * 4.1860D3                                             
C                                                                               
C                       1/K => 1/K                                              
C                                                                               
      ZTAB(9) = ZKTAB(9) * 1.00000                                              
C                                                                               
C   GAMMA                     =>                                                
C                                                                               
      ZTAB(10) = ZKTAB(10) * 1.00000                                            
C                                                                               
C   COMPRESION FACTOR    M2/N => M2/N                                           
C                                                                               
      ZTAB(11) = ZKTAB(11) * 1.00000                                            
C                                                                               
C   GIBBS FREE ENERGY     KCAL/KG => J/KG                                       
C                                                                               
      ZTAB(12) = ZKTAB(12) * 4.1860D3                                           
C                                                                               
C   HELMHOLTZ FREE ENERGY  M3/KG => M3/KG                                       
C                                                                               
      ZTAB(13) = ZKTAB(13) * 4.1860D3                                           
C                                                                               
C   VISCOSITY     MICRO POISE => KG/M2 S                                        
C                                                                               
      ZTAB(14) = ZKTAB(14) * 1.0D-7                                             
C                                                                               
C   KINEMATIC VISCOSITY    M2/S => M2/S                                         
C                                                                               
      ZTAB(15) = ZKTAB(15) * 1.00000                                            
C                                                                               
C   THERMAL CONDUCTIVITY  KCAL/M H C => W/M C                                   
C                                                                               
      ZTAB(16) = ZKTAB(16) * 1.16280                                            
C                                                                               
C   TERMAL DUFISITIVITY    M2/H => M2/S                                         
C                                                                               
      ZTAB(17) = ZKTAB(17) / 3600.00                                            
C                                                                               
C   PRANDTLE NUMBER                   =>                                        
C                                                                               
      ZTAB(18) = ZKTAB(18) * 1.00000                                            
C                                                                               
C   SURFACE TENSION                   =>                                        
C                                                                               
      CALL SYGCAL( T,ZTAB(19) )                                                 
C                                                                               
C                                                                               
      NOUT=0                                                                    
C                                                                               
      IF(ZKTAB(14).EQ.0.0.AND.ZKTAB(16).EQ.0.0)  THEN                           
             NOUT=3                                                             
             CALL VISCAL (T,1.0/ZTAB(1),VIS)                                    
               DVIS = VIS*ZTAB(1)                                               
             CALL CONCAL (T,1.0/ZTAB(1),CON)                                    
               TDIF = CON*ZTAB(1)/ZTAB(5)                                       
             PR = DVIS / TDIF                                                   
C                                                                               
             ZTAB(14) = VIS                                                     
             ZTAB(15) = DVIS                                                    
             ZTAB(16) = CON                                                     
             ZTAB(17) = TDIF                                                    
             ZTAB(18) = PR                                                      
             GO TO 1000                                                         
      ENDIF                                                                     
C                                                                               
C                                                                               
      IF(ZKTAB(16).EQ.0.0) THEN                                                 
             NOUT = 2                                                           
             CALL CONCAL(T,1.0/ZTAB(1),CON)                                     
             TDIF = CON*ZTAB(1)/ZTAB(5)                                         
             PR = ZTAB(15)/TDIF                                                 
C                                                                               
             ZTAB(16)=CON                                                       
             ZTAB(17)=TDIF                                                      
             ZTAB(18)=PR                                                        
             GO TO 1000                                                         
       ENDIF                                                                    
C                                                                               
C                                                                               
      IF(ZKTAB(14).EQ.0.0) THEN                                                 
             NOUT = 1                                                           
             CALL VISCAL(T,1.0/ZTAB(1),VIS)                                     
             DVIS = VIS*ZTAB(1)                                                 
             PR = DVIS/ZTAB(17)                                                 
C                                                                               
             ZTAB(14)=VIS                                                       
             ZTAB(15)=DVIS                                                      
             ZTAB(18)=PR                                                        
             GO TO 1000                                                         
       ENDIF                                                                    
C                                                                               
C                                                                               
 1000 CONTINUE                                                                  
C                                                                               
C                                                                               
      RETURN                                                                    
      END                                                                       
C                                                                               
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE CONCAL ( T,DEN,CON )                                           
C                                                                               
C     CONDUCTIVITY CALCULATION                                                  
C                                                                               
C                              REF.1980 JSME STEAM TABLE                        
C                                                                               
C        SI UNIT     DEN : DENSITY     KG/M3                                    
C                      T ; TEMPERATURE     K                                    
C                    CON ; THERMAL CONDUCTIVITY  W/M K                          
C                                                                               
      IMPLICIT REAL*8  (A-H,O-Z)                                                
C                                                                               
      DATA  TSTA / 647.30 /                                                     
      DATA  ROSTA / 317.7 /                                                     
      DATA  BB1 / -1.71587D-1 /                                                 
      DATA  BB2 / 2.39219 /                                                     
      DATA  C1 / 6.42857D-1 /                                                   
      DATA  C2 / -4.11717 /                                                     
      DATA  C3 / -6.17937 /                                                     
      DATA  C4 / 3.08976D-3 /                                                   
      DATA  C5 / 8.22994D-2 /                                                   
      DATA  C6 / 1.00932D1 /                                                    
      DATA  A0 / 1.02811D-2 /                                                   
      DATA  A1 / 2.99621D-2 /                                                   
      DATA  A2 / 1.56146D-2 /                                                   
      DATA  A3 / -4.22464D-3 /                                                  
      DATA  B0 / -3.97070D-1 /                                                  
      DATA  B1 / 4.00302D-1 /                                                   
      DATA  B2 / 1.06 /                                                         
      DATA  D1 / 7.01309D-2 /                                                   
      DATA  D2 / 1.18520D-2 /                                                   
      DATA  D3 / 1.69937D-3 /                                                   
      DATA  D4 / -1.02 /                                                        
C                                                                               
C                                                                               
      DTSTA = ABS( T / TSTA - 1.0 ) + C4                                        
      TRAT = T / TSTA                                                           
      IF( TRAT.GE.1.0 ) THEN                                                    
           S = DTSTA**(-1.0)                                                    
           ELSE                                                                 
           S = C6*DTSTA*(-0.6)                                                  
      ENDIF                                                                     
C                                                                               
      Q = 2.0 + C5*DTSTA**(-0.6)                                                
      R = Q + 1.0                                                               
C                                                                               
      RAM0 = TRAT**0.5 *( A0 + A1*TRAT + A2*TRAT**2 + A3*TRAT**3 )              
      RAMBAR = B0 + B1*DEN/ROSTA + B2*DEXP( BB1*(DEN/ROSTA+BB2)**2 )            
      DELRAM = ( D1*(1/TRAT)**10+D2 ) * (DEN/ROSTA)**1.8 *                      
     1         DEXP( C1*( 1.0-(DEN/ROSTA)**2.8 ) ) +                            
     2         D3*S*(DEN/ROSTA)**Q*DEXP( Q/R*(1.0-(DEN/ROSTA)**R) )             
     3       + D4*DEXP( C2*TRAT**1.5 + C3*(ROSTA/DEN)**5 )                      
C                                                                               
C                                                                               
      CON = RAM0 + RAMBAR + DELRAM                                              
C                                                                               
C                                                                               
      RETURN                                                                    
      END                                                                       
C                                                                               
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE VISCAL( T,DEN,VIS )                                            
C                                                                               
C        PROGRAM FOR VISCOSITY CALCULATION                                      
C                                                                               
C                                                                               
C           T IN K   DEN IN KG/M3  VIS IS PA.S                                  
C                                  REFFERENCE    1980 JSME STEAM TABLE          
C                                                                               
      IMPLICIT  REAL*8  (A-H,O-Z)                                               
C                                                                               
      DIMENSION A(4),B(6,5)                                                     
C                                                                               
      DATA   TSTA /647.27/                                                      
      DATA   DENSTA /317.763/                                                   
      DATA   A /  0.0181583,  0.0177624,  0.0105287, -0.0036744 /               
      DATA   B /                                                                
     * 0.501938,  0.162888, -0.130356,  0.907919, -0.551119,  0.146543,         
     * 0.235622,  0.789393,  0.673665,  1.207552,  0.0670665, -0.084337,        
     *-0.274637, -0.743539, -0.959456, -0.687343, -0.497089,  0.195286,         
     * 0.145831,  0.263129,  0.347247,  0.213486,  0.100754, -0.032932,         
     *-0.0270448,-0.0253093,-0.0267758,-0.0822904, 0.0602253,-0.0202595/        
C                                                                               
C                                                                               
      SUM = 0.0                                                                 
C                                                                               
      DO 100 I = 1,4                                                            
C                                                                               
      SUM = SUM + A(I) * ( TSTA / T )**(I-1)                                    
C                                                                               
  100 CONTINUE                                                                  
C                                                                               
      VIS0 = DSQRT( T/TSTA ) / SUM                                              
C                                                                               
      SUM = 0.0                                                                 
C                                                                               
      DO 200 I = 1,6                                                            
C                                                                               
      DO 200 J = 1,5                                                            
C                                                                               
      SUM = SUM + B(I,J) * ( TSTA / T - 1.0 )**(I-1) *                          
     *                     ( DEN / DENSTA - 1.0 )**(J-1)                        
C                                                                               
  200 CONTINUE                                                                  
C                                                                               
      VIS = VIS0 * DEXP( DEN / DENSTA * SUM )                                   
      VIS = 1.0D-6 * VIS                                                        
C                                                                               
      RETURN                                                                    
      END                                                                       
C                                                                               
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE  SYGCAL(T,SYG)                                                 
C                                                                               
C       SURFACE TENSION CALCULATION                                             
C                                                                               
C                     T IN K    ;  SYG IN N/M2                                  
C                                                                               
      REAL*8 SYG,T,TC                                                           
C                                                                               
      DATA  TC / 647.15 /                                                       
C                                                                               
      SYG = 0.2358 * (1.0-T/TC)**1.256*( 1.0-0.625*(1.0-T/TC) )                 
C                                                                               
      RETURN                                                                    
      END                                                                       
                                                                                
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
      SUBROUTINE STEAMF (P,T,SPVOL,ENTAL,ENTRO,EI,CP,CV,CC,HRHO,BETHA,          
     1                   GAMMA,AKAP,G,F,VIS,DVIS,TCON,A,PR,NREGON,              
     2                   NSTWAT,IPR,IZV)                                        
C                                                                               
C     NREGON=1 -- SUBREGION 1 (SUBROUTINE SUB1)                                 
C     NREGON=2 -- SUBREGION 2 (SUBROUTINE SUB2)                                 
C     NREGON=3 -- SUBREGION 3 (SUBROUTINE SUB3)                                 
C     NREGON=4 -- SUBREGION 4 (SUBROUTINE SUB4)                                 
C                                                                               
C     NSTWAT=0 -- COMPRESSUED WATER OR SUPERHEATED STEAM                        
C     NSTWAT=1 -- SATURATED STEAM                                               
C     NSTWAT=2 -- SATURATED WATER                                               
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      PB=0.980665*P                                                             
      BET=PB/221.2                                                              
      TK=T+273.15                                                               
      SIT=TK/647.3                                                              
      BTK=BETK(SIT)                                                             
      CALL SUBBET(SIT,BTL,BETLD,BETLDD)                                         
      BT2=4.520795660                                                           
      SIT1=0.9626911787                                                         
      SIT2=1.333462073                                                          
      SIT3=1.657886606                                                          
      SITT=273.15/647.3                                                         
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(NSTWAT.EQ.2)) GO TO 1              
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(NSTWAT.EQ.1)) GO TO 2              
      IF ((SIT.GT.SIT1.AND.SIT.LE.1.0).AND.(NSTWAT.EQ.1)) GO TO 3               
      IF ((SIT.GT.SIT1.AND.SIT.LE.1.0).AND.(NSTWAT.EQ.2)) GO TO 4               
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(BET.GT.BTK.AND.BET.LE.BT2)         
     1   ) GO TO 1                                                              
      IF ((SIT.GE.SITT.AND.SIT.LE.SIT1).AND.(BET.GE.0.0.AND.BET.LT.BTK))        
     1   GO TO 2                                                                
      IF ((SIT.GT.SIT1.AND.SIT.LT.SIT2).AND.(BET.GE.0.0.AND.BET.LE.BTL))        
     1   GO TO 2                                                                
      IF ((SIT.GE.SIT2.AND.SIT.LE.SIT3).AND.(BET.GE.0.0.AND.BET.LE.BT2))        
     1   GO TO 2                                                                
      IF ((SIT.GT.SIT1.AND.SIT.LT.1.0).AND.(BET.GT.BTL.AND.BET.LT.BTK))         
     1   GO TO 3                                                                
      IF ((SIT.GE.1.0.AND.SIT.LT.SIT2).AND.(BET.GT.BTL.AND.BET.LE.BT2))         
     1   GO TO 3                                                                
      IF ((SIT.GT.SIT1.AND.SIT.LT.1.0).AND.(BET.GT.BTK.AND.BET.LE.BT2))         
     1   GO TO 4                                                                
      GO TO 5                                                                   
    1 NREGON=1                                                                  
      CALL SUB1 (SIT,BET,ZET,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    2 NREGON=2                                                                  
      CALL SUB2 (SIT,BET,ZET,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    3 NREGON=3                                                                  
      CALL SUB3 (SIT,BET,PSI,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    4 NREGON=4                                                                  
      CALL SUB4 (SIT,BET,PSI,CHI,SIG,EPS,FAI,FAV,RHRHO,RCC,RBETHA,RKAP,         
     1           RGAM,IZV)                                                      
      GO TO 6                                                                   
    5 STOP 'STEAMF (P,T,SPVOL,ENTAL,ENTRO,CP,CV,G,F,VIS,DVIS,TCON,A,PR,N        
     1REGON,NSTWAT)'                                                            
    6 SPVOL=CHI*0.00317                                                         
      ENTAL=EPS*70120.4*0.238846*0.001                                          
      ENTRO=SIG*108.3275143*0.238846*0.001                                      
      IF(IZV.EQ.0)RETURN                                                        
      TC1=647.3                                                                 
      PC1=22120000.                                                             
      VC1=.00317                                                                
      CP=FAI*108.3275143*0.238846*0.001                                         
      IF(IZV.EQ.-1)RETURN                                                       
      CV=FAV*108.3275143*0.238846*0.001                                         
      CC=RCC*PC1*VC1                                                            
      HRHO=RHRHO*VC1*VC1*PC1*.238846*.001                                       
      BETHA=RBETHA/TC1                                                          
      GAMMA=RGAM                                                                
      AKAP=RKAP/PC1                                                             
      EI=ENTAL-SPVOL*P*0.234228*100.                                            
      F=EI-TK*ENTRO                                                             
      G=ENTAL-TK*ENTRO                                                          
      CALL VISCON(P,T,SPVOL,VISMP,TCONMW,NREGON,NSTWAT)                         
      VIS=VISMP                                                                 
      DVIS=VIS*SPVOL*1.000000E-07                                               
      TCON=0.859845*0.001*TCONMW                                                
C     WRITE(6,10) NREGON                                                        
   10 FORMAT(I10)                                                               
C     RETURN                                                                    
  101 CONTINUE                                                                  
      A=TCON*SPVOL/CP                                                           
      IF(DABS(A).GE.1.0D-20) GO TO 20                                           
      IPR=0                                                                     
      PR=0.                                                                     
      RETURN                                                                    
   20 IPR=1                                                                     
      PR=DVIS*3600.0/A                                                          
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION PSAT(T)                                         
C                                                                               
C     PRESSURE OF SATURATED STEAM AS A FUNCTION OF TEMPERATURE                  
C                                                                               
C     PSAT = SATURATION PRESSURE (KG/CM2)                                       
C     T    = TEMPERATURE (OC) (0-374.15 OC)                                     
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      SIT=(T+273.15)/647.3                                                      
      BTK=BETK(SIT)                                                             
      PSAT=BTK*221.2/0.980665                                                   
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION TSAT(P)                                         
C                                                                               
C     TEMPERATURE OF SATURATED STEAM AS A FUNCTION OF PRESSURE                  
C                                                                               
C     TSAT = SATURATION TEMPERATURE (OC)                                        
C     P    = PRESSURE (KG/CM2) (0.006228-225.65 KG/CM2)                         
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      BET=P*0.980665/221.2                                                      
      TSAT=BETKP(BET)*647.3-273.15                                              
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION TSATA(P)                                        
C                                                                               
C     TEMPERATURE OF SATURATED STEAM AND WATER AS A FUNCTION OF PRESSURE        
C                                                                               
C     TSATA = SATURATED TEMPERATURE (OC)                                        
C                                                                               
C     P = PRESSURE (KG/CM2)                                                     
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      IF(P.GE.0.1) GO TO 1                                                      
      C0=-1.4027184                                                             
      C1=2.9622845                                                              
      C2=-1.1582744                                                             
      C3=3.1894969E-1                                                           
      C4=-5.5043472E-2                                                          
      C5=5.6724437E-3                                                           
      C6=-3.1813374E-4                                                          
      C7=7.4526790E-6                                                           
      XS=100.                                                                   
      YS=0.1                                                                    
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*C7)))))))/YS                  
      GO TO 5                                                                   
    1 IF(P.GE.1.5) GO TO 2                                                      
      C0=1.3909155                                                              
      C1=4.4918984                                                              
      C2=-1.7145823                                                             
      C3=3.9849678E-1                                                           
      C4=-5.0037269E-2                                                          
      C5=3.1144544E-3                                                           
      C6=-7.4511981E-5                                                          
      XS=10.                                                                    
      YS=0.1                                                                    
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*C6))))))/YS                         
      GO TO 5                                                                   
    2 IF(P.GE.10.) GO TO 3                                                      
      C0=5.4115033E-1                                                           
      C1=7.1971995E-1                                                           
      C2=-4.0200320E-1                                                          
      C3=1.7558544E-1                                                           
      C4=-5.3055241E-2                                                          
      C5=1.0852398E-2                                                           
      C6=-1.4695072E-3                                                          
      C7=1.2579400E-4                                                           
      C8=-6.1513953E-6                                                          
      C9=1.3072177E-7                                                           
      XS=1.                                                                     
      YS=0.01                                                                   
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*(C7+X*(C8+X*C9))))))))        
     1)/YS                                                                      
      GO TO 5                                                                   
    3 IF(P.GE.100.) GO TO 4                                                     
      C0=1.0164701                                                              
      C1=1.3449215                                                              
      C2=-9.0888377E-1                                                          
      C3=4.6834233E-1                                                           
      C4=-1.6377515E-1                                                          
      C5=3.8669958E-2                                                           
      C6=-6.1522423E-3                                                          
      C7=6.4864736E-4                                                           
      C8=-4.3375412E-5                                                          
      C9=1.6638736E-6                                                           
      C10=-2.7863220E-8                                                         
      XS=0.1                                                                    
      YS=0.01                                                                   
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*(C7+X*(C8+X*(C9+X*C10)        
     1)))))))))/YS                                                              
      GO TO 5                                                                   
    4 C0=2.0679536                                                              
      C1=8.4703533E-1                                                           
      C2=1.6565001                                                              
      C3=-3.1971445                                                             
      C4=2.6767174                                                              
      C5=-1.2202267                                                             
      C6=2.9377612E-1                                                           
      C7=-2.9311442E-2                                                          
      XS=0.01                                                                   
      YS=0.01                                                                   
      X=P*XS                                                                    
      Y=(C0+X*(C1+X*(C2+X*(C3+X*(C4+X*(C5+X*(C6+X*C7)))))))/YS                  
    5 TSATA=Y                                                                   
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUBBET(SIT,BETL,BETLD,BETLDD)                                  
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      DOUBLE PRECISION L0,L1,L2                                                 
C                                                                               
      L0=1.574373327D+01                                                        
      L1=-3.417061978D+01                                                       
      L2=1.931380707D+01                                                        
      BETL=L0+SIT*(L1+SIT*L2)                                                   
      BETLD=L1+2.0*L2*SIT                                                       
      BETLDD=2.0*L2                                                             
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C     THE OPTION 'FORT='AUTODBL(DBLPAD4)' ' SHOULD BE USED                      
C     IN COMPILING THIS PROGRAM BY THE 'FORTRAN-HE COMPILER.                    
C     OPTION DOUBLE                                                             
      SUBROUTINE SUB1 (SIT,BET,ZETA,CHI1,SIG1,EPS1,FAI1,FAV1,RHRHO1,            
     1                 RCC1,RBETHA,RKAP1,RGAM1,IZV)                             
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
C     SUBREGION 1                                                               
C                                                                               
      A0=6.824687741D+03                                                        
      A1=-5.422063673D+02                                                       
      A2=-2.096666205D+04                                                       
      A3=3.941286787D+04                                                        
      A4=-6.733277739D+04                                                       
      A5=9.902381028D+04                                                        
      A6=-1.093911774D+05                                                       
      A7=8.590841667D+04                                                        
      A8=-4.511168742D+04                                                       
      A9=1.418138926D+04                                                        
      A10=-2.017271113D+03                                                      
      A11=7.982692717D+00                                                       
      A12=-2.616571843D-02                                                      
      A13=1.522411790D-03                                                       
      A14=2.284279054D-02                                                       
      A15=2.421647003D+02                                                       
      A16=1.269716088D-10                                                       
      A17=2.074838328D-07                                                       
      A18=2.174020350D-08                                                       
      A19=1.105710498D-09                                                       
      A20=1.293441934D+01                                                       
      A21=1.308119072D-05                                                       
      A22=6.047626338D-14                                                       
      AS1=8.438375405D-01                                                       
      AS2=5.362162162D-04                                                       
      AS3=1.720000000D+00                                                       
      AS4=7.342278489D-02                                                       
      AS5=4.975858870D-02                                                       
      AS6=6.537154300D-01                                                       
      AS7=1.150000000D-06                                                       
      AS8=1.510800000D-05                                                       
      AS9=1.418800000D-01                                                       
      AS10=7.002753165D+00                                                      
      AS11=2.995284926D-04                                                      
      AS12=2.040000000D-01                                                      
      Y=1.0-AS1*SIT**2-AS2*SIT**(-6)                                            
      Z=Y+DSQRT(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)                               
      ZETA=A0*SIT*(1.0-DLOG(SIT))+A1+SIT*(A2+SIT*(A3+SIT*(A4+SIT*(A5            
     1     +SIT*(A6+SIT*(A7+SIT*(A8+SIT*(A9+SIT*A10))))))))+A11*(17.0/          
     2     29.0*Z-17.0/12.0*Y)*Z**(12./17.)+(A12+A13*SIT+A14*SIT**2+A15*        
     3     (AS6-SIT)**10+A16*(AS7+SIT**19)**(-1))*BET-(AS8+SIT**11)**           
     4     (-1)*BET*(A17+BET*(A18+BET*A19))-A20*SIT**18*(AS9+SIT**2)*           
     5     ((AS10+BET)**(-3)+AS11*BET)+A21*(AS12-SIT)*BET**3+A22*SIT**          
     6     (-20)*BET**4                                                         
      CHI1=A11*AS5*Z**(-5./17.)+(A12+A13*SIT+A14*SIT**2+A15*(AS6-SIT)**         
     1     10+A16*(AS7+SIT**19)**(-1))-(AS8+SIT**11)**(-1)*(A17+2.0*A18*        
     2     BET+3.0*A19*BET**2)-A20*SIT**18*(AS9+SIT**2)*(-3.0*(AS10+BET)        
     3     **(-4)+AS11)+3.0*A21*(AS12-SIT)*BET**2+4.0*A22*SIT**(-20)*           
     4     BET**3                                                               
      YS=-2.0*AS1*SIT+6.0*AS2*SIT**(-7)                                         
      SIG1=A0*DLOG(SIT)-A2-SIT*(2.0*A3+SIT*(3.0*A4+SIT*(4.0*A5+SIT*(5.0         
     1     *A6+SIT*(6.0*A7+SIT*(7.0*A8+SIT*(8.0*A9+SIT*9.0*A10)))))))           
     2     +A11*((5.0/12.0*Z-(AS3-1.0)*Y)*YS+AS4)*Z**(-5./17.)+(-A13-2.*        
     3     A14*SIT+10.0*A15*(AS6-SIT)**9+19.0*A16*(AS7+SIT**19)**(-2)*          
     4     SIT**18)*BET-11.0*(AS8+SIT**11)**(-2)*SIT**10*(A17*BET+A18*          
     5     BET**2+A19*BET**3)+A20*SIT**17*(18.0*AS9+20.0*SIT**2)*((AS10         
     6     +BET)**(-3)+AS11*BET)+A21*BET**3+20.0*A22*SIT**(-21)*BET**4          
      EPS1=ZETA+SIT*SIG1                                                        
      IF(IZV.EQ.0)RETURN                                                        
      YSS=-2.0*AS1-42.0*AS2*SIT**(-8)                                           
      ZS=YS+(AS3*Y*YS-AS4)*(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)**(-0.5)           
      ZSS=YSS+AS3*(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)**(-0.5)*(YS**2+Y*          
     1    YSS)-(AS3*Y*YS-AS4)**2*(AS3*Y**2-2.0*AS4*SIT+2.0*AS5*BET)**           
     2    (-1.5)                                                                
      ZESS=-A0*SIT**(-1)+1.0*2.0*A3+SIT*(2.0*3.0*A4+SIT*(3.0*4.0*A5+SIT*        
     1     (4.0*5.0*A6+SIT*(5.0*6.0*A7+SIT*(6.0*7.0*A8+SIT*(7.0*8.0*A9+         
     2     SIT*8.*9.*A10))))))+A11*((12./29.*Z-Y)*(Z**(-5./17.)*ZSS-5./1        
     3     7.*Z**(-22./17.)*ZS**2)+(24./29.*ZS-2.*YS)*Z**(-5./17.)*ZS+(         
     4     17./29.*ZSS-17./12.*YSS)*Z**(12./17.))+BET*(2.0*A14+90.0*A15*        
     5     (AS6-SIT)**8+722.0*A16*SIT**36*(AS7+SIT**19)**(-3)-342.0*A16*        
     6     SIT**17*(AS7+SIT**19)**(-2))-(242.0*SIT**20*(AS8+SIT**11)**          
     7     (-3)-110.0*SIT**9*(AS8+SIT**11)**(-2))*(A17*BET+A18*BET**2+          
     8     A19*BET**3)-A20*SIT**16*(306.0*AS9+380.0*SIT**2)*((AS10+BET)         
     9     **(-3)+AS11*BET)+420.0*A22*SIT**(-22)*BET**4                         
      FAI1=-SIT*ZESS                                                            
      IF(IZV.EQ.-1)RETURN                                                       
      ZB=AS5/(Z-Y)                                                              
      ZSB=-0.5*AS5/(Z-Y)**3*(2.0*AS3*Y*YS-2.0*AS4)                              
      ZBB=-AS5**2/(Z-Y)**3                                                      
      ZESB=-                                                                    
     A     5.0/17.0*A11*ZB*Z**(-22.0/17.0)*(Z*YS+(AS3-1.0)*Y*YS-AS4)+           
     1     (A13+2.0*A14*SIT-10.0*A15*(AS6-SIT)**9-19.0*A16*(AS7+SIT**19)        
     2     **(-2)*SIT**18)+11.0*(AS8+SIT**11)**(-2)*SIT**10*(A17+2.0*A18        
     3     *BET+3.0*A19*BET**2)-2.0*A20*SIT**17*(9.0*AS9+10.0*SIT**2)*(         
     4     -3.0*(AS10+BET)**(-4)+AS11)-3.0*A21*BET**2-80.0*A22*SIT**            
     5     (-21)*BET**3                                                         
      ZEBB=-5.0/17.0*A11*AS5*Z**(-22.0/17.0)*ZB-(AS8+SIT**11)**(-1)*(2.0        
     1     *A18+6.0*A19*BET)-12.0*A20*SIT**18*(AS9+SIT**2)*(AS10+BET)**         
     2     (-5)+6.0*A21*(AS12-SIT)*BET+12.0*A22*SIT**(-20)*BET**2               
      FAV1=FAI1+SIT*ZESB**2/ZEBB                                                
      CHI1SQ=CHI1*CHI1                                                          
      ZEBBSQ=ZEBB*ZEBB                                                          
      RHRHO1=CHI1SQ*SIT*ZESS/ZESB                                               
      ZESBSQ=ZESB*ZESB                                                          
      RCC1=-CHI1SQ/(ZEBB-ZESBSQ/ZESS)                                           
      RBETHA=ZESB/CHI1                                                          
      RKAP1=-ZEBB/CHI1                                                          
      RGAM1=FAI1/FAV1                                                           
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUB2 (SIT,BET,ZETB,CHI2,SIG2,EPS2,FAI2,FAV2,RHRHO2,            
     1                  RCC2,RBETHA,RKAP2,RGAM2,IZV)                            
C                                                                               
C     SUBREGION 2                                                               
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DIMENSION B(8,3),BS(8,2)                                                  
C                                                                               
      B0= 1.683599274D+01                                                       
      B01=2.856067796D+01                                                       
      B02=-5.438923329D+01                                                      
      B03=4.330662834D-01                                                       
      B04=-6.547711697D-01                                                      
      B05=8.565182058D-02                                                       
      B90=1.936587558D+02                                                       
      B91=-1.388522425D+03                                                      
      B92=4.126607219D+03                                                       
      B93=-6.508211677D+03                                                      
      B94=5.745984054D+03                                                       
      B95=-2.693088365D+03                                                      
      B96=5.235718623D+02                                                       
      BB=7.633333333D-01                                                        
      B(1,1)=6.670375918D-02                                                    
      B(1,2)=1.388983801D+00                                                    
      B(1,3)=0.                                                                 
      B(2,1)=8.390104328D-02                                                    
      B(2,2)=2.614670893D-02                                                    
      B(2,3)=-3.373439453D-02                                                   
      B(3,1)=4.520918904D-01                                                    
      B(3,2)=1.069036614D-01                                                    
      B(3,3)=0.                                                                 
      B(4,1)=-5.975336707D-01                                                   
      B(4,2)=-8.847535804D-02                                                   
      B(4,3)=0.                                                                 
      B(5,1)=5.958051609D-01                                                    
      B(5,2)=-5.159303373D-01                                                   
      B(5,3)=2.075021122D-01                                                    
      B(6,1)=1.190610271D-01                                                    
      B(6,2)=-9.867174132D-02                                                   
      B(6,3)=0.                                                                 
      B(7,1)=1.683998803D-01                                                    
      B(7,2)=-5.809438001D-02                                                   
      B(7,3)=0.                                                                 
      B(8,1)=6.552390126D-03                                                    
      B(8,2)=5.710218649D-04                                                    
      B(8,3)=0.                                                                 
      BS(1,1)=0.                                                                
      BS(1,2)=0.                                                                
      BS(2,1)=0.                                                                
      BS(2,2)=0.                                                                
      BS(3,1)=0.                                                                
      BS(3,2)=0.                                                                
      BS(4,1)=0.                                                                
      BS(4,2)=0.                                                                
      BS(5,1)=0.                                                                
      BS(5,2)=0.                                                                
      BS(6,1)=4.006073948D-01                                                   
      BS(6,2)=0.                                                                
      BS(7,1)=8.636081627D-02                                                   
      BS(7,2)=0.                                                                
      BS(8,1)=-8.532322921D-01                                                  
      BS(8,2)=3.460208861D-01                                                   
      TC1=647.3                                                                 
      PC1=22120000.0                                                            
      VC1=0.00317                                                               
      R1=461.51                                                                 
      AI1=R1*TC1/(PC1*VC1)                                                      
      X=DEXP(BB*(1.0-SIT))                                                      
      CALL SUBBET(SIT,BETL,BETLD,BETLDD)                                        
      S01=0.0                                                                   
      S02=0.0                                                                   
      S03=0.0                                                                   
      S04=0.0                                                                   
      S05=0.0                                                                   
      S06=0.0                                                                   
      S07=0.0                                                                   
      S08=0.0                                                                   
      S09=0.0                                                                   
      S10=0.0                                                                   
      DO 4 I=1,8                                                                
      BX=0.0                                                                    
      ZBX=0.0                                                                   
      BZX=0.0                                                                   
      BXA=0.0                                                                   
      BXB=0.0                                                                   
      BXC=0.0                                                                   
      NNI=NN(I)                                                                 
      NLI=NL(I)                                                                 
      DO 2 J=1,NNI                                                              
      SBX=0.0                                                                   
      XBX=0.0                                                                   
      NZIJ=NZ(I,J)                                                              
      FNZIJ=FLOAT(NZIJ)                                                         
      DO 1 K=1,NLI                                                              
      NXIK=NX(I,K)                                                              
      FNXIK=FLOAT(NXIK)                                                         
      SBX=SBX+BS(I,K)*X**NXIK                                                   
      XBX=XBX+FNXIK*BS(I,K)*X**NXIK                                             
    1 CONTINUE                                                                  
      BX=BX+B(I,J)*X**NZIJ                                                      
      ZBX=ZBX+FNZIJ*B(I,J)*X**NZIJ                                              
      BZX=BZX+B(I,J)*(1.0+FNZIJ*BB*SIT)*X**NZIJ                                 
      BXA=BXA+B(I,J)*X**NZIJ*(FNZIJ-XBX/(BET**(2-I)+SBX))                       
      BXB=BXB+B(I,J)*X**NZIJ*(-FNZIJ*(BET**(2-I)+SBX)+2.0*XBX)                  
      BXC=BXC+B(I,J)*X**NZIJ*FLOAT(2-I)*(FLOAT(1-I)*BET**(-I)*(BET**            
     1    (2-I)+SBX)-2.0*FLOAT(2-I)*BET**(2*(1-I)))                             
    2 CONTINUE                                                                  
      IF (I.GE.6) GO TO 3                                                       
      S01=S01+BET**I*BX                                                         
      S03=S03+FLOAT(I)*BET**(I-1)*BX                                            
      S05=S05+BET**I*ZBX                                                        
      S07=S07+FLOAT(I)*BET**(I-1)*ZBX                                           
      S09=S09+FLOAT(I*(I-1))*BET**(I-2)*BX                                      
      GO TO 4                                                                   
    3 S02=S02+BX/(BET**(2-I)+SBX)                                               
      S04=S04+FLOAT(I-2)*BET**(1-I)*BX/(BET**(2-I)+SBX)**2                      
      S06=S06+BXA/(BET**(2-I)+SBX)                                              
      S08=S08+FLOAT(2-I)*BET**(1-I)*BXB/(BET**(2-I)+SBX)**2/(BET**(2-I)+        
     1    SBX)                                                                  
      S10=S10+BXC/(BET**(2-I)+SBX)**2/(BET**(2-I)+SBX)                          
    4 CONTINUE                                                                  
      ZETB=AI1*SIT*DLOG(BET)+B0*SIT*(1.0-DLOG(SIT))+B01+SIT*(B02+SIT*           
     1 (B03+SIT*(B04+SIT*B05)))-S01-S02+BET*(BET/BETL)**10*(B90+X*(B91+         
     2     X*(B92+X*(B93+X*(B94+X*(B95+X*B96))))))                              
      CHI2=AI1*SIT/BET-S03-S04+11.0*(BET/BETL)**10*(B90+X*(B91+X*(B92+X*        
     1     (B93+X*(B94+X*(B95+X*B96))))))                                       
      BBLD=10.0*BETLD/BETL                                                      
      SIG2=-AI1*DLOG(BET)+B0*DLOG(SIT)-B02-SIT*(2.0*B03+SIT*(3.0*B04+SIT        
     1     *4.0*B05))-BB*S05-BB*S06+BET*(BET/BETL)**10*(BBLD*B90+(BBLD+         
     2     BB)*B91*X+(BBLD+2.0*BB)*B92*X**2+(BBLD+3.0*BB)*B93*X**3+(BBLD        
     3     +4.0*BB)*B94*X**4+(BBLD+5.0*BB)*B95*X**5+(BBLD+6.0*BB)*B96*X         
     4     **6)                                                                 
      EPS2=ZETB+SIT*SIG2                                                        
           IF(IZV.EQ.0)RETURN                                                   
      BX61=B(6,1)*X**12*BET**4                                                  
      BX62=B(6,2)*X**11*BET**4                                                  
      BX71=B(7,1)*X**24*BET**5                                                  
      BX72=B(7,2)*X**18*BET**5                                                  
      BX81=B(8,1)*X**24*BET**6                                                  
      BX82=B(8,2)*X**14*BET**6                                                  
      BSX61=BS(6,1)*X**14*BET**4                                                
      BSX71=BS(7,1)*X**19*BET**5                                                
      BSX81=BS(8,1)*X**54*BET**6                                                
      BSX82=BS(8,2)*X**27*BET**6                                                
      F60=BX61+BX62                                                             
      F61=-BB*(12.0*BX61+11.0*BX62)                                             
      F62=BB**2*(144.0*BX61+121.0*BX62)                                         
      F70=BX71+BX72                                                             
      F71=-BB*(24.0*BX71+18.0*BX72)                                             
      F72=BB**2*(576.0*BX71+324.0*BX72)                                         
      F80=BX81+BX82                                                             
      F81=-BB*(24.0*BX81+14.0*BX82)                                             
      F82=BB**2*(576.0*BX81+196.0*BX82)                                         
      G60=1.0+BSX61                                                             
      G61=-14.0*BB*BSX61                                                        
      G62=196.0*BB**2*BSX61                                                     
      G70=1.0+BSX71                                                             
      G71=-19.0*BB*BSX71                                                        
      G72=361.0*BB**2*BSX71                                                     
      G80=1.0+BSX81+BSX82                                                       
      G81=-BB*(54.0*BSX81+27.0*BSX82)                                           
      G82=BB**2*(2916.0*BSX81+729.0*BSX82)                                      
      ZESS=-B0*SIT**(-1)+2.0*B03+6.0*B04*SIT+12.0*B05*SIT**2-(169.0*B(1,        
     1  1)*X**13+9.0*B(1,2)*X**3)*BB**2*BET-(324.0*B(2,1)*X**18+4.0*            
     2     B(2,2)*X**2+B(2,3)*X)*BB**2*BET**2-(324.0*B(3,1)*X**18+100.*         
     3     B(3,2)*X**10)*BB**2*BET**3-(625.0*B(4,1)*X**25+196.0*B(4,2)*         
     4     X**14)*BB**2*BET**4-(1024.0*B(5,1)*X**32+784.0*B(5,2)*X**28          
     5     +576.0*B(5,3)*X**24)*BB**2*BET**5-(F62/G60-(2.0*F61*G61+F60*         
     6     G62)/G60**2+2.0*F60*G61**2/G60**3)-(F72/G70-(2.0*F71*G71+F70         
     7     *G72)/G70**2+2.0*F70*G71**2/G70**3)-(F82/G80-(2.0*F81*G81+F80        
     8     *G82)/G80**2+2.0*F80*G81**2/G80**3)                                  
      ZESS=ZESS+(BET/BETL)**11*((110.0*BETLD**2/BETL-10.0*BETLDD)*(B90+         
     1     X*(B91+X*(B92+X*(B93+X*(B94+X*(B95+X*B96))))))+20.0*BB*BETLD*        
     2     X*(B91+X*(2.0*B92+X*(3.0*B93+X*(4.0*B94+X*(5.0*B95+X*6.0*B96)        
     3     ))))+BB**2*BETL*X*(B91+X*(4.0*B92+X*(9.0*B93+X*(16.0*B94+X*(         
     4     25.0*B95+X*36.0*B96))))))                                            
      FAI2=-SIT*ZESS                                                            
      IF(IZV.EQ.-1)RETURN                                                       
      ZESB=AI1/BET+BB*(S07+S08)-11.0*(BET/BETL)**10*(B90*BBLD+X*(B91*(          
     1     BBLD+BB)+X*(B92*(BBLD+2.0*BB)+X*(B93*(BBLD+3.0*BB)+X*(B94*(          
     2     BBLD+4.0*BB)+X*(B95*(BBLD+5.0*BB)+X*B96*(BBLD+6.0*BB)))))))          
      ZEBB=-AI1*SIT/BET**2-S09+S10+110.0/BETL*(BET/BETL)**9*(B90+X*(B91+        
     1     X*(B92+X*(B93+X*(B94+X*(B95+X*B96))))))                              
      FAV2=FAI2+SIT*ZESB**2/ZEBB                                                
      CHI2SQ=CHI2*CHI2                                                          
      ZESBSQ=ZESB*ZESB                                                          
      RHRHO2=CHI2SQ*SIT*ZESS/ZESB                                               
      RCC2=-CHI2SQ/(ZEBB-ZESBSQ/ZESS)                                           
      RBETHA=ZESB/CHI2                                                          
      RKAP2=-ZEBB/CHI2                                                          
      RGAM2=FAI2/FAV2                                                           
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUB3 (SIT,BET,PSIC,CHI,SIG3,EPS3,FAI3,FAV3,RHRHO3,RCC3,        
     1                 RBETHA,RKAP3,RGAM3,IZV)                                  
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
C     SUBREGION 3                                                               
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C012=-4.311577033D+00                                                     
      C11=7.086360850D-01                                                       
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
      CH0=CHI3(SIT,BET)                                                         
      N=0                                                                       
    1 CX=1.0/CH0                                                                
      F3=-(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))-BET                 
      F3D=-CX**3*(2.0*C02+CX*(6.0*C03+CX*(12.0*C04+CX*(20.0*C05+CX*(30.0        
     1    *C06+CX*(42.0*C07+CX*(56.0*C08+CX*(72.0*C09+CX*(90.0*C010+CX*         
     2    110.0*C011)))))))))+C012*CX**2-(CX**3*(2.0*C12+CX*(6.0*C13+CX*        
     3    (12.0*C14+CX*(20.0*C15+CX*30.0*C16))))-C17*CX**2)*SX-(CX**3*(         
     4    2.0*C22+CX*(6.0*C23+CX*(12.0*C24+CX*(20.0*C25+CX*(30.0*C26+CX*        
     5    42.0*C27)))))-C28*CX**2)*SX**2-(CX**3*(2.0*C32+CX*(6.0*C33+CX*        
     6    (12.0*C34+CX*(20.0*C35+CX*(30.0*C36+CX*(42.0*C37+CX*(56.0*C38+        
     7    CX*72.0*C39)))))))-C310*CX**2)*SX**3-30.0*C41*CX**7*SIT**(-23)        
     8    *SX-30.0*CH0**4*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64        
     9    ))))                                                                  
      CHI=CH0-F3/F3D                                                            
      IF (DABS(CH0/CHI-1.0).LE.1.0D-07) GO TO 2                                 
      N=N+1                                                                     
      IF(N.EQ.50) WRITE(6,10) N,CH0,CHI                                         
   10 FORMAT(10X,'SUB3',I5,2E20.7)                                              
      IF (N.GE.50) GO TO 2                                                      
      CH0=CHI                                                                   
      GO TO 1                                                                   
    2 CONTINUE                                                                  
      CX=1.0/CHI                                                                
      PSIC=C00+C01*CHI+CX*(C02+CX*(C03+CX*(C04+CX*(C05+CX*(C06+CX*(C07+         
     1     CX*(C08+CX*(C09+CX*(C010+CX*C011)))))))))+C012*DLOG(CHI)+(C11        
     2     *CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))+C17*DLOG(CHI)        
     3     )*SX+(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27)        
     4     ))))+C28*DLOG(CHI))*SX**2+(C31*CHI+CX*(C32+CX*(C33+CX*(C34+CX        
     5     *(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI))*         
     6     SX**3+(C40+C41*CHI**(-5))*SIT**(-23)*SX+C50*SIT*DLOG(SIT)+CHI        
     7     **6*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))+SX*           
     8     (C70+SX*(C71+SX*(C72+SX*(C73+SX*(C74+SX*(C75+SX*(C76+SX*(C77+        
     9     SX*C78))))))))                                                       
      SIG3=-(C11*CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))                 
     1     +C17*DLOG(CHI)+C50)-2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(        
     2     C25+CX*(C26+CX*C27)))))+C28*DLOG(CHI))*SX-3.0*(C31*CHI+CX*           
     3     (C32+CX*(C33+CX*(C34+CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)         
     4     ))))))+C310*DLOG(CHI))*SX**2+(C40+C41*CHI**(-5))*(22.0*SIT**         
     5     (-23)-23.0*SIT**(-24))-C50*DLOG(SIT)+CHI**6*SX1**3*(2.0*C60+         
     6     SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*6.0*C64))))-C70-          
     7     SX*(2.0*C71+SX*(3.0*C72+SX*(4.0*C73+SX*(5.0*C74+SX*(6.0*C75+         
     8     SX*(7.0*C76+SX*(8.0*C77+SX*9.0*C78)))))))                            
      EPS3=PSIC+SIT*SIG3+CHI*BET                                                
      IF(IZV.EQ.0)RETURN                                                        
      PSICD1=2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27        
     1       )))))+C28*DLOG(CHI))+6.0*(C31*CHI+CX*(C32+CX*(C33+CX*(C34+         
     2       CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI        
     3       ))*SX+(C40+C41*CHI**(-5))*(506.0*SIT-552.0)*SIT**(-25)+C50*        
     4       SX1+CHI**6*SX1**4*(6.0*C60+SX1*(12.0*C61+SX1*(20.0*C62+SX1*        
     5       (30.0*C63+SX1*42.0*C64))))+2.0*C71+SX*(6.0*C72+SX*(12.0*C73        
     6       +SX*(20.0*C74+SX*(30.0*C75+SX*(42.0*C76+SX*(56.0*C77+SX*72.        
     7       0*C78))))))                                                        
      PSICD2=C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*C14+CX*(4.0*C15+CX*5.0*         
     1       C16))))+C17*CX+2.0*(C21-CX**2*(C22+CX*(2.0*C23+CX*(3.0*C24         
     2       +CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))+C28*CX)*SX+3.0*(          
     3       C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(4.0*C35+CX*(5.0*        
     4       C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))+C310*CX)*SX**        
     5       2-5.0*C41*CHI**(-6)*(23.0-22.0*SIT)*SIT**(-24)-6.0*CHI**5*         
     6       SX1**3*(2.0*C60+SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*        
     7       6.0*C64))))                                                        
      PSICD3=-F3D                                                               
      CHISQ=CHI*CHI                                                             
      RHRHO3=CHISQ*SIT*(-PSICD1*PSICD3/PSICD2+PSICD2)                           
      RCC3=CHISQ*(PSICD3-PSICD2*PSICD2/PSICD1)                                  
      RKAP3=1./CHI/PSICD3                                                       
      RBETHA=-RKAP3*PSICD2                                                      
      FAV3=-SIT*PSICD1                                                          
      FAI3=FAV3+SIT*PSICD2**2/PSICD3                                            
      RGAM3=FAI3/FAV3                                                           
    3 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE SUB4 (SIT,BET,PSID,CHI,SIG4,EPS4,FAI4,FAV4,RHRHO4,             
     1                 RCC4,RBETHA,RKAP4,RGAM4,IZV)                             
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
C     SUBREGION 4                                                               
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C11=7.086360850D-01                                                       
      C012=-4.311577033D+00                                                     
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      D30=-1.717616747D+00                                                      
      D31=3.526389875D+00                                                       
      D32=-2.690899373D+00                                                      
      D33=9.070982605D-01                                                       
      D34=-1.138791156D-01                                                      
      D40=1.301023613D+00                                                       
      D41=-2.642777743D+00                                                      
      D42=1.996765362D+00                                                       
      D43=-6.661557013D-01                                                      
      D44=8.270860589D-02                                                       
      D50=3.426663535D-04                                                       
      D51=-1.236521258D-03                                                      
      D52=1.155018309D-03                                                       
      SIT1=9.626911787D-01                                                      
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
      SX2=1.0-SIT1                                                              
      Y=(1.0-SIT)/(1.0-SIT1)                                                    
      CH0=CHI4(SIT,BET)                                                         
      N=0                                                                       
    1 CX=1.0/CH0                                                                
      F3=-(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))                     
      F3D=-CX**3*(2.0*C02+CX*(6.0*C03+CX*(12.0*C04+CX*(20.0*C05+CX*(30.0        
     1    *C06+CX*(42.0*C07+CX*(56.0*C08+CX*(72.0*C09+CX*(90.0*C010+CX*         
     2    110.0*C011)))))))))+C012*CX**2-(CX**3*(2.0*C12+CX*(6.0*C13+CX*        
     3    (12.0*C14+CX*(20.0*C15+CX*30.0*C16))))-C17*CX**2)*SX-(CX**3*(         
     4    2.0*C22+CX*(6.0*C23+CX*(12.0*C24+CX*(20.0*C25+CX*(30.0*C26+CX*        
     5    42.0*C27)))))-C28*CX**2)*SX**2-(CX**3*(2.0*C32+CX*(6.0*C33+CX*        
     6    (12.0*C34+CX*(20.0*C35+CX*(30.0*C36+CX*(42.0*C37+CX*(56.0*C38+        
     7    CX*72.0*C39)))))))-C310*CX**2)*SX**3-30.0*C41*CX**7*SIT**(-23)        
     8    *SX-30.0*CH0**4*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64        
     9    ))))                                                                  
      F4=F3-BET+Y**3*CX**2*(D31+CX*(2.0*D32+CX*(3.0*D33+CX*4.0*D34)))           
     1   +Y**4*CX**2*(D41+CX*(2.0*D42+CX*(3.0*D43+CX*4.0*D44)))-Y**32*(         
     2   D51+2.0*D52*CH0)                                                       
      F4D=F3D-Y**3*CX**3*(2.0*D31+CX*(6.0*D32+CX*(12.0*D33+CX*20.0*D34))        
     1    )-Y**4*CX**3*(2.0*D41+CX*(6.0*D42+CX*(12.0*D43+CX*20.0*D44)))         
     2    -Y**32*2.0*D52                                                        
      CHI=CH0-F4/F4D                                                            
      IF (DABS(CH0/CHI-1.0).LE.1.0D-07) GO TO 2                                 
      N=N+1                                                                     
      IF(N.EQ.50) WRITE(6,10) N,CH0,CHI                                         
   10 FORMAT(10X,'SUB4',I5,2E20.7)                                              
      IF (N.GE.50) GO TO 2                                                      
      CH0=CHI                                                                   
      GO TO 1                                                                   
    2 CONTINUE                                                                  
      CX=1.0/CHI                                                                
      PSIC=C00+C01*CHI+CX*(C02+CX*(C03+CX*(C04+CX*(C05+CX*(C06+CX*(C07+         
     1     CX*(C08+CX*(C09+CX*(C010+CX*C011)))))))))+C012*DLOG(CHI)+(C11        
     2     *CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))+C17*DLOG(CHI)        
     3     )*SX+(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27)        
     4     ))))+C28*DLOG(CHI))*SX**2+(C31*CHI+CX*(C32+CX*(C33+CX*(C34+CX        
     5     *(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI))*         
     6     SX**3+(C40+C41*CHI**(-5))*SIT**(-23)*SX+C50*SIT*DLOG(SIT)+CHI        
     7     **6*SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))+SX*           
     8     (C70+SX*(C71+SX*(C72+SX*(C73+SX*(C74+SX*(C75+SX*(C76+SX*(C77+        
     9     SX*C78))))))))                                                       
      SIG3=-(C11*CHI+CX*(C12+CX*(C13+CX*(C14+CX*(C15+CX*C16))))                 
     1     +C17*DLOG(CHI)+C50)-2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(        
     2     C25+CX*(C26+CX*C27)))))+C28*DLOG(CHI))*SX-3.0*(C31*CHI+CX*           
     3     (C32+CX*(C33+CX*(C34+CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)         
     4     ))))))+C310*DLOG(CHI))*SX**2+(C40+C41*CHI**(-5))*(22.0*SIT**         
     5     (-23)-23.0*SIT**(-24))-C50*DLOG(SIT)+CHI**6*SX1**3*(2.0*C60+         
     6     SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*6.0*C64))))-C70-          
     7     SX*(2.0*C71+SX*(3.0*C72+SX*(4.0*C73+SX*(5.0*C74+SX*(6.0*C75+         
     8     SX*(7.0*C76+SX*(8.0*C77+SX*9.0*C78)))))))                            
      BET3=F3                                                                   
      EPS3=PSIC+SIT*SIG3+CHI*BET3                                               
      PSICD1=2.0*(C21*CHI+CX*(C22+CX*(C23+CX*(C24+CX*(C25+CX*(C26+CX*C27        
     1       )))))+C28*DLOG(CHI))+6.0*(C31*CHI+CX*(C32+CX*(C33+CX*(C34+         
     2       CX*(C35+CX*(C36+CX*(C37+CX*(C38+CX*C39)))))))+C310*DLOG(CHI        
     3       ))*SX+(C40+C41*CHI**(-5))*(506.0*SIT-552.0)*SIT**(-25)+C50*        
     4       SX1+CHI**6*SX1**4*(6.0*C60+SX1*(12.0*C61+SX1*(20.0*C62+SX1*        
     5       (30.0*C63+SX1*42.0*C64))))+2.0*C71+SX*(6.0*C72+SX*(12.0*C73        
     6       +SX*(20.0*C74+SX*(30.0*C75+SX*(42.0*C76+SX*(56.0*C77+SX*72.        
     7       0*C78))))))                                                        
      PSICD2=C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*C14+CX*(4.0*C15+CX*5.0*         
     1       C16))))+C17*CX+2.0*(C21-CX**2*(C22+CX*(2.0*C23+CX*(3.0*C24         
     2       +CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))+C28*CX)*SX+3.0*(          
     3       C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(4.0*C35+CX*(5.0*        
     4       C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))+C310*CX)*SX**        
     5       2-5.0*C41*CHI**(-6)*(23.0-22.0*SIT)*SIT**(-24)-6.0*CHI**5*         
     6       SX1**3*(2.0*C60+SX1*(3.0*C61+SX1*(4.0*C62+SX1*(5.0*C63+SX1*        
     7       6.0*C64))))                                                        
      PSICD3=-F3D                                                               
      FAV3=-SIT*PSICD1                                                          
      FAI3=FAV3+SIT*PSICD2**2/PSICD3                                            
      PSID=Y**3*(D30+CX*(D31+CX*(D32+CX*(D33+CX*D34))))+Y**4*(D40+CX*(          
     1     D41+CX*(D42+CX*(D43+CX*D44))))+Y**32*(D50+CHI*(D51+CHI*D52))         
      SIG4=SIG3+(3.0*Y**2*(D30+CX*(D31+CX*(D32+CX*(D33+CX*D34))))+4.0*          
     1     Y**3*(D40+CX*(D41+CX*(D42+CX*(D43+CX*D44))))+32.0*Y**31*(D50+        
     2     CHI*(D51+CHI*D52)))/SX2                                              
      EPS4=EPS3+PSID+(SIG4-SIG3)*SIT+(BET-BET3)*CHI                             
      IF(IZV.EQ.0)RETURN                                                        
      FAV4=SIT*(-PSICD1-1.0/SX2**2*(6.0*Y*(D30+CX*(D31+CX*(D32+CX*(D33+         
     1     CX*D34))))+12.0*Y**2*(D40+CX*(D41+CX*(D42+CX*(D43+CX*D44))))+        
     2     992.0*Y**30*(D50+CHI*(D51+CHI*D52))))                                
      FAI4=FAV4+SIT*(PSICD2+1.0/SX2*(3.0*Y**2*CX**2*(D31+CX*(2.0*D32+CX*        
     1     (3.0*D33+CX*4.0*D34)))+4.0*Y**3*CX**2*(D41+CX*(2.0*D42+CX*(          
     2     3.0*D43+CX*4.0*D44)))                                                
     A     -32.*Y**31*(D51+2.0*D52*CHI)                                         
     B                          ))**2/(PSICD3+Y**3*CX**3*(2.0*D31+CX*(6.        
     3     *D32+CX*(12.0*D33+CX*20.0*D34)))+Y**4*CX**3*(2.0*D41+CX*(6.0         
     4     *D42+CX*(12.0*D43+CX*20.0*D44)))+Y**32*2.0*D52)                      
      CHISQ=CHI*CHI                                                             
      RHRHO4=CHISQ*SIT*(-PSICD1*PSICD3/PSICD2+PSICD2)                           
      RCC4=CHISQ*(PSICD3-PSICD2*PSICD2/PSICD1)                                  
      RKAP4=1./CHI/PSICD3                                                       
      RBETHA=-RKAP4*PSICD2                                                      
      RGAM4=FAI4/FAV4                                                           
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      SUBROUTINE VISCON(P,T,SPVOL,VIS,TCON,NREGON,NSTWAT)                       
C                                                                               
C     VISCOSITY AND THERMAL CONDUCTIVITY OF STEAM AND WATER                     
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION K1,K2,K3,K4,K5,K6,K7,K8,K9                               
C                                                                               
      K1=-7.691234564D+00                                                       
      K2=-2.608023696D+01                                                       
      K3=-1.681706546D+02                                                       
      K4=6.423285504D+01                                                        
      K5=-1.189646225D+02                                                       
      K6=4.167117320D+00                                                        
      K7=2.097506760D+01                                                        
      K8=1.0D+09                                                                
      K9=6.0D+00                                                                
      S=1.0-(T+273.15)/647.3                                                    
      BEKB=DEXP(S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))/((T+273.15)/647.3*(1.0+        
     1     K6*S+K7*S*S))-S/(K8*S*S+K9))*221.2                                   
      TT=273.16                                                                 
      TC=647.30                                                                 
      P2=1000.0                                                                 
      TK=T+273.15                                                               
      PB=0.980665*P                                                             
      DENS=0.001/SPVOL                                                          
      IF (((NREGON.EQ.1.AND.PB.EQ.BEKB).OR.(NREGON.EQ.4.AND.PB.EQ.BEKB))        
     1   .AND.(T.GE.0.0.AND.T.LE.300.0)) GO TO 1                                
      IF (((NREGON.EQ.1.AND.NSTWAT.EQ.2).OR.(NREGON.EQ.4.AND.NSTWAT.EQ.2        
     1   )).AND.(T.GE.0.0.AND.T.LE.300.0)) GO TO 1                              
      IF ((T.GE.0.0.AND.T.LE.300.0).AND.(PB.GE.BEKB.AND.PB.LE.800.0).AND        
     1   .(NREGON.EQ.1.OR.NREGON.EQ.4)) GO TO 2                                 
      IF ((T.GE.100.0.AND.T.LE.700.0).AND.(P .EQ.1.0)) GO TO 3                  
      IF (((NREGON.EQ.2.AND.PB.EQ.BEKB).OR.(NREGON.EQ.3.AND.PB.EQ.BEKB))        
     1   .AND.(T.GE.100.0.AND.T.LE.300.0)) GO TO 4                              
      IF (((NREGON.EQ.2.AND.NSTWAT.EQ.1).OR.(NREGON.EQ.3.AND.NSTWAT.EQ.1        
     1   )).AND.(T.GE.100.0.AND.T.LE.300.0)) GO TO 4                            
      IF ((T.GE.100.0.AND.T.LE.300.0).AND.(PB.GE.1.0.AND.PB.LE.BEKB))           
     1   GO TO 4                                                                
      IF ((T.GE.375.0.AND.T.LE.700.0).AND.(PB.GE.1.0.AND.PB.LE.800.0))          
     1   GO TO 5                                                                
      VIS=0.0                                                                   
      GO TO 6                                                                   
    1 VIS=241.4*10.0**(247.8*(1.0/(TK-140.0)))                                  
      GO TO 6                                                                   
    2 VIS=241.4*10.0**(247.8*(1.0/(TK-140.0)))*(1.0+(PB-BEKB)*1.046             
     1    *1.0E-6*(TK-305.0))                                                   
      GO TO 6                                                                   
    3 VIS=0.407*T+80.4                                                          
      GO TO 6                                                                   
    4 VIS=0.407*T+80.4-DENS*(1858.0-5.90*T)                                     
      GO TO 6                                                                   
    5 VIS=0.407*T+80.4+DENS*(353.0+DENS*(676.5+DENS*102.1))                     
    6 IF (((NREGON.EQ.1.AND.PB.EQ.BEKB).OR.(NREGON.EQ.4.AND.PB.EQ.BEKB))        
     1   .AND.(T.GE.0.0.AND.T.LE.350.0)) GO TO 7                                
      IF (((NREGON.EQ.1.AND.NSTWAT.EQ.2).OR.(NREGON.EQ.4.AND.NSTWAT.EQ.2        
     1   )).AND.(T.GE.0.0.AND.T.LE.350.0)) GO TO 7                              
      IF ((NREGON.EQ.1.OR.NREGON.EQ.4).AND.((T.GE.0.0.AND.T.LE.350.0)           
     1   .AND.(PB.GE.BEKB.AND.PB.LE.500.0))) GO TO 7                            
      IF ((T.GE.100.0.AND.T.LE.700.0).AND.(P .EQ.1.0)) GO TO 8                  
      IF (PB.LE.175.) TS=BETKP(PB/221.2)                                        
      IF ((T.GE.TS.AND.T.LE.700.0).AND.(PB.GT.1.0.AND.PB.LE.175.0))             
     1   GO TO 9                                                                
      IF ((T.GE.400.0.AND.T.LE.700.0).AND.(PB.GT.175.0.AND.PB.LE.225.0))        
     1   GO TO 9                                                                
      IF ((T.GE.425.0.AND.T.LE.700.0).AND.(PB.GT.225.0.AND.PB.LE.275.0))        
     1   GO TO 9                                                                
      IF ((T.GE.450.0.AND.T.LE.700.0).AND.(PB.GT.275.0.AND.PB.LE.350.0))        
     1   GO TO 9                                                                
      IF ((T.GE.500.0.AND.T.LE.700.0).AND.(PB.GT.350.0.AND.PB.LE.450.0))        
     1   GO TO 9                                                                
      IF ((T.GE.550.0.AND.T.LE.700.0).AND.(PB.GT.450.0.AND.PB.LE.500.0))        
     1   GO TO 9                                                                
      TCON=0.                                                                   
      GO TO 10                                                                  
    7 TX=TK/273.15                                                              
      TCON=-922.47+TX*(2839.5+TX*(-1800.7+TX*(525.77-TX*73.440)))+(PB-          
     1     BEKB)*(-0.94730+TX*(2.5186+TX*(-2.0012+TX*0.51536)))+(PB-BEKB        
     2     )**2*(1.6563E-3+TX*(-3.8929E-3+TX*(2.9323E-3-TX*7.1693E-4)))         
      GO TO 10                                                                  
    8 TCON=17.6+T*(5.87E-2+T*(1.04E-4-T*4.51E-8))                               
      GO TO 10                                                                  
    9 DENS=0.001/SPVOL                                                          
      TCON=17.6+T*(5.87E-2+T*(1.04E-4-T*4.51E-8))+DENS*(103.51+T*(0.4198        
     1     -T*2.771E-5)+DENS*2.1482E14/T**4.2)                                  
   10 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BETK(SIT)                                       
C                                                                               
C     REDUCED PRESSURE OF SATURATED STEAM AND WATER AS A FUNCTION OF RED        
C                                                                               
C     TEMPERATURE                                                               
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION K1,K2,K3,K4,K5,K6,K7,K8,K9                               
C                                                                               
      K1=-7.691234564D+00                                                       
      K2=-2.608023696D+01                                                       
      K3=-1.681706546D+02                                                       
      K4=6.423285504D+01                                                        
      K5=-1.189646225D+02                                                       
      K6=4.167117320D+00                                                        
      K7=2.097506760D+01                                                        
      K8=1.0D+09                                                                
      K9=6.0D+00                                                                
      S=1.0-SIT                                                                 
      X=S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))/(SIT*(1.0+K6*S+K7*S*S))-S/(K8*S        
     1  *S+K9)                                                                  
      BETK=DEXP(X)                                                              
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BETKP(BET)                                      
C                                                                               
C     REDUCED TEMPERATURE OF SATURATED STEAM AND WATER AS A FUNCTION OF         
C                                                                               
C     PRESSURE                                                                  
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION K1,K2,K3,K4,K5,K6,K7,K8,K9                               
C                                                                               
      K1=-7.691234564D+00                                                       
      K2=-2.608023696D+01                                                       
      K3=-1.681706546D+02                                                       
      K4=6.423285504D+01                                                        
      K5=-1.189646225D+02                                                       
      K6=4.167117320D+00                                                        
      K7=2.097506760D+01                                                        
      K8=1.0D+09                                                                
      K9=6.0D+00                                                                
      N=0                                                                       
      X0=(TSATA(BET*221.2/0.980665)+273.15)/647.3                               
    1 S=1.0-X0                                                                  
      F=DEXP(S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))/(X0*(1.0+K6*S+K7*S*S))            
     1  -S/(K8*S*S+K9))-BET                                                     
      FD=(((-K1-S*(2.0*K2+S*(3.0*K3+S*(4.0*K4+S*5.0*K5))))*X0*(1.0+K6*S         
     1   +K7*S*S)-S*(K1+S*(K2+S*(K3+S*(K4+S*K5))))*(1.0+K6*(1.0-2.0*X0)         
     2   +K7*S*(1.0-3.0*X0)))/(X0*(1.0+K6*S+K7*S*S))**2-(K8*S*S-K9)/            
     3   (K8*S*S+K9)**2)*(F+BET)                                                
      BETKP=X0-F/FD                                                             
      IF (DABS(X0/BETKP-1.0).LE.1.0D-07) GO TO 2                                
      N=N+1                                                                     
      IF (N.GE.50) GO TO 2                                                      
      X0=BETKP                                                                  
      GO TO 1                                                                   
    2 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BET3(SIT,CH0)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C012=-4.311577033D+00                                                     
      C11=7.086360850D-01                                                       
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
    1 CX=1.0/CH0                                                                
      BET3=                                                                     
     O   -(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))                     
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION BET4(SIT,CH0)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      C00=-6.839900000D+00                                                      
      C01=-1.722604200D-02                                                      
      C02=-7.771750390D+00                                                      
      C03=4.204607520D+00                                                       
      C04=-2.768070380D+00                                                      
      C05=2.104197070D+00                                                       
      C06=-1.146495880D+00                                                      
      C07=2.231380850D-01                                                       
      C08=1.162503630D-01                                                       
      C09=-8.209005440D-02                                                      
      C010=1.941292390D-02                                                      
      C011=-1.694705760D-03                                                     
      C11=7.086360850D-01                                                       
      C012=-4.311577033D+00                                                     
      C12=1.236794550D+01                                                       
      C13=-1.203890040D+01                                                      
      C14=5.404374220D+00                                                       
      C15=-9.938650430D-01                                                      
      C16=6.275231820D-02                                                       
      C17=-7.747430160D+00                                                      
      C21=-4.298850920D+00                                                      
      C22=4.314305380D+01                                                       
      C23=-1.416193130D+01                                                      
      C24=4.041724590D+00                                                       
      C25=1.555463260D+00                                                       
      C26=-1.665689350D+00                                                      
      C27=3.248811580D-01                                                       
      C28=2.936553250D+01                                                       
      C31=7.948418420D-06                                                       
      C32=8.088597470D+01                                                       
      C33=-8.361533800D+01                                                      
      C34=3.586365170D+01                                                       
      C35=7.518959540D+00                                                       
      C36=-1.261606400D+01                                                      
      C37=1.097174620D+00                                                       
      C38=2.121454920D+00                                                       
      C39=-5.465295660D-01                                                      
      C310=8.328754130D+00                                                      
      C40=2.759717760D-06                                                       
      C41=-5.090739850D-04                                                      
      C50=2.106363320D+02                                                       
      C60=5.528935335D-02                                                       
      C61=-2.336365955D-01                                                      
      C62=3.697071420D-01                                                       
      C63=-2.596415470D-01                                                      
      C64=6.828087013D-02                                                       
      C70=-2.571600553D+02                                                      
      C71=-1.518783715D+02                                                      
      C72=2.220723208D+01                                                       
      C73=-1.802039570D+02                                                      
      C74=2.357096220D+03                                                       
      C75=-1.462335698D+04                                                      
      C76=4.542916630D+04                                                       
      C77=-7.053556432D+04                                                      
      C78=4.381571428D+04                                                       
      D30=-1.717616747D+00                                                      
      D31=3.526389875D+00                                                       
      D32=-2.690899373D+00                                                      
      D33=9.070982605D-01                                                       
      D34=-1.138791156D-01                                                      
      D40=1.301023613D+00                                                       
      D41=-2.642777743D+00                                                      
      D42=1.996765362D+00                                                       
      D43=-6.661557013D-01                                                      
      D44=8.270860589D-02                                                       
      D50=3.426663535D-04                                                       
      D51=-1.236521258D-03                                                      
      D52=1.155018309D-03                                                       
      SIT1=9.626911787D-01                                                      
      SX=SIT-1.0                                                                
      SX1=1.0/SIT                                                               
      SX2=1.0-SIT1                                                              
      Y=(1.0-SIT)/(1.0-SIT1)                                                    
    1 CX=1.0/CH0                                                                
      F3=-(C01-CX**2*(C02+CX*(2.0*C03+CX*(3.0*C04+CX*(4.0*C05+CX*(5.0*          
     1   C06+CX*(6.0*C07+CX*(7.0*C08+CX*(8.0*C09+CX*(9.0*C010+CX*10.0*          
     2   C011)))))))))+C012*CX)-(C11-CX**2*(C12+CX*(2.0*C13+CX*(3.0*            
     3   C14+CX*(4.0*C15+CX*5.0*C16))))+C17*CX)*SX-(C21-CX**2*(C22+CX*          
     4   (2.0*C23+CX*(3.0*C24+CX*(4.0*C25+CX*(5.0*C26+CX*6.0*C27)))))           
     5   +C28*CX)*SX**2-(C31-CX**2*(C32+CX*(2.0*C33+CX*(3.0*C34+CX*(            
     6   4.0*C35+CX*(5.0*C36+CX*(6.0*C37+CX*(7.0*C38+CX*8.0*C39)))))))          
     7   +C310*CX)*SX**3+5.0*C41*CH0**(-6)*SIT**(-23)*SX-6.0*CH0**5*            
     8   SX1**2*(C60+SX1*(C61+SX1*(C62+SX1*(C63+SX1*C64))))                     
      BET4=  F3+Y**3*CX**2*(D31+CX*(2.0*D32+CX*(3.0*D33+CX*4.0*D34)))           
     1   +Y**4*CX**2*(D41+CX*(2.0*D42+CX*(3.0*D43+CX*4.0*D44)))-Y**32*(         
     2   D51+2.0*D52*CH0)                                                       
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION CHI2(SIT,BET)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DIMENSION B(8,3),BS(8,2)                                                  
C                                                                               
      B90=1.936587558D+02                                                       
      B91=-1.388522425D+03                                                      
      B92=4.126607219D+03                                                       
      B93=-6.508211677D+03                                                      
      B94=5.745984054D+03                                                       
      B95=-2.693088365D+03                                                      
      B96=5.235718623D+02                                                       
      BB=7.633333333D-01                                                        
      B(1,1)=6.670375918D-02                                                    
      B(1,2)=1.388983801D+00                                                    
      B(1,3)=0.                                                                 
      B(2,1)=8.390104328D-02                                                    
      B(2,2)=2.614670893D-02                                                    
      B(2,3)=-3.373439453D-02                                                   
      B(3,1)=4.520918904D-01                                                    
      B(3,2)=1.069036614D-01                                                    
      B(3,3)=0.                                                                 
      B(4,1)=-5.975336707D-01                                                   
      B(4,2)=-8.847535804D-02                                                   
      B(4,3)=0.                                                                 
      B(5,1)=5.958051609D-01                                                    
      B(5,2)=-5.159303373D-01                                                   
      B(5,3)=2.075021122D-01                                                    
      B(6,1)=1.190610271D-01                                                    
      B(6,2)=-9.867174132D-02                                                   
      B(6,3)=0.                                                                 
      B(7,1)=1.683998803D-01                                                    
      B(7,2)=-5.809438001D-02                                                   
      B(7,3)=0.                                                                 
      B(8,1)=6.552390126D-03                                                    
      B(8,2)=5.710218649D-04                                                    
      B(8,3)=0.                                                                 
      BS(1,1)=0.                                                                
      BS(1,2)=0.                                                                
      BS(2,1)=0.                                                                
      BS(2,2)=0.                                                                
      BS(3,1)=0.                                                                
      BS(3,2)=0.                                                                
      BS(4,1)=0.                                                                
      BS(4,2)=0.                                                                
      BS(5,1)=0.                                                                
      BS(5,2)=0.                                                                
      BS(6,1)=4.006073948D-01                                                   
      BS(6,2)=0.                                                                
      BS(7,1)=8.636081627D-02                                                   
      BS(7,2)=0.                                                                
      BS(8,1)=-8.532322921D-01                                                  
      BS(8,2)=3.460208861D-01                                                   
      TC1=647.3                                                                 
      PC1=22120000.0                                                            
      VC1=0.00317                                                               
      R1=461.51                                                                 
      AI1=R1*TC1/(PC1*VC1)                                                      
      X=DEXP(BB*(1.0-SIT))                                                      
      CALL SUBBET(SIT,BETL,BETLD,BETLDD)                                        
      S03=0.0                                                                   
      S04=0.0                                                                   
      DO 4 I=1,8                                                                
      BX=0.0                                                                    
      NNI=NN(I)                                                                 
      NLI=NL(I)                                                                 
      DO 2 J=1,NNI                                                              
      SBX=0.0                                                                   
      NZIJ=NZ(I,J)                                                              
      DO 1 K=1,NLI                                                              
      NXIK=NX(I,K)                                                              
      SBX=SBX+BS(I,K)*X**NXIK                                                   
    1 CONTINUE                                                                  
      BX=BX+B(I,J)*X**NZIJ                                                      
    2 CONTINUE                                                                  
      IF (I.GE.6) GO TO 3                                                       
      S03=S03+FLOAT(I)*BET**(I-1)*BX                                            
      GO TO 4                                                                   
    3 CONTINUE                                                                  
      S04=S04+FLOAT(I-2)*BET**(1-I)*BX/(BET**(2-I)+SBX)**2                      
    4 CONTINUE                                                                  
      CHI2=AI1*SIT/BET-S03-S04+11.0*(BET/BETL)**10*(B90+X*(B91+X*(B92+X*        
     1     (B93+X*(B94+X*(B95+X*B96))))))                                       
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION CHI3(SIT,BET)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
      DOUBLE PRECISION L0,L1,L2                                                 
C                                                                               
      L0=15.74373327                                                            
      L1=-34.17061978                                                           
      L2=19.31380707                                                            
      SIT1=0.9626911787                                                         
      BET1=0.7475191707                                                         
      BET2=4.52079566                                                           
      BTK=BETK(SIT)                                                             
      L0=L0-BET                                                                 
      IF ((BET.GT.BET1.AND.BET.LE.1.0).OR.(SIT.GT.SIT1.AND.SIT.LE.1.0))         
     1  GO TO 1                                                                 
      IF (BET.GT.1.0.AND.SIT.GT.SIT1) GO TO 2                                   
    1 CH0=CHI2(SIT,BET)                                                         
      GO TO 6                                                                   
    2 CH0=0.001368/0.00317                                                      
      SITL=(-L1+DSQRT(L1**2-4.0*L0*L2))/(2.0*L2)                                
    3 CH2=CHI2(SITL,BET)                                                        
      IF (CH2.GT.0.) GO TO 4                                                    
      SITL=SITL+0.1                                                             
      GO TO 3                                                                   
    4 BET0=BET3(SIT,CH0)-BET                                                    
    5 CH1=CH0+0.0001/0.00317                                                    
      BET1=BET3(SIT,CH1)-BET                                                    
      IF (BET0*BET1.LE.0.) GO TO 6                                              
      IF (CH1.GE.CH2) GO TO 6                                                   
C                                                                               
      CH0=CH1                                                                   
      BET0=BET1                                                                 
      GO TO 5                                                                   
    6 CHI3=CH0                                                                  
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      DOUBLE PRECISION FUNCTION CHI4(SIT,BET)                                   
C                                                                               
      IMPLICIT REAL*8 (A-H,O-Z)                                                 
C                                                                               
      SIT1=0.96269117                                                           
      CH0=0.001318/0.00317                                                      
      CH2=0.002448/0.00317                                                      
      BET0=BET4(SIT,CH0)-BET                                                    
    1 CH1=CH0+0.0001/0.00317                                                    
      BET1=BET4(SIT,CH1)-BET                                                    
      IF (BET0*BET1.LT.0.) GO TO 2                                              
      IF (CH1.GT.CH2) GO TO 2                                                   
C                                                                               
      CH0=CH1                                                                   
      BET0=BET1                                                                 
      GO TO 1                                                                   
    2 CHI4=CH0                                                                  
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NL(I)                                                            
C                                                                               
      NL=0                                                                      
      IF (I.EQ.6.OR.I.EQ.7) NL=1                                                
      IF (I.EQ.8) NL=2                                                          
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NN(I)                                                            
C                                                                               
      NN=2                                                                      
      IF (I.EQ.2.OR.I.EQ.5) NN=3                                                
      RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NX(I,K)                                                          
C                                                                               
      NX=0                                                                      
      IF (K-1) 1,1,2                                                            
    1 IF (I.EQ.6) NX=14                                                         
      IF (I.EQ.7) NX=19                                                         
      IF (I.EQ.8) NX=54                                                         
      GO TO 3                                                                   
    2 IF (I.EQ.8) NX=27                                                         
    3 RETURN                                                                    
      END                                                                       
C*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*        
C                                                                               
      FUNCTION NZ(I,J)                                                          
C                                                                               
      NZ=0                                                                      
      IF (J-2) 1,2,3                                                            
    1 IF (I.EQ.1) NZ=13                                                         
      IF (I.EQ.2.OR.I.EQ.3) NZ=18                                               
      IF (I.EQ.4) NZ=25                                                         
      IF (I.EQ.5) NZ=32                                                         
      IF (I.EQ.6) NZ=12                                                         
      IF (I.EQ.7.OR.I.EQ.8) NZ=24                                               
      GO TO 4                                                                   
    2 IF (I.EQ.1) NZ=3                                                          
      IF (I.EQ.2) NZ=2                                                          
      IF (I.EQ.3) NZ=10                                                         
      IF (I.EQ.4.OR.I.EQ.8) NZ=14                                               
      IF (I.EQ.5) NZ=28                                                         
      IF (I.EQ.6) NZ=11                                                         
      IF (I.EQ.7) NZ=18                                                         
      GO TO 4                                                                   
    3 IF (I.EQ.2) NZ=1                                                          
      IF (I.EQ.5) NZ=24                                                         
    4 RETURN                                                                    
      END                                                                       
THCL.f/         929015382   0     0     100666  1480      `
C*DK THCL                                                               
      FUNCTION THCL( H )                                                
      IMPLICIT REAL*8(A-H,O-Z)                                          
C                                                                       
C                                                                       
C   THERMAL CONDUCTIVITY OF WATER AS FUNCTION OF PRESSURE AND ENTHALPY  
C        ENTHALPY  H          IN (J/KG)                                 
C        THERMAL CONDUCTIVITY IN (W/M K)                                
C              REQUIRES POLY                                            
C                                                                       
      DIMENSION A(4)                                                    
      DATA  A/5.73738622D-01,2.536103551D-01,-1.45468269D-01,           
     *      1.387472485D-02/, HO/5.815D05/                              
      POLY3(A1,A2,A3,A4,X) = A1+X*(A2+X*(A3+X*A4))                      
C                                                                       
      XI   = H/HO                                                       
      THCL = POLY3(A(1),A(2),A(3),A(4),XI)                              
C                                                                       
      RETURN                                                            
      END                                                               
THCV.f/         929015382   0     0     100666  2886      `
C*DK THCV                                                               
      FUNCTION THCV( H, P, ROV, TV, PA )                                
      IMPLICIT REAL*8(A-H,O-Z)                                          
C*CA CONTRLLR                                                           
C*CC CONTRLLR                                                           
      INCLUDE 'CONTRLLR'                                                
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
      EQUIVALENCE (THAX,CEOSLP(13))                                     
C                                                                       
C   THERMAL CONDUCTIVITY OF STEAM AS FUNCTION OF PRESSURE AND ENTHALPY  
C        PRESSURE  P          IN (N/SQ.M)                               
C        ENTHALPY  H          IN (J/KG)                                 
C        DENSITY      ROV        IN (KG/CU.M)                           
C        TEMPERATURE  TV         IN (K)                                 
C        THERMAL CONDUCTIVITY IN (W/M K)                                
C              REQUIRES POLY                                            
C                                                                       
      DIMENSION A(4) ,B(3)                                              
      DATA A/1.76D-2, 5.87D-5, 1.04D-7, -4.51D-11/, B/1.0351D-4,        
     *     .4198D-6, -2.771D-11/, C/2.1482D5/                           
      POLY2(A1,A2,A3,X) = A1+X*(A2+X*A3)                                
      POLY3(A1,A2,A3,A4,X) = A1+X*(A2+X*(A3+X*A4))                      
C                                                                       
      IF( IEOS.NE.0 ) GO TO 5                                           
      TDIFF = DMAX1(0.1D0,TV-CEOSLP(34))                                
      THCV  = DMAX1(0.0001D0,POLY3(A(1),A(2),A(3),A(4),TDIFF)+ROV*      
     1        (POLY2(B(1),B(2),B(3),TDIFF)+ROV*C*EXP(-4.2D0*            
     2        DLOG(TDIFF))))                                            
      IF( PA.LT.1.D0 ) GO TO 10                                         
      THCV = ((P-PA)*THCV+PA*THAX)/P                                    
   10 CONTINUE                                                          
      RETURN                                                            
    5 THCV = THAX                                                       
      RETURN                                                            
      END                                                               
crc@PROCESS XOPT(NOAMOVE) OPT(2)                                        
THERMO.f/       929015382   0     0     100666  30587     `
C*DK THERMO                                                             
      SUBROUTINE THERMO                                                 
     1  ( P      ,EL     ,EV     ,TL     ,TV     ,TSAT   ,ROL    ,      
     2    ROV    ,PA     ,ROVA   ,TSSN   ,EVA    ,DR     ,IOP    ,      
     3    JSTART ,NCELLS  )                                             
      IMPLICIT REAL*8(A-H,O-Z)                                          
      DIMENSION P(1)    ,EL(1)   ,EV(1)   ,TL(1)   ,TV(1)   ,TSAT(1) ,  
     1          ROL(1)  ,ROV(1)  ,PA(1)   ,ROVA(1) ,TSSN(1) ,EVA(1)  ,  
     2          DR(1)                                                   
C                                                                       
C                                                                       
C     THERMODYNAMIC PROPERTIES OF WATER                                 
C                                                                       
C     INPUT VARIABLES                                                   
C        1. P      PRESSURE                                             
C        2. TL     LIQUID TEMPERATURE                                   
C        3. TV     VAPOR TEMPERATURE                                    
C        4. PA     PARTIAL PRESSURE OF THE NONCONDENSIBLE               
C        5. IOP    OPTION SELECTOR - NOT IN PRESENT VERSION             
C                                                                       
C     OUTPUT VARIABLES                                                  
C        1. EL     LIQUID INTERNAL ENERGY                               
C        2. EV     VAPOR (STEAM AND NONCONDENSABLE MIXTURE) INTERNAL    
C                  ENERGY                                               
C        3. TSAT   SATURATION TEMPERATURE CORRESPONDING TO THE TOTAL    
C                  PRESSURE                                             
C        4. ROL    LIQUID DENSITY                                       
C        5. ROV    VAPOR (STEAM AND NONCONDENSABLE MIXTURE) DENSITY     
C        6. ROVA   DENSITY OF THE NONCONDENSABLE                        
C        7. TSSN   SATURATION TEMPERATURE CORRESPONDING TO THE STEAM    
C                  PARTIAL PRESSURE                                     
C        8. EVA    INTERNAL ENERGY OF THE NONCONDENSABLE                
C        9. DTSDP  DERIVATIVE OF TSAT WRT PRESSURE                      
C       10. DELDP  DERIVATIVE OF EL WRT PRESSURE                        
C       11. DEVDP  DERIVATIVE OF STEAM INTERNAL ENERGY WRT STEAM        
C                  PARTIAL PRESSURE                                     
C       12. DELDT  DERIVATIVE OF EL WRT TL                              
C       13. DEVDT  DERIVATIVE OF STEAM INTERNAL ENERGY WRT TV           
C       14. DROLP  DERIVATIVE OF ROL WRT PRESSURE                       
C       15. DROVP  DERIVATIVE OF STEAM DENSITY WRT STEAM PARTIAL        
C                  PRESSURE                                             
C       16. DROLT  DERIVATIVE OF ROL WRT TL                             
C       17. DROVT  DERIVATIVE OF STEAM DENSITY WRT TV                   
C       18. HVST   SATURATED STEAM ENTHALPY (PSTEAM,TSSN)               
C       19. HLST   SATURATED LIQUID ENTHALPY (P,TSSN)                   
C       20. DHVSP  DERIVATIVE OF HVST WRT STEAM PARTIAL PRESSURE        
C       21. DHLSP  DERIVATIVE OF HLST WRT PRESSURE                      
C       22. DTSSP  DERIVATIVE OF TSSN WRT STEAM PARTIAL PRESSURE        
C       23. DEVAT  DERIVATIVE OF EVA WRT TV                             
C       24. DEVAP  DERIVATIVE OF EVA WRT PA                             
C       25. DRVAP  DERIVATIVE OF ROVA WRT PA                            
C       26. DRVAT  DERIVATIVE OF ROVA WRT TV                            
C                                                                       
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
C*CA CONTRLLR                                                           
C*CC CONTRLLR                                                           
      INCLUDE 'CONTRLLR'                                                
C*CA DIMNSION                                                           
C*CC DIMNSION                                                           
      INCLUDE 'DIMNSION'                                                
C*CA NMFAIL                                                             
C*CC NMFAIL                                                             
      INCLUDE 'NMFAIL'                                                  
C*CA FIXEDLT                                                            
C*CC FIXEDLT                                                            
C
CITJ+
C
CCC   INCLUDE 'FIXEDLT'                                                 
C
CITJ-
C
C*CA IOUNITS                                                            
C*CC IOUNITS                                                            
      INCLUDE 'IOUNITS'                                                 
C                                                                       
      DIMENSION ALE(8) ,BLE(8) ,CLE(8) ,DLE(8)                          
      DIMENSION AVE(11) ,BVE(11) ,CVE(11) ,DVE(11)                      
      DIMENSION AVG(11) ,BVG(11) ,CVG(11) ,DVG(11)                      
      DIMENSION ACP(10) ,BCP(10) ,CCP(10) ,DCP(10)                      
C                                                                       
C                                                                       
C                                                                       
C                                                                       
C     --------------------------PRELIMINARIES---------------------------
C                                                                       
C                                                                       
C                                                                       
C     DATA FOR RAW CONSTANTS USED IN FITS                               
C                                                                       
      DATA ALE(1)/-1.1436668993222D+06/,BLE(1)/ 4.1868000000000D+03/,   
     *     CLE(1)/ 0.D0               /,DLE(1)/ 0.D0               /    
      DATA ALE(2)/ 8.0957542810383D+06/,BLE(2)/-5.7008855264640D+04/,   
     *     CLE(2)/ 1.3443632119671D+02/,DLE(2)/-9.7879669155946D-02/    
      DATA ALE(3)/-1.9373932457007D+06/,BLE(3)/ 9.7492797103351D+03/,   
     *     CLE(3)/-1.3299615999876D+01/,DLE(3)/ 1.0879999999922D-02/    
      DATA ALE(4)/-5.3245827703670D+06/,BLE(4)/ 2.9179372045334D+04/,   
     *     CLE(4)/-5.0452192000967D+01/,DLE(4)/ 3.4560000000583D-02/    
      DATA ALE(5)/-6.3583523639930D+07/,BLE(5)/ 3.2873715263424D+05/,   
     *     CLE(5)/-5.6371182000208D+02/,DLE(5)/ 3.2760000000116D-01/    
      DATA ALE(6)/-6.6239163195929D+09/,BLE(6)/ 3.1605562257270D+07/,   
     *     CLE(6)/-5.0263730855532D+04/,DLE(6)/ 2.6650075114186D+01/    
      DATA ALE(7)/-5.4759091078157D+09/,BLE(7)/ 2.4635618770681D+07/,   
     *     CLE(7)/-3.6931079506707D+04/,DLE(7)/ 1.8454719393083D+01/    
      DATA ALE(8)/-7.1536399439453D+07/,BLE(8)/ 3.0560801674842D+05/,   
     *     CLE(8)/-4.2424553999630D+02/,DLE(8)/ 1.9719999999823D-01/    
      DATA AVE(1)/ 2.4949771766385D+06/,BVE(1)/ 2.0855856331827D-01/,   
     *     CVE(1)/-1.3553894579716D-07/,DVE(1)/ 2.8522684989198D-14/    
      DATA AVE(2)/ 2.5600870370371D+06/,BVE(2)/ 3.1086111111026D-02/,   
     *     CVE(2)/-6.8988888888580D-09/,DVE(2)/ 4.3203703703379D-16/    
      DATA AVE(3)/ 2.5915500000006D+06/,BVE(3)/ 8.7749999997567D-03/,   
     *     CVE(3)/-1.7499999999663D-09/,DVE(3)/ 4.2999999998503D-17/    
      DATA AVE(4)/ 2.6606000000024D+06/,BVE(4)/-1.3545000000581D-02/,   
     *     CVE(4)/ 6.4250000004682D-10/,DVE(4)/-4.2100000001248D-17/    
      DATA AVE(5)/ 3.8201600000097D+06/,BVE(5)/-2.3019900000170D-01/,   
     *     CVE(5)/ 1.4068900000098D-08/,DVE(5)/-3.1786000000187D-16/    
      DATA AVE(6)/-1.2103411633350D+08/,BVE(6)/ 1.8018803375785D+01/,   
     *     CVE(6)/-8.7442426507726D-07/,DVE(6)/ 1.4091076856088D-14/    
      DATA AVE(7)/ 2.2000000000000D+06/,BVE(7)/ 0.D0               /,   
     *     CVE(7)/ 0.D0               /,DVE(7)/ 0.D0               /    
      DATA AVE(8)/ 2.2000000000000D+06/,BVE(8)/ 0.D0               /,   
     *     CVE(8)/ 0.D0               /,DVE(8)/ 0.D0               /    
      DATA AVE(9)/ 2.2000000000000D+06/,BVE(9)/ 0.D0               /,   
     *     CVE(9)/ 0.D0               /,DVE(9)/ 0.D0               /    
      DATA AVE(10)/ 2.2000000000000D+06/,BVE(10)/ 0.D0               /, 
     *     CVE(10)/ 0.D0               /,DVE(10)/ 0.D0               /  
      DATA AVE(11)/ 2.2000000000000D+06/,BVE(11)/ 0.D0               /, 
     *     CVE(11)/ 0.D0               /,DVE(11)/ 0.D0               /  
      DATA AVG(1)/ 1.0666845123419D+00/,BVG(1)/ 2.8310838172462D-08/,   
     *     CVG(1)/-2.1151097428905D-14/,DVG(1)/ 4.7404001285964D-21/    
      DATA AVG(2)/ 1.0735412407407D+00/,BVG(2)/ 2.6518055555551D-09/,   
     *     CVG(2)/-6.3461111111128D-16/,DVG(2)/ 3.9824074074117D-23/    
      DATA AVG(3)/ 1.0777730000000D+00/,BVG(3)/-2.4300000008021D-11/,   
     *     CVG(3)/-7.1979999998378D-17/,DVG(3)/ 4.8799999990422D-25/    
      DATA AVG(4)/ 1.0851130000007D+00/,BVG(4)/-1.9307000001824D-09/,   
     *     CVG(4)/ 8.9100000014826D-17/,DVG(4)/-3.8960000003946D-24/    
      DATA AVG(5)/ 1.1639800000015D+00/,BVG(5)/-1.6338350000254D-08/,   
     *     CVG(5)/ 9.5856000001448D-16/,DVG(5)/-2.1194000000274D-23/    
      DATA AVG(6)/ 3.8898867259868D+00/,BVG(6)/-3.8595945559811D-07/,   
     *     CVG(6)/ 1.7476370114910D-14/,DVG(6)/-2.6377008249858D-22/    
      DATA AVG(7)/ 2.7168710524682D+00/,BVG(7)/-2.2832718294604D-07/,   
     *     CVG(7)/ 1.0417331983836D-14/,DVG(7)/-1.5842822199773D-22/    
      DATA AVG(8)/ 3.9749829999964D+00/,BVG(8)/-3.0657099999960D-07/,   
     *     CVG(8)/ 1.0637899999985D-14/,DVG(8)/-1.2257999999981D-22/    
      DATA AVG(9)/ 1.2946929999997D+00/,BVG(9)/-2.4834999999979D-08/,   
     *     CVG(9)/ 7.8979999999944D-16/,DVG(9)/-8.0799999999948D-24/    
      DATA AVG(10)/ 1.0590519999963D+00/,BVG(10)/-2.4615999996941D-09/, 
     *     CVG(10)/ 8.8399999991573D-17/,DVG(10)/-8.0799999992269D-25/  
      DATA AVG(11)/ 1.1430199999838D+00/,BVG(11)/-7.7095999988588D-09/, 
     *     CVG(11)/ 1.9335999997331D-16/,DVG(11)/-1.4639999997924D-24/  
      DATA ACP(1)/-7.9678485852270D+02/,BCP(1)/ 2.8187658437259D+01/,   
     *     CCP(1)/-1.0180624999920D-01/,DCP(1)/ 1.2499999999912D-04/    
      DATA ACP(2)/-9.7082632232795D+02/,BCP(2)/ 2.8324981030402D+01/,   
     *     CCP(2)/-9.7656200001157D-02/,DCP(2)/ 1.1600000000110D-04/    
      DATA ACP(3)/-1.6649701690752D+03/,BCP(3)/ 3.3159363169596D+01/,   
     *     CCP(3)/-1.0861179999898D-01/,DCP(3)/ 1.2399999999915D-04/    
      DATA ACP(4)/-6.1420486441088D+03/,BCP(4)/ 6.3630987079837D+01/,   
     *     CCP(4)/-1.7762319999965D-01/,DCP(4)/ 1.7599999999975D-04/    
      DATA ACP(5)/-8.2289951961933D+04/,BCP(5)/ 5.3773958896061D+02/,   
     *     CCP(5)/-1.1612491999609D+00/,DCP(5)/ 8.5599999997375D-04/    
      DATA ACP(6)/-6.5842104212475D+05/,BCP(6)/ 3.7934294783212D+03/,   
     *     CCP(6)/-7.2924928000022D+00/,DCP(6)/ 4.7040000000014D-03/    
      DATA ACP(7)/ 3.4561620732510D+05/,BCP(7)/-2.2129380791446D+02/,   
     *     CCP(7)/-2.4524285999925D+00/,DCP(7)/ 3.1479999999958D-03/    
      DATA ACP(8)/ 1.9798369474597D+06/,BCP(8)/-1.4782551342826D+04/,   
     *     CCP(8)/ 3.1656481897637D+01/,DCP(8)/-2.0843356864237D-02/    
      DATA ACP(9)/-9.6249385211359D+07/,BCP(9)/ 4.3633668884423D+05/,   
     *     CCP(9)/-6.5887615106930D+02/,DCP(9)/ 3.3146147264269D-01/    
      DATA ACP(10)/-1.1074934463333D+07/,BCP(10)/ 4.8073794630970D+04/, 
     *     CCP(10)/-6.9212173247881D+01/,DCP(10)/ 3.3091693999800D-02/  
      DATA C26/0.30D0/                                                  
      DATA CK0/-8.329595D-04/,CK2/-2.245825D-17/,CK4/-1.450382D-06/     
      DATA A11/ .10000887519691D-02/,A12/ .76916250454393D+03/          
      DATA A13/ .13001153775598D-02/                                    
      DATA A15/ .15448787270199D-02/                                    
      DATA DELC0/ 3.737452204297500D+03/                                
      DATA DELC1/ 7.868071497565012D+00/                                
      DATA DELC2/-4.511456897485311D-02/                                
      DATA DELC3/ 1.204554788927213D-04/                                
      DATA DELD0/-.81454700000000D+05/,DELD1/ .89319600000000D+03/      
      DATA DELD2/-.31234800000000D+01/,DELD3/ .37040880000000D-02/      
      DATA DELE0/-.26221567700000D+08/,DELE1/ .22589733400000D+06/      
      DATA DELE2/-.64870195500000D+03/,DELE3/ .62113375200000D+00/      
C                                                                       
C     DEFINITIONS OF COMBINATIONS OF CONSTANTS                          
C     (AS INITIALIZED IN DATA STATEMENTS ABOVE)                         
C                                                                       
C         A11=2.0*C26/(CEOSLP(16)*CEOSLP(12))=2.0/CEOSLP(23)            
C         A12=1.0/A13=CEOSLP(4)/2.0                                     
C         A13=A11*(1.0+C26)=2.0/CEOSLP(4)                               
C         AEOS14=1.0/C28                                                
C         C26=CEOSLP(16)-1.0                                            
C                                                                       
C                                                                       
C     -------------------------EXECUTION LOGIC--------------------------
C                                                                       
CAD +                                                                   
C
CITJ+ (11/13/98)
C
CCC   CALL STIMER( 10, 0, 0, 'THERMO' )                                 
C
CITJ- (11/13/98)
C
CAD -                                                                   
C                                                                       
      DO 300 J = JSTART, NCELLS                                         
         LDTSDP = NTHM*(J-1)+1                                          
         LDELDP = LDTSDP+1                                              
         LDEVDP = LDELDP+1                                              
         LDELDT = LDEVDP+1                                              
         LDEVDT = LDELDT+1                                              
         LDROLP = LDEVDT+1                                              
         LDROVP = LDROLP+1                                              
         LDROLT = LDROVP+1                                              
         LDROVT = LDROLT+1                                              
         LHVST  = LDROVT+1                                              
         LHLST  = LHVST+1                                               
         LDHVSP = LHLST+1                                               
         LDHLSP = LDHVSP+1                                              
         LDTSSP = LDHLSP+1                                              
         LDEVAT = LDTSSP+1                                              
         LDEVAP = LDEVAT+1                                              
         LDRVAP = LDEVAP+1                                              
         LDRVAT = LDRVAP+1                                              
         IF( P(J).GE.CEOSLP(30).AND.P(J).LE.CEOSLP(31) ) GO TO 5        
         P(J) = DMIN1(CEOSLP(31),DMAX1(CEOSLP(30),P(J)))                
         IF( IFTP.EQ.1 ) GO TO 5                                        
C
CITJ+ (11/13/98)
C
CCC      CALL ERROR( 2, 32H*THERMO* PRESSURE LIMIT EXCEEDED, 4 )        
         WRITE(IMOUT,8001)
 8001    FORMAT(1H ,1X,'*THERMO* PRESSURE LIMIT EXCEEDED' )        
         NUM = 999
C
CITJ- (11/13/98)
C
         WRITE(IMOUT,18) NUM ,J                                         
    5    CONTINUE                                                       
C                                                                       
C                                                                       
C     CALCULATE SATURATION PROPERTIES                                   
C                                                                       
         PS         = P(J)-PA(J)                                        
         TSAT(J)    = SATTMP(P(J))                                      
         DR(LDTSDP) = SATDER(P(J),TSAT(J))                              
         IF( PA(J).LT.1.D-5 ) GO TO 9                                   
         TSSN(J)    = SATTMP(PS)                                        
         DR(LDTSSP) = SATDER(PS,TSSN(J))                                
         GO TO 10                                                       
    9    TSSN(J)    = TSAT(J)                                           
         DR(LDTSSP) = DR(LDTSDP)                                        
   10    IF( EV(J).EQ.-1.0D0.AND.IEOS.EQ.0 ) TV(J) = TSAT(J)            
         IF( EL(J).EQ.-1.0D0.AND.IEOS.EQ.0 ) TL(J) = TSAT(J)            
         IF( EV(J).EQ.-2.D0.AND.IEOS.EQ.0 ) TV(J) = TSSN(J)             
         IF( EL(J).EQ.-2.D0.AND.IEOS.EQ.0 ) TL(J) = TSSN(J)             
         IF( IEOS.NE.0 ) GO TO 15                                       
         IF( TV(J).GE.CEOSLP(34).AND.TV(J).LE.CEOSLP(35) ) GO TO 15     
         TV(J) = DMIN1(CEOSLP(35),DMAX1(TV(J),CEOSLP(34)))              
         IF( IFTP.EQ.1 ) GO TO 15                                       
C
CITJ+ (11/13/98)
C
CCC      CALL ERROR( 2, 34H*THERMO* VAPOR TEMP LIMIT EXCEEDED, 4 )      
         WRITE(IMOUT,8002)
 8002    FORMAT(1H ,1X,'*THERMO* VAPOR TEMP LIMIT EXCEEDED' )      
         NUM = 999
C
CITJ- (11/13/98)
C
         WRITE(IMOUT,18) NUM ,J                                         
   15    IF( TL(J).GE.CEOSLP(32).AND.TL(J).LE.CEOSLP(33) ) GO TO 20     
         TL(J) = DMIN1(CEOSLP(33),DMAX1(TL(J),CEOSLP(32)))              
         IF( IFTP.EQ.1 ) GO TO 20                                       
         IF( IEOS.NE.0 ) GO TO 20                                       
C
CITJ+ (11/13/98)
C
CCC      CALL ERROR( 2, 35H*THERMO* LIQUID TEMP LIMIT EXCEEDED, 4 )     
         WRITE(IMOUT,8002)
 8003    FORMAT(1H ,1X,'*THERMO* LIQUID TEMP LIMIT EXCEEDED' )     
         NUM = 999
C
CITJ- (11/13/98)
C
         WRITE(IMOUT,18) NUM ,J                                         
   18 FORMAT(15X,9HCOMPONENT,I4,2H, ,4HCELL,I4)                         
   20    CONTINUE                                                       
C                                                                       
C     CALCULATE LIQUID PROPERTIES                                       
C                                                                       
C                                                                       
C        1. INTERNAL ENERGY AND ITS DERIVATIVES                         
C                                                                       
         II = IDINT(DMIN1(DMAX1((TL(J)-373.15D0)/50.0D0,0.0D0)+1.0D0,   
     1        7.0D0))                                                   
         IF( TL(J).GT.645.15D0 ) II = II+1                              
         EL(J)      = ALE(II)+TL(J)*(BLE(II)+TL(J)*(CLE(II)+TL(J)*      
     1                DLE(II)))                                         
         DR(LDELDT) = BLE(II)+TL(J)*(2.0D0*CLE(II)+TL(J)*3.0D0*DLE(II)) 
         PSL        = SATPRS(TL(J))                                     
         DPS        = 1.0D0/SATDER(PSL,TL(J))                           
         EXPPS      = EXP(CK4*PSL)                                      
         DR(LDELDP) = CK0*(1.0D0-EXPPS)+CK2*PSL*PSL                     
         ELP        = (P(J)-PSL)*DR(LDELDP)                             
         ERT        = DPS*(CK0*(-1.0D0+EXPPS*(1.0D0-CK4*(P(J)-PSL)))+   
     1                CK2*(2.0D0*P(J)*PSL-3.0D0*PSL*PSL))               
         EL(J)      = EL(J)+ELP                                         
         DR(LDELDT) = DR(LDELDT)+ERT                                    
         II         = IDINT(DMIN1(DMAX1((TSSN(J)-373.15D0)/50.0D0,      
     1                0.0D0)+1.0D0,7.0D0))                              
         IF( TSSN(J).GT.645.15D0 ) II = II+1                            
         ELSAT  = ALE(II)+TSSN(J)*(BLE(II)+TSSN(J)*(CLE(II)+TSSN(J)*    
     1            DLE(II)))                                             
         DELSAT = BLE(II)+TSSN(J)*(2.0D0*CLE(II)+TSSN(J)*3.0D0*DLE(II)) 
         CALL RHOLIQ( P(J), TSSN(J), ROLST, DRLSDP, DRLSDT )            
         RROLST     = 1.0D0/ROLST                                       
         DR(LHLST)  = ELSAT+P(J)*RROLST                                 
         DR(LDHLSP) = DELSAT*DR(LDTSDP)+RROLST-P(J)*RROLST*RROLST*      
     1                (DRLSDT*DR(LDTSDP)+DRLSDP)                        
C                                                                       
C        2. DENSITY AND ITS DERIVATIVES                                 
C                                                                       
         CALL RHOLIQ( P(J), TL(J), ROL(J), DR(LDROLP), DR(LDROLT) )     
C                                                                       
C                                                                       
C                                                                       
C     CALCULATE STEAM PROPERTIES                                        
C                                                                       
C                                                                       
C                                                                       
C     PROPERTIES AT SATURATION                                          
C                                                                       
C     -----SPECIFIC HEAT AND ITS DERIVATIVE                             
         II = IDINT(DMIN1(DMAX1((TSSN(J)-273.15D0)/50.0D0,0.0D0)+1.0D0, 
     1        9.0D0))                                                   
         IF( TSSN(J).GT.647.3D0 ) II = II+1                             
         CPS   = ACP(II)+TSSN(J)*(BCP(II)+TSSN(J)*(CCP(II)+TSSN(J)*     
     1           DCP(II)))                                              
         DPCPS = (BCP(II)+TSSN(J)*(2.0D0*CCP(II)+TSSN(J)*3.0D0*         
     1           DCP(II)))*DR(LDTSSP)                                   
C     -----INTERNAL ENERGY, ENTHALPY, AND THEIR DERIVATIVES             
         IF( PS.GT.5.0D+05 ) GO TO 140                                  
         DR(LHVST)  = CEOSLP(8)+CEOSLP(7)*(TSSN(J)-CEOSLP(5))+          
     1                HEV(TSSN(J))                                      
         DR(LDHVSP) = (CEOSLP(7)-2470.2120D0)*DR(LDTSSP)                
         ES         = DR(LHVST)-CEOSLP(12)*TSSN(J)                      
         DPES       = DR(LDHVSP)-CEOSLP(12)*DR(LDTSSP)                  
         GAMS       = DR(LHVST)/ES                                      
         GAMSM      = GAMS-1.0D0                                        
         DPGAMS     = (DR(LDHVSP)-GAMS*DPES)/ES                         
         GO TO 200                                                      
  140    CONTINUE                                                       
         II = IDINT(DMIN1(PS/50.0D+05+1.0D0,9.0D0))                     
         IF( PS.GT.20.0D+05 ) II = II+1                                 
         IF( PS.GT.220.0D+05 ) II = II+1                                
         ES         = AVE(II)+PS*(BVE(II)+PS*(CVE(II)+PS*DVE(II)))      
         DPES       = (BVE(II)+PS*(2.0D0*CVE(II)+PS*3.0D0*DVE(II)))     
         GAMS       = AVG(II)+PS*(BVG(II)+PS*(CVG(II)+PS*DVG(II)))      
         DPGAMS     = BVG(II)+PS*(2.0D0*CVG(II)+PS*3.0D0*DVG(II))       
         GAMSM      = GAMS-1.0D0                                        
         DR(LHVST)  = GAMS*ES                                           
         DR(LDHVSP) = GAMS*DPES+ES*DPGAMS                               
  200    CONTINUE                                                       
C                                                                       
C     PROPERTIES AT ACTUAL STEAM TEMPERATURE                            
C                                                                       
         IF( IEOS.NE.0 ) GO TO 280                                      
         IF( TV(J).GT.TSSN(J) ) GO TO 210                               
         DR(LDEVDT) = CPS/CEOSLP(16)                                    
         DE         = DR(LDEVDT)*(TV(J)-TSSN(J))                        
         EV(J)      = ES+DE                                             
         DR(LDEVDP) = DPES+DE*DPCPS/CPS-DR(LDEVDT)*DR(LDTSSP)           
         GO TO 220                                                      
  210    CONTINUE                                                       
         T1         = 1.0D0/(A11*CPS-1.0D0)                             
         BETA       = TSSN(J)*TSSN(J)*(1.0D0-T1*T1)                     
         T2         = TSSN(J)*T1                                        
         DE         = A12*(TV(J)-TSSN(J)+SQRT(TV(J)*TV(J)-BETA)-T2)     
         EV(J)      = ES+DE                                             
         CAPK       = A13*DE+TSSN(J)+T2                                 
         DBETAP     = 2.0D0*(BETA*DR(LDTSSP)+A11*DPCPS*T2**3)/TSSN(J)   
         DCAPKP     = -A13*DPES+(1.0D0+T1)*DR(LDTSSP)-A11*T1*T2*DPCPS   
         T3         = 1.0D0-BETA/(CAPK*CAPK)                            
         DR(LDEVDT) = CEOSLP(4)/T3                                      
         DR(LDEVDP) = -0.5D0*(T3*DCAPKP+DBETAP/CAPK)*DR(LDEVDT)         
  220    CONTINUE                                                       
         T4         = 1.0D0/(GAMSM*ES+C26*DE)                           
         ROV(J)     = PS*T4                                             
         DRVDE      = -ROV(J)*C26*T4                                    
         DR(LDROVT) = DRVDE*DR(LDEVDT)                                  
         DR(LDROVP) = T4-ROV(J)*(ES*DPGAMS+(GAMSM-C26)*DPES)*T4+DRVDE*  
     1                DR(LDEVDP)                                        
         IF( PS.GT.0.0D0.AND.ROV(J).LE.0.0D0 ) GO TO 230                
         IF( ROV(J).LT.(0.999D0*ROL(J)) ) GO TO 280                     
         ROV(J)     = 0.999D0*ROL(J)                                    
         DR(LDROVT) = 0.999D0*DR(LDROLT)                                
         DR(LDROVP) = 0.999D0*DR(LDROLP)                                
         GO TO 280                                                      
  230    CONTINUE                                                       
         ROV(J)     = PS/(CEOSLP(12)*TV(J))                             
         DR(LDROVT) = -ROV(J)/TV(J)                                     
         DR(LDROVP) = ROV(J)/PS                                         
C                                                                       
C                                                                       
C                                                                       
C     CALCULATE AIR PROPERTIES                                          
C                                                                       
C                                                                       
C                                                                       
  280    EVA(J)     = CEOSLP(17)*TV(J)                                  
         DR(LDEVAT) = CEOSLP(17)                                        
         DR(LDEVAP) = 0.0D0                                             
         DR(LDRVAP) = 1.0D0/(CEOSLP(25)*TV(J))                          
         ROVA(J)    = DR(LDRVAP)*PA(J)                                  
         DR(LDRVAT) = -CEOSLP(25)*ROVA(J)*DR(LDRVAP)                    
C                                                                       
C                                                                       
C                                                                       
C     CALCULATE AIR-STEAM MIXTURE PROPERTIES                            
C                                                                       
C                                                                       
C                                                                       
         IF( IEOS.EQ.0 ) GO TO 281                                      
         EV(J)      = EVA(J)                                            
         ROV(J)     = DR(LDRVAP)*PS                                     
         DR(LDEVDT) = DR(LDEVAT)                                        
         DR(LDEVDP) = DR(LDEVAP)                                        
         DR(LDROVP) = DR(LDRVAP)                                        
         DR(LDROVT) = -CEOSLP(25)*ROV(J)*DR(LDRVAP)                     
  281    CONTINUE                                                       
         EV(J)  = (EV(J)*ROV(J)+EVA(J)*ROVA(J))                         
         ROV(J) = ROV(J)+ROVA(J)                                        
         EV(J)  = EV(J)/ROV(J)                                          
  300 CONTINUE                                                          
CAD +                                                                   
C
CITJ+ (11/13/98)
C
CCC   CALL TTIMER( 10, 0, 0 )                                           
C
CITJ- (11/13/98)
C
CAD -                                                                   
      RETURN                                                            
      END                                                               

VISCL.f/        929015384   0     0     100666  3182      `
C*DK VISCL                                                              
      FUNCTION VISCL( H, P )                                            
      IMPLICIT REAL*8(A-H,O-Z)                                          
C                                                                       
C                                                                       
C   DYNAMIC VISCOSITY OF WATER AS FUNCTION OF PRESSURE AND ENTHALPY     
C        PRESSURE  P       IN (N/SQ.M)                                  
C        ENTHALPY  H       IN (J/KG)                                    
C        DYNAMIC VISCOSITY IN (N S/SQ.M)                                
C              REQUIRES POLY                                            
C                                                                       
      DIMENSION A(5) ,B(4) ,D(5) ,E(4) ,F(4)                            
      DATA A/1.299470229D-3,-9.264032108D-4, 3.81047061D-4,             
     *     -8.219444458D-5, 7.022437984D-6/, HO/8.581289699D-6/,        
     *     CON/4.265884D4/, ECON/5.53588D4/, EHO/6.484503981D-6/,       
     *     B/-6.5959D-12, 6.763D-12, -2.88825D-12, 4.4525D-13/,         
     *     D/3.026032306D-4, -1.836606896D-4, 7.567075775D-5,           
     *     -1.647878879D-5, 1.416457633D-6/, HOO/3.892077365D-6/,       
     *     E/1.4526052612D-3, -6.9880084985D-9, 1.5210230334D-14,       
     *     -1.2303194946D-20/, H1/.276D6/, H2/.394D6/, CN/4.014676D5/,  
     *     F/-3.8063507533D-11, 3.9285207677D-16, -1.2585799292D-21,    
     *     1.2860180788D-27/, PI/6.894575293D5/                         
C                                                                       
      POLY3(A1,A2,A3,A4,X) = A1+X*(A2+X*(A3+X*A4))                      
      POLY4(A1,A2,A3,A4,A5,X) = A1+X*(A2+X*(A3+X*(A4+X*A5)))            
      XI  = (H-CON)*HO                                                  
      ETA = (H-ECON)*EHO                                                
      IF( H.GT.H1 ) GO TO 40                                            
C                                                                       
      VISCL = POLY4(A(1),A(2),A(3),A(4),A(5),XI)-POLY3(B(1),B(2),B(3),  
     1        B(4),ETA)*(P-PI)                                          
      RETURN                                                            
40    IF( H.GT.H2 ) GO TO 50                                            
C                                                                       
      VISCL = POLY3(E(1),E(2),E(3),E(4),H)+POLY3(F(1),F(2),F(3),F(4),H)*
     1        (P-PI)                                                    
      RETURN                                                            
C                                                                       
   50 CONTINUE                                                          
      VISCL = POLY4(D(1),D(2),D(3),D(4),D(5),(H-CN)*HOO)                
C                                                                       
      RETURN                                                            
      END                                                               
VISCV.f/        929015386   0     0     100666  5180      `
C*DK VISCV                                                              
      FUNCTION VISCV( H, P, ROV, TV, PA )                               
      IMPLICIT REAL*8(A-H,O-Z)                                          
C*CA CONTRLLR                                                           
C*CC CONTRLLR                                                           
      INCLUDE 'CONTRLLR'                                                
C                                                                       
C                                                                       
C   DYNAMIC VISCOSITY OF STEAM AS FUNCTION OF PRESSURE AND ENTHALPY     
C        PRESSURE  P       IN (N/SQ.M)                                  
C        ENTHALPY  H       IN (J/KG)                                    
C         DENSITY   ROV      IN (KG/CU.M)                               
C         TEMPERATURE T      IN (K)                                     
C        DYNAMIC VISCOSITY IN (N S/SQ.M.)                               
C              REQUIRES POLY                                            
C                                                                       
C*CA TSATCN                                                             
C*CC TSATCN                                                             
      INCLUDE 'TSATCN'                                                  
      DIMENSION A(3) ,F(4) ,G(4)                                        
      DATA A/3.53D-8, 6.765D-11, 1.021D-14/, B/.407D-7/, C/8.04D-6/,    
     *     D/1.858D-7/, E/5.9D-10/,                                     
     *     F/-.2885D-5, .2427D-7, -.67893333333D-10, .6317037037D-13/,  
     *     G/.176D3, -.16D1, .48D-2, -.47407407407D-5/                  
C                                                                       
      POLY2(A1,A2,A3,X) = A1+X*(A2+X*A3)                                
      POLY3(A1,A2,A3,A4,X) = A1+X*(A2+X*(A3+X*A4))                      
C  POLY4 IS VISCOSITY FUNCTION FOR HYDROGEN;2ND ORDER POLYNOMIAL FIT TO 
C  REFERENCE: HANDBOOK OF THERMODYNAMIC TABLES AND CHARTS,              
C             KUZMAN RAZNJEVIC, HEMISPHERE PUBLISHING CORP.             
      POLY4(TH) = 4.175D-06+1.588D-08*TH+7.6705D-13*TH*TH               
      IF( IEOS.NE.0.AND.IGAS.EQ.1 ) GO TO 50                            
      IF( IEOS.NE.0 ) GO TO 65                                          
      T  = TV-273.15D0                                                  
      RO = ROV                                                          
      V1 = B*T+C                                                        
      IF( T.LE.300.D0 ) GO TO 10                                        
      IF( T.GE.375.D0 ) GO TO 20                                        
      VISCV = V1+(POLY3(F(1),F(2),F(3),F(4),T)+POLY3(G(1),G(2),G(3),    
     1        G(4),T)*POLY2(A(1),A(2),A(3),RO))*RO                      
C                                                                       
      GO TO 70                                                          
10    VISCV = V1-RO*(D-E*T)                                             
      IF( VISCV.LT.1.D-7 ) VISCV = 1.D-7                                
C                                                                       
      GO TO 70                                                          
                                                                        
   20 VISCV = V1+POLY2(A(1),A(2),A(3),RO)*RO                            
C                                                                       
      GO TO 70                                                          
  50  T = TV-273.15D0                                                   
      IF( T.GT.229.D0 ) GO TO 60                                        
      VISCV = 17.08D-6+T*(5.927D-8-8.14D-11*T)                          
      RETURN                                                            
  60  VISCV = 17.35D-6+T*(4.193D-8-1.09D-11*T)                          
      RETURN                                                            
   65 VISCV = POLY4(TV)                                                 
      RETURN                                                            
  70  IF( PA.LT.0.1D0 ) RETURN                                          
      IF( IGAS.EQ.1 ) GO TO 80                                          
      VISCA = POLY4(TV)                                                 
      GO TO 100                                                         
  80  T = TV-273.15D0                                                   
      IF( T.GT.229.D0 ) GO TO 90                                        
      VISCA = 17.08D-6+T*(5.927D-8-8.14D-11*T)                          
      GO TO 100                                                         
  90  VISCA = 17.35D-6+T*(4.193D-8-1.09D-11*T)                          
 100  VISCV = ((P-PA)*VISCV+PA*VISCA)/P                                 
      RETURN                                                            
      END                                                               
